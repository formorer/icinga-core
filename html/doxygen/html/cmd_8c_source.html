<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Icinga-core: cgi/cmd.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icinga_logo4-300x109.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Icinga-core&#160;<span id="projectnumber">1.4.0</span></div>
   <div id="projectbrief">next gen monitoring</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('cmd_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">cgi/cmd.c</div>  </div>
</div>
<div class="contents">
<a href="cmd_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * CMD.C - Icinga Command CGI</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Copyright (c) 1999-2009 Ethan Galstad (egalstad@nagios.org)</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright (c) 2009-2011 Icinga Development Team (http://www.icinga.org)</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * Last Modified: 08-08-2010</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * License:</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00013"></a>00013 <span class="comment"> * it under the terms of the GNU General Public License version 2 as</span>
<a name="l00014"></a>00014 <span class="comment"> * published by the Free Software Foundation.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00017"></a>00017 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00018"></a>00018 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00019"></a>00019 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00022"></a>00022 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00023"></a>00023 <span class="comment"> * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00024"></a>00024 <span class="comment"> *************************************************************************/</span>
<a name="l00025"></a>00025 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;../include/config.h&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;../include/common.h&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;../include/objects.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;../include/comments.h&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;../include/downtime.h&quot;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;../include/cgiutils.h&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;../include/cgiauth.h&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;../include/getcgi.h&quot;</span>
<a name="l00040"></a>00040 
<a name="l00043"></a>00043 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cmd_8c.html#aa42189d96638a4f13aaf48a5128eafde">extcmd_get_name</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="icingastats_8c.html#a7e14c4b6442d6e890227b6fdf8b9cbdd">main_config_file</a>[<a class="code" href="include_2common_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];
<a name="l00046"></a>00046 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="avail_8c.html#a7bc2f8f476dc9f3171b4b82eaec3e3eb">url_html_path</a>[<a class="code" href="include_2common_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];
<a name="l00047"></a>00047 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="avail_8c.html#aca7df0d6cf5e9f0d6c3492b6e7238536">url_images_path</a>[<a class="code" href="include_2common_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];
<a name="l00048"></a>00048 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="commands_8c.html#ad6bb81fae52e357701eadd493eca7902">command_file</a>[<a class="code" href="include_2common_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];
<a name="l00049"></a>00049 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="cmd_8c.html#a100b5d3e721c19206de435df77ee8840">comment_file</a>[<a class="code" href="include_2common_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="commands_8c.html#abf64fe29cddb0d890bbece7d4d970c18">check_external_commands</a>;
<a name="l00052"></a>00052 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="cgiauth_8c.html#a8c8675d6714b8a8dce33fe43e0368efc">use_authentication</a>;
<a name="l00053"></a>00053 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="cgiutils_8c.html#a96cfe0add1d7f974dcc7bd87a929cb84">lock_author_names</a>;
<a name="l00054"></a>00054 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="cgiutils_8c.html#a9531538c18dc48bad32b0df6b0b072aa">persistent_ack_comments</a>;
<a name="l00055"></a>00055 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="commands_8c.html#ad0b68c2d5394aea2ad23c94641936dc1">log_external_commands_user</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>;
<a name="l00058"></a>00058 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="avail_8c.html#a17b5e90c138d1b1d18eee26ff323f89e">display_header</a>;
<a name="l00059"></a>00059 <span class="keyword">extern</span> <span class="keywordtype">int</span>  <a class="code" href="avail_8c.html#a8758a58819454e69684b26da2a9ab37f">daemon_check</a>;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>;
<a name="l00062"></a>00062 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="base_2config_8c.html#a724a2263d444550e456b32059ab08c00">date_format</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">extern</span> <a class="code" href="structscheduled__downtime__struct.html">scheduled_downtime</a> *<a class="code" href="cmd_8c.html#acca513adf35cef7cadb06cceafeff9ae">scheduled_downtime_list</a>;
<a name="l00065"></a>00065 <span class="keyword">extern</span> <a class="code" href="structcomment__struct.html">comment</a> *<a class="code" href="cmd_8c.html#aa9f6430e701b7c91f2a1a2b788ec5ebc">comment_list</a>;
<a name="l00070"></a><a class="code" href="cmd_8c.html#acf7918d773eb46c239c6636962c00940">00070</a> <span class="preprocessor">#define MAX_AUTHOR_LENGTH               64</span>
<a name="l00071"></a><a class="code" href="cmd_8c.html#a1646240195ba8bc8c0871a99bfa36f2b">00071</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_COMMENT_LENGTH              1024</span>
<a name="l00072"></a><a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define NUMBER_OF_STRUCTS               500             </span>
<a name="l00077"></a><a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">00077</a> <span class="preprocessor">#define PRINT_COMMON_HEADER             1</span>
<a name="l00078"></a><a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_AUTHOR                    2</span>
<a name="l00079"></a><a class="code" href="cmd_8c.html#a1e6d11bdf1bfe19430ffd7816970408a">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_STICKY_ACK                3</span>
<a name="l00080"></a><a class="code" href="cmd_8c.html#ac3b3e827c29cd7f1a02322fc093d41ba">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_PERSISTENT                4</span>
<a name="l00081"></a><a class="code" href="cmd_8c.html#a4dcc7d5d0bea4d9173c39aff95aee151">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_SEND_NOTFICATION          5</span>
<a name="l00082"></a><a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_COMMENT_BOX               6</span>
<a name="l00083"></a><a class="code" href="cmd_8c.html#afb881756569d660675c95410d0ed21c4">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_NOTIFICATION_DELAY        7</span>
<a name="l00084"></a><a class="code" href="cmd_8c.html#a931ecb1e2b0a4b0171d7cf03a2a801a9">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_START_TIME                8</span>
<a name="l00085"></a><a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_END_TIME                  9</span>
<a name="l00086"></a><a class="code" href="cmd_8c.html#a345b2c1603fcb60ca53f41a3b64a84db">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_CHECK_TIME                10</span>
<a name="l00087"></a><a class="code" href="cmd_8c.html#a706bc1d19f4844a0a1b58ad9e5862eb3">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_FORCE_CHECK               11</span>
<a name="l00088"></a><a class="code" href="cmd_8c.html#a4b32eb4866f6a24727422571a8d69350">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_CHECK_OUTPUT_BOX          12</span>
<a name="l00089"></a><a class="code" href="cmd_8c.html#a84e39a146adab49fb3a9b8cb4194853b">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_PERFORMANCE_DATA_BOX      13</span>
<a name="l00090"></a><a class="code" href="cmd_8c.html#a43f6b9650f6014f525c4db5a497494b0">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_FIXED_FLEXIBLE_TYPE       14</span>
<a name="l00091"></a><a class="code" href="cmd_8c.html#a9f70a74726f225c57336802a087350c3">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_BROADCAST_NOTIFICATION    15</span>
<a name="l00092"></a><a class="code" href="cmd_8c.html#a939639369cabf53029528fe52a35188d">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_FORCE_NOTIFICATION        16</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">00097</a> <span class="preprocessor">#define PRINT_HOST_LIST                 17</span>
<a name="l00098"></a><a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_SERVICE_LIST              18</span>
<a name="l00099"></a><a class="code" href="cmd_8c.html#a46237026829582187c9f48046ac701c2">00099</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_COMMENT_LIST              19</span>
<a name="l00100"></a><a class="code" href="cmd_8c.html#a752e0923edd9c335c636c19e8cc3d354">00100</a> <span class="preprocessor"></span><span class="preprocessor">#define PRINT_DOWNTIME_LIST             20</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>
<a name="l00107"></a><a class="code" href="structhostlist.html">00107</a> <span class="keyword">struct </span><a class="code" href="structhostlist.html" title="host/service list structure">hostlist</a> {
<a name="l00108"></a><a class="code" href="structhostlist.html#a32b4b0736d19b344ed6d9807d714b986">00108</a>         <span class="keywordtype">char</span> *<a class="code" href="structhostlist.html#a32b4b0736d19b344ed6d9807d714b986">host_name</a>;
<a name="l00109"></a><a class="code" href="structhostlist.html#a554c2579c8ed92476976d0c71063c877">00109</a>         <span class="keywordtype">char</span> *<a class="code" href="structhostlist.html#a554c2579c8ed92476976d0c71063c877">description</a>;
<a name="l00110"></a>00110 };
<a name="l00111"></a>00111 
<a name="l00116"></a><a class="code" href="structerrorlist.html">00116</a> <span class="keyword">struct </span><a class="code" href="structerrorlist.html" title="error list structure">errorlist</a> {
<a name="l00117"></a><a class="code" href="structerrorlist.html#ab45003869c371e665838f6ae643599cb">00117</a>         <span class="keywordtype">char</span> *<a class="code" href="structerrorlist.html#ab45003869c371e665838f6ae643599cb">message</a>;
<a name="l00118"></a>00118 };
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 
<a name="l00126"></a><a class="code" href="cmd_8c.html#a712e3e964bf6488fa27ed62b58b247e9">00126</a> <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a712e3e964bf6488fa27ed62b58b247e9">show_all_hosts</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;                        
<a name="l00127"></a><a class="code" href="cmd_8c.html#a07ea6ce390c9ccc570c8761c67b795f2">00127</a> <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a07ea6ce390c9ccc570c8761c67b795f2">show_all_hostgroups</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;                   
<a name="l00128"></a><a class="code" href="cmd_8c.html#a32de73fd52c993b37abb804581ff0da0">00128</a> <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a32de73fd52c993b37abb804581ff0da0">show_all_servicegroups</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;                
<a name="l00129"></a><a class="code" href="cmd_8c.html#a7b50193f4e7d5976ac65a44694c15767">00129</a> <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a7b50193f4e7d5976ac65a44694c15767">display_type</a>=<a class="code" href="status_8c.html#ace399dd4752e7ecf50b6989d2ee06a85">DISPLAY_HOSTS</a>;                 
<a name="l00134"></a><a class="code" href="cmd_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">00134</a> <span class="keywordtype">char</span> *<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>=<span class="stringliteral">&quot;&quot;</span>;                             
<a name="l00135"></a><a class="code" href="cmd_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">00135</a> <span class="keywordtype">char</span> *<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>=<span class="stringliteral">&quot;&quot;</span>;                        
<a name="l00136"></a><a class="code" href="cmd_8c.html#a5bac8006c9ce38f423e06a13c08cca37">00136</a> <span class="keywordtype">char</span> *<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>=<span class="stringliteral">&quot;&quot;</span>;                     
<a name="l00137"></a><a class="code" href="cmd_8c.html#abcaaec3b3fa5930176e13f734a73ecde">00137</a> <span class="keywordtype">char</span> *<a class="code" href="avail_8c.html#abcaaec3b3fa5930176e13f734a73ecde">service_desc</a>=<span class="stringliteral">&quot;&quot;</span>;                          
<a name="l00138"></a><a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">00138</a> <span class="keywordtype">char</span> *<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=<span class="stringliteral">&quot;&quot;</span>;                        
<a name="l00139"></a><a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">00139</a> <span class="keywordtype">char</span> *<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>=<span class="stringliteral">&quot;&quot;</span>;                          
<a name="l00140"></a><a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">00140</a> <span class="keywordtype">char</span> *<a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>=<span class="stringliteral">&quot;&quot;</span>;                     
<a name="l00141"></a><a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">00141</a> <span class="keywordtype">char</span> *<a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>=<span class="stringliteral">&quot;&quot;</span>;                       
<a name="l00143"></a><a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">00143</a> <span class="keywordtype">char</span> <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>]=<span class="stringliteral">&quot;&quot;</span>;            
<a name="l00144"></a><a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">00144</a> <span class="keywordtype">char</span> <a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>]=<span class="stringliteral">&quot;&quot;</span>;        
<a name="l00145"></a><a class="code" href="cmd_8c.html#af10f6f871a018be899f199724459bc10">00145</a> <span class="keywordtype">char</span> <a class="code" href="cmd_8c.html#af10f6f871a018be899f199724459bc10">performance_data</a>[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>]=<span class="stringliteral">&quot;&quot;</span>;     
<a name="l00147"></a><a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">00147</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>=0;                       
<a name="l00148"></a><a class="code" href="cmd_8c.html#ad5481c62c063787258f51f2a5526edcf">00148</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#ad5481c62c063787258f51f2a5526edcf">schedule_delay</a>=0;                           
<a name="l00150"></a><a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">00150</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                   
<a name="l00151"></a><a class="code" href="cmd_8c.html#a72b6dc8eb7e681d1c76ac1e84ecd5e79">00151</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a72b6dc8eb7e681d1c76ac1e84ecd5e79">sticky_ack</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                           
<a name="l00152"></a><a class="code" href="cmd_8c.html#a891c67ceefc726acfabaa78113552c1a">00152</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a891c67ceefc726acfabaa78113552c1a">send_notification</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                    
<a name="l00153"></a><a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">00153</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                          
<a name="l00154"></a><a class="code" href="cmd_8c.html#a72558e782d26e44b8764513c5f79d644">00154</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a72558e782d26e44b8764513c5f79d644">plugin_state</a>=<a class="code" href="cgiutils_8h.html#a35937514c20ebac19d6598f04416db7e">STATE_OK</a>;                      
<a name="l00155"></a><a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">00155</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;             
<a name="l00156"></a><a class="code" href="cmd_8c.html#a3aa3bc94533aab17cb34c6703a252db4">00156</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a3aa3bc94533aab17cb34c6703a252db4">propagate_to_children</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                
<a name="l00157"></a><a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">00157</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                                
<a name="l00158"></a><a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">00158</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>=0L;                      
<a name="l00159"></a><a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">00159</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">triggered_by</a>=0L;                  
<a name="l00160"></a><a class="code" href="cmd_8c.html#ad7dce00a0d3e7156cb54d6a7061abb00">00160</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#ad7dce00a0d3e7156cb54d6a7061abb00">child_options</a>=0;                            
<a name="l00161"></a><a class="code" href="cmd_8c.html#a8784590e30c25d5b86c91320abc8b5a6">00161</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a8784590e30c25d5b86c91320abc8b5a6">force_notification</a>=0;                       
<a name="l00162"></a><a class="code" href="cmd_8c.html#a2ca36f69c287d587950d02b7aecdd471">00162</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a2ca36f69c287d587950d02b7aecdd471">broadcast_notification</a>=0;                   
<a name="l00164"></a><a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">00164</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">command_type</a>=<a class="code" href="include_2common_8h.html#a29878fb9d1aa37f0a2a05dbd83a4e856">CMD_NONE</a>;                      
<a name="l00165"></a><a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">00165</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">command_mode</a>=<a class="code" href="cgiutils_8h.html#af5b1cdd5470876f4c567bb3b92ed069d">CMDMODE_REQUEST</a>;               
<a name="l00167"></a><a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">00167</a> time_t <a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>=0L;                           
<a name="l00168"></a><a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">00168</a> time_t <a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>=0L;                             
<a name="l00170"></a><a class="code" href="cmd_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">00170</a> <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>=<a class="code" href="cgiutils_8h.html#a591ab83c08841649e9e0003f2a07c986">CMD_CGI_ID</a>;                          
<a name="l00172"></a><a class="code" href="cmd_8c.html#a19816b8e476055a6453f6ed39761b04e">00172</a> <a class="code" href="structauthdata__struct.html">authdata</a> <a class="code" href="avail_8c.html#a19816b8e476055a6453f6ed39761b04e">current_authdata</a>;                      
<a name="l00175"></a><a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">00175</a> <span class="keyword">struct </span><a class="code" href="structhostlist.html" title="host/service list structure">hostlist</a> <a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>];
<a name="l00176"></a>00176 
<a name="l00178"></a><a class="code" href="cmd_8c.html#aa6a44bb7540c4f54ca854e7eccc677c0">00178</a> <span class="keyword">struct </span><a class="code" href="structerrorlist.html" title="error list structure">errorlist</a> <a class="code" href="cmd_8c.html#aa6a44bb7540c4f54ca854e7eccc677c0">error</a>[<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>];
<a name="l00179"></a>00179 
<a name="l00181"></a><a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">00181</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>];
<a name="l00182"></a>00182 
<a name="l00184"></a><a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">00184</a> <span class="keywordtype">short</span> <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>];
<a name="l00185"></a>00185 
<a name="l00187"></a><a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">00187</a> <span class="keywordtype">short</span> <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>];
<a name="l00198"></a>00198 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#aed41d65bce45b47a7a13dc7092742c67" title="Print form for all details to submit command.">request_command_data</a>(<span class="keywordtype">int</span>);
<a name="l00199"></a>00199 
<a name="l00206"></a>00206 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a8859f113fed8a091483259d3071c623f" title="submits the command data and checks for sanity">commit_command_data</a>(<span class="keywordtype">int</span>);
<a name="l00207"></a>00207 
<a name="l00217"></a>00217 <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a4873a696e1f079765288bef01136ed51" title="checks the authorization and passes the data to cmd_submitf">commit_command</a>(<span class="keywordtype">int</span>);
<a name="l00218"></a>00218 
<a name="l00228"></a>00228 <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#afb6cb65ae7812183ed147dd6539e59e7" title="write the command to Icinga command pipe">write_command_to_file</a>(<span class="keywordtype">char</span> *);
<a name="l00229"></a>00229 
<a name="l00235"></a>00235 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<span class="keywordtype">char</span> *);
<a name="l00236"></a>00236 
<a name="l00244"></a>00244 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>);
<a name="l00245"></a>00245 
<a name="l00252"></a>00252 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<span class="keywordtype">int</span>);
<a name="l00253"></a>00253 
<a name="l00259"></a>00259 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<span class="keywordtype">char</span> *);
<a name="l00260"></a>00260 
<a name="l00266"></a>00266 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(<span class="keywordtype">int</span>*);
<a name="l00267"></a>00267 
<a name="l00275"></a>00275 <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d" title="checks if comment and author are not empty strings">check_time_sanity</a>(<span class="keywordtype">int</span>*);
<a name="l00276"></a>00276 
<a name="l00284"></a>00284 <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a73ec04c6739a0c63d052122f210d6571">process_cgivars</a>(<span class="keywordtype">void</span>);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 
<a name="l00288"></a><a class="code" href="cmd_8c.html#a840291bc02cba5474a4cb46a9b9566fe">00288</a> <span class="keywordtype">int</span> <a class="code" href="icinga_8c.html#a7b26396c9888d66d997b0007e8ff1e60">main</a>(<span class="keywordtype">void</span>){
<a name="l00289"></a>00289         <span class="keywordtype">int</span> result=<a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291         <span class="comment">/* get the arguments passed in the URL */</span>
<a name="l00292"></a>00292         <a class="code" href="avail_8c.html#a73ec04c6739a0c63d052122f210d6571">process_cgivars</a>();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         <span class="comment">/* reset internal variables */</span>
<a name="l00295"></a>00295         <a class="code" href="cgiutils_8c.html#a0166ce3b2450136222df0d050b7e3dea">reset_cgi_vars</a>();
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <span class="comment">/* read the CGI configuration file */</span>
<a name="l00298"></a>00298         result=<a class="code" href="cgiutils_8c.html#af59e95b6549c8c1ea7c8011d84ce9e32">read_cgi_config_file</a>(<a class="code" href="cgiutils_8c.html#ac759048a0f3a08dcd75b6e7d9db3e3a5">get_cgi_config_location</a>());
<a name="l00299"></a>00299         <span class="keywordflow">if</span>(result==<a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>){
<a name="l00300"></a>00300                 <a class="code" href="cgiutils_8c.html#a337e440169def1cabd5d83e4ae5e643e">document_header</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>,<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00301"></a>00301                 <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>==<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>)
<a name="l00302"></a>00302                         printf(<span class="stringliteral">&quot;&lt;p&gt;Error: Could not open CGI config file!&lt;/p&gt;\n&quot;</span>);
<a name="l00303"></a>00303                 <span class="keywordflow">else</span>
<a name="l00304"></a>00304                         <a class="code" href="cgiutils_8c.html#a54254ed3f1dbc4e1b2554e662f8bdcd3">print_error</a>(<a class="code" href="cgiutils_8c.html#ac759048a0f3a08dcd75b6e7d9db3e3a5">get_cgi_config_location</a>(), <a class="code" href="cgiutils_8h.html#a5ae666abfb72c17a3adba003e2d7936b">ERROR_CGI_CFG_FILE</a>);
<a name="l00305"></a>00305                 <a class="code" href="cgiutils_8c.html#a97bcfd941bfebba5c7245f8ecbd3b225">document_footer</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>);
<a name="l00306"></a>00306                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l00307"></a>00307         }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         <span class="comment">/* read the main configuration file */</span>
<a name="l00310"></a>00310         result=<a class="code" href="base_2config_8c.html#a05eba6fb65aaf61da035d303c96242f4">read_main_config_file</a>(<a class="code" href="icingastats_8c.html#a7e14c4b6442d6e890227b6fdf8b9cbdd">main_config_file</a>);
<a name="l00311"></a>00311         <span class="keywordflow">if</span>(result==<a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>){
<a name="l00312"></a>00312                 <a class="code" href="cgiutils_8c.html#a337e440169def1cabd5d83e4ae5e643e">document_header</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>,<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00313"></a>00313                 <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>==<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>)
<a name="l00314"></a>00314                         printf(<span class="stringliteral">&quot;&lt;p&gt;Error: Could not open main config file!&lt;/p&gt;\n&quot;</span>);
<a name="l00315"></a>00315                 <span class="keywordflow">else</span>
<a name="l00316"></a>00316                         <a class="code" href="cgiutils_8c.html#a54254ed3f1dbc4e1b2554e662f8bdcd3">print_error</a>(<a class="code" href="icingastats_8c.html#a7e14c4b6442d6e890227b6fdf8b9cbdd">main_config_file</a>, <a class="code" href="cgiutils_8h.html#a7e2b6b5d63a84545a8d71aaaea80e402">ERROR_CGI_MAIN_CFG</a>);
<a name="l00317"></a>00317                 <a class="code" href="cgiutils_8c.html#a97bcfd941bfebba5c7245f8ecbd3b225">document_footer</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>);
<a name="l00318"></a>00318                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320 
<a name="l00321"></a>00321         <span class="comment">/* This requires the date_format parameter in the main config file */</span>
<a name="l00322"></a>00322         <span class="keywordflow">if</span> (strcmp(<a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00323"></a>00323                 <a class="code" href="cgiutils_8c.html#a5ef767caf1bc13da31ae03d3c7b0faa8">string_to_time</a>(<a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>,&amp;<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325         <span class="keywordflow">if</span> (strcmp(<a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00326"></a>00326                 <a class="code" href="cgiutils_8c.html#a5ef767caf1bc13da31ae03d3c7b0faa8">string_to_time</a>(<a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>,&amp;<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>);
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 
<a name="l00329"></a>00329         <span class="comment">/* read all object configuration data */</span>
<a name="l00330"></a>00330         result=<a class="code" href="cgiutils_8c.html#a91992adf43eb99094bb8769d7cc119b1">read_all_object_configuration_data</a>(<a class="code" href="icingastats_8c.html#a7e14c4b6442d6e890227b6fdf8b9cbdd">main_config_file</a>,<a class="code" href="include_2common_8h.html#a555830e507b1050f67da61c425990515">READ_ALL_OBJECT_DATA</a>);
<a name="l00331"></a>00331         <span class="keywordflow">if</span>(result==<a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>){
<a name="l00332"></a>00332                 <a class="code" href="cgiutils_8c.html#a337e440169def1cabd5d83e4ae5e643e">document_header</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>,<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00333"></a>00333                 <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>==<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>)
<a name="l00334"></a>00334                         printf(<span class="stringliteral">&quot;&lt;p&gt;Error: Could not read object config data!&lt;/p&gt;\n&quot;</span>);
<a name="l00335"></a>00335                 <span class="keywordflow">else</span>
<a name="l00336"></a>00336                         <a class="code" href="cgiutils_8c.html#a54254ed3f1dbc4e1b2554e662f8bdcd3">print_error</a>(NULL, <a class="code" href="cgiutils_8h.html#a304c80e21935cb69b7fb63a9b6e37c10">ERROR_CGI_OBJECT_DATA</a>);
<a name="l00337"></a>00337                 <a class="code" href="cgiutils_8c.html#a97bcfd941bfebba5c7245f8ecbd3b225">document_footer</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>);
<a name="l00338"></a>00338                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l00339"></a>00339         }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <a class="code" href="cgiutils_8c.html#a337e440169def1cabd5d83e4ae5e643e">document_header</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>,<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00342"></a>00342 
<a name="l00343"></a>00343         <span class="comment">/* get authentication information */</span>
<a name="l00344"></a>00344         <a class="code" href="cgiauth_8c.html#a6fd1465f39a46eecf4013821ea859270">get_authentication_information</a>(&amp;current_authdata);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#a17b5e90c138d1b1d18eee26ff323f89e">display_header</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l00347"></a>00347 
<a name="l00348"></a>00348                 <span class="comment">/* Giving credits to stop.png image source */</span>
<a name="l00349"></a>00349                 printf(<span class="stringliteral">&quot;\n&lt;!-- Image \&quot;stop.png\&quot; has been taken from \&quot;http://fedoraproject.org/wiki/Template:Admon/caution\&quot; --&gt;\n\n&quot;</span>);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351                 <span class="comment">/* begin top table */</span>
<a name="l00352"></a>00352                 printf(<span class="stringliteral">&quot;&lt;table border=0 width=100%%&gt;\n&quot;</span>);
<a name="l00353"></a>00353                 printf(<span class="stringliteral">&quot;&lt;tr&gt;\n&quot;</span>);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355                 <span class="comment">/* left column of the first row */</span>
<a name="l00356"></a>00356                 printf(<span class="stringliteral">&quot;&lt;td align=left valign=top width=33%%&gt;\n&quot;</span>);
<a name="l00357"></a>00357                 <a class="code" href="cgiutils_8c.html#aa40e971c994bd9b9782c7dd0fac81c31">display_info_table</a>(<span class="stringliteral">&quot;External Command Interface&quot;</span>,<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,&amp;current_authdata, <a class="code" href="avail_8c.html#a8758a58819454e69684b26da2a9ab37f">daemon_check</a>);
<a name="l00358"></a>00358                 printf(<span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360                 <span class="comment">/* center column of the first row */</span>
<a name="l00361"></a>00361                 printf(<span class="stringliteral">&quot;&lt;td align=center valign=top width=33%%&gt;\n&quot;</span>);
<a name="l00362"></a>00362                 printf(<span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>);
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                 <span class="comment">/* right column of the first row */</span>
<a name="l00365"></a>00365                 printf(<span class="stringliteral">&quot;&lt;td align=right valign=bottom width=33%%&gt;\n&quot;</span>);
<a name="l00366"></a>00366 
<a name="l00367"></a>00367                 <span class="comment">/* display context-sensitive help */</span>
<a name="l00368"></a>00368                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">command_mode</a>==<a class="code" href="cgiutils_8h.html#a082df0eb1517a3361f75150080d22dca">CMDMODE_COMMIT</a>)
<a name="l00369"></a>00369                         <a class="code" href="cgiutils_8c.html#ab94cab39ca6542fc720228051971b0bb">display_context_help</a>(<a class="code" href="cgiutils_8h.html#ab83d381f344379edc3d3ae3e88a51cad">CONTEXTHELP_CMD_COMMIT</a>);
<a name="l00370"></a>00370                 <span class="keywordflow">else</span>
<a name="l00371"></a>00371                         <a class="code" href="cgiutils_8c.html#ab94cab39ca6542fc720228051971b0bb">display_context_help</a>(<a class="code" href="cgiutils_8h.html#ad6eb86abb2a470d547485761726b8ce4">CONTEXTHELP_CMD_INPUT</a>);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373                 printf(<span class="stringliteral">&quot;&lt;/td&gt;\n&quot;</span>);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375                 <span class="comment">/* end of top table */</span>
<a name="l00376"></a>00376                 printf(<span class="stringliteral">&quot;&lt;/tr&gt;\n&quot;</span>);
<a name="l00377"></a>00377                 printf(<span class="stringliteral">&quot;&lt;/table&gt;\n&quot;</span>);
<a name="l00378"></a>00378         }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380         <span class="comment">/* if no command was specified... */</span>
<a name="l00381"></a>00381         <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">command_type</a>==<a class="code" href="include_2common_8h.html#a29878fb9d1aa37f0a2a05dbd83a4e856">CMD_NONE</a>){
<a name="l00382"></a>00382                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Error: No command was specified!&quot;</span>,NULL,2);
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385         <span class="comment">/* if not authorized to perform commands*/</span>
<a name="l00386"></a>00386         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cgiauth_8c.html#a490b02ce100f808d40a8295fbfe88cf5">is_authorized_for_read_only</a>(&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l00387"></a>00387                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Error: It appears as though you do not have permission to perform any commands!&quot;</span>,NULL,1);
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="comment">/* if this is the first request for a command, present option */</span>
<a name="l00391"></a>00391         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">command_mode</a>==<a class="code" href="cgiutils_8h.html#af5b1cdd5470876f4c567bb3b92ed069d">CMDMODE_REQUEST</a>)
<a name="l00392"></a>00392                 <a class="code" href="cmd_8c.html#aed41d65bce45b47a7a13dc7092742c67" title="Print form for all details to submit command.">request_command_data</a>(<a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">command_type</a>);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394         <span class="comment">/* the user wants to commit the command */</span>
<a name="l00395"></a>00395         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">command_mode</a>==<a class="code" href="cgiutils_8h.html#a082df0eb1517a3361f75150080d22dca">CMDMODE_COMMIT</a>)
<a name="l00396"></a>00396                 <a class="code" href="cmd_8c.html#a8859f113fed8a091483259d3071c623f" title="submits the command data and checks for sanity">commit_command_data</a>(<a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">command_type</a>);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398         <a class="code" href="cgiutils_8c.html#a97bcfd941bfebba5c7245f8ecbd3b225">document_footer</a>(<a class="code" href="avail_8c.html#a3c8d1949fbb23e0a8f32cc27cb92185b">CGI_ID</a>);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="comment">/* free allocated memory */</span>
<a name="l00401"></a>00401         <a class="code" href="base_2utils_8c.html#ae49e5228711e021ca4ea8da8e4d2f447">free_memory</a>();
<a name="l00402"></a>00402         <a class="code" href="objects_8c.html#af2ba8f99f76463ff1dff5c1571117f07">free_object_data</a>();
<a name="l00403"></a>00403 
<a name="l00404"></a>00404         <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="keywordtype">int</span> <a class="code" href="avail_8c.html#a73ec04c6739a0c63d052122f210d6571">process_cgivars</a>(<span class="keywordtype">void</span>){
<a name="l00408"></a>00408         <span class="keywordtype">char</span> **variables;
<a name="l00409"></a>00409         <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#aa6a44bb7540c4f54ca854e7eccc677c0">error</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00410"></a>00410         <span class="keywordtype">int</span> x;
<a name="l00411"></a>00411         <span class="keywordtype">int</span> z = 0;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413         variables=<a class="code" href="getcgi_8c.html#a6d578adebdc838cb67e74ad9ea1607db">getcgivars</a>();
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         <span class="comment">/* Process the variables */</span>
<a name="l00416"></a>00416         <span class="keywordflow">for</span>(x=0;variables[x]!=NULL;x++){
<a name="l00417"></a>00417 
<a name="l00418"></a>00418                 <span class="comment">/* do some basic length checking on the variable identifier to prevent buffer overflows */</span>
<a name="l00419"></a>00419                 <span class="keywordflow">if</span>(strlen(variables[x])&gt;=<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>-1){
<a name="l00420"></a>00420                         x++;
<a name="l00421"></a>00421                         <span class="keywordflow">continue</span>;
<a name="l00422"></a>00422                 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424                 <span class="comment">/* we found the command type */</span>
<a name="l00425"></a>00425                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;cmd_typ&quot;</span>)){
<a name="l00426"></a>00426                         x++;
<a name="l00427"></a>00427                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00428"></a>00428                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00429"></a>00429                                 <span class="keywordflow">break</span>;
<a name="l00430"></a>00430                         }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432                         <a class="code" href="cmd_8c.html#aad8add9cf04edfe6e0a2e03d448bca52">command_type</a>=atoi(variables[x]);
<a name="l00433"></a>00433                 }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435                 <span class="comment">/* we found the command mode */</span>
<a name="l00436"></a>00436                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;cmd_mod&quot;</span>)){
<a name="l00437"></a>00437                         x++;
<a name="l00438"></a>00438                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00439"></a>00439                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00440"></a>00440                                 <span class="keywordflow">break</span>;
<a name="l00441"></a>00441                         }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443                         <a class="code" href="cmd_8c.html#af02cdd542aa68d92dfab9382dfffc22d">command_mode</a>=atoi(variables[x]);
<a name="l00444"></a>00444                 }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446                 <span class="comment">/* we found a comment id or a downtime id*/</span>
<a name="l00447"></a>00447                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;com_id&quot;</span>) || !strcmp(variables[x],<span class="stringliteral">&quot;down_id&quot;</span>)){
<a name="l00448"></a>00448                         x++;
<a name="l00449"></a>00449                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00450"></a>00450                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00451"></a>00451                                 <span class="keywordflow">break</span>;
<a name="l00452"></a>00452                         }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454                         <a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[z]=strtoul(variables[x],NULL,10);
<a name="l00455"></a>00455                         z++;
<a name="l00456"></a>00456                 }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458                 <span class="comment">/* we found the notification delay */</span>
<a name="l00459"></a>00459                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;not_dly&quot;</span>)){
<a name="l00460"></a>00460                         x++;
<a name="l00461"></a>00461                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00462"></a>00462                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00463"></a>00463                                 <span class="keywordflow">break</span>;
<a name="l00464"></a>00464                         }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466                         <a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>=atoi(variables[x]);
<a name="l00467"></a>00467                 }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469                 <span class="comment">/* we found the schedule delay */</span>
<a name="l00470"></a>00470                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;sched_dly&quot;</span>)){
<a name="l00471"></a>00471                         x++;
<a name="l00472"></a>00472                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00473"></a>00473                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00474"></a>00474                                 <span class="keywordflow">break</span>;
<a name="l00475"></a>00475                         }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477                         <a class="code" href="cmd_8c.html#ad5481c62c063787258f51f2a5526edcf">schedule_delay</a>=atoi(variables[x]);
<a name="l00478"></a>00478                 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480                 <span class="comment">/* we found the comment author */</span>
<a name="l00481"></a>00481                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;com_author&quot;</span>)){
<a name="l00482"></a>00482                         x++;
<a name="l00483"></a>00483                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00484"></a>00484                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00485"></a>00485                                 <span class="keywordflow">break</span>;
<a name="l00486"></a>00486                         }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488                         <span class="keywordflow">if</span>((<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00489"></a>00489                                 <a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00490"></a>00490                         <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l00491"></a>00491                 }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493                 <span class="comment">/* we found the comment data */</span>
<a name="l00494"></a>00494                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;com_data&quot;</span>)){
<a name="l00495"></a>00495                         x++;
<a name="l00496"></a>00496                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00497"></a>00497                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00498"></a>00498                                 <span class="keywordflow">break</span>;
<a name="l00499"></a>00499                         }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501                         <span class="keywordflow">if</span>((<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00502"></a>00502                                 <a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00503"></a>00503                         <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l00504"></a>00504                 }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506                 <span class="comment">/* we found the host name */</span>
<a name="l00507"></a>00507                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;host&quot;</span>)){
<a name="l00508"></a>00508                         x++;
<a name="l00509"></a>00509                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00510"></a>00510                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00511"></a>00511                                 <span class="keywordflow">break</span>;
<a name="l00512"></a>00512                         }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514                         <span class="keywordflow">if</span>((<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00515"></a>00515                                 <a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00516"></a>00516                         <span class="keywordflow">else</span> {
<a name="l00517"></a>00517                                 <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l00518"></a>00518 
<a name="l00519"></a>00519                                 <span class="comment">/* Store hostname in struct */</span>
<a name="l00520"></a>00520                                 <a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="structhostlist.html#a32b4b0736d19b344ed6d9807d714b986">host_name</a> = <a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>;
<a name="l00521"></a>00521                         }
<a name="l00522"></a>00522                 }
<a name="l00523"></a>00523 
<a name="l00524"></a>00524                 <span class="comment">/* we found the hostgroup name */</span>
<a name="l00525"></a>00525                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;hostgroup&quot;</span>)){
<a name="l00526"></a>00526                         x++;
<a name="l00527"></a>00527                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00528"></a>00528                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00529"></a>00529                                 <span class="keywordflow">break</span>;
<a name="l00530"></a>00530                         }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532                         <span class="keywordflow">if</span>((<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00533"></a>00533                                 <a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00534"></a>00534                         <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l00535"></a>00535                 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537                 <span class="comment">/* we found the service name */</span>
<a name="l00538"></a>00538                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;service&quot;</span>)){
<a name="l00539"></a>00539                         x++;
<a name="l00540"></a>00540                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00541"></a>00541                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00542"></a>00542                                 <span class="keywordflow">break</span>;
<a name="l00543"></a>00543                         }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                         <span class="keywordflow">if</span>((<a class="code" href="avail_8c.html#abcaaec3b3fa5930176e13f734a73ecde">service_desc</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00546"></a>00546                                 <a class="code" href="avail_8c.html#abcaaec3b3fa5930176e13f734a73ecde">service_desc</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00547"></a>00547                         <span class="keywordflow">else</span> {
<a name="l00548"></a>00548                                 <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="avail_8c.html#abcaaec3b3fa5930176e13f734a73ecde">service_desc</a>);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550                                 <span class="comment">/* Store service description in struct */</span>
<a name="l00551"></a>00551                                 <a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[(x-2)].description = <a class="code" href="avail_8c.html#abcaaec3b3fa5930176e13f734a73ecde">service_desc</a>;
<a name="l00552"></a>00552                         }
<a name="l00553"></a>00553                 }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555                 <span class="comment">/* we found the servicegroup name */</span>
<a name="l00556"></a>00556                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;servicegroup&quot;</span>)){
<a name="l00557"></a>00557                         x++;
<a name="l00558"></a>00558                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00559"></a>00559                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00560"></a>00560                                 <span class="keywordflow">break</span>;
<a name="l00561"></a>00561                         }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563                         <span class="keywordflow">if</span>((<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>=(<span class="keywordtype">char</span> *)strdup(variables[x]))==NULL)
<a name="l00564"></a>00564                                 <a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00565"></a>00565                         <a class="code" href="cgiutils_8c.html#ad98d7c228c58695d08065d06fce519a0">strip_html_brackets</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l00566"></a>00566                 }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568                 <span class="comment">/* we got the persistence option for a comment */</span>
<a name="l00569"></a>00569                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;persistent&quot;</span>))
<a name="l00570"></a>00570                         <a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572                 <span class="comment">/* we got the notification option for an acknowledgement */</span>
<a name="l00573"></a>00573                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;send_notification&quot;</span>))
<a name="l00574"></a>00574                         <a class="code" href="cmd_8c.html#a891c67ceefc726acfabaa78113552c1a">send_notification</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576                 <span class="comment">/* we got the acknowledgement type */</span>
<a name="l00577"></a>00577                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;sticky_ack&quot;</span>))
<a name="l00578"></a>00578                         <a class="code" href="cmd_8c.html#a72b6dc8eb7e681d1c76ac1e84ecd5e79">sticky_ack</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580                 <span class="comment">/* we got the service check force option */</span>
<a name="l00581"></a>00581                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;force_check&quot;</span>))
<a name="l00582"></a>00582                         <a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584                 <span class="comment">/* we got the option to affect host and all its services */</span>
<a name="l00585"></a>00585                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;ahas&quot;</span>))
<a name="l00586"></a>00586                         <a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00587"></a>00587 
<a name="l00588"></a>00588                 <span class="comment">/* we got the option to propagate to child hosts */</span>
<a name="l00589"></a>00589                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;ptc&quot;</span>))
<a name="l00590"></a>00590                         <a class="code" href="cmd_8c.html#a3aa3bc94533aab17cb34c6703a252db4">propagate_to_children</a>=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00591"></a>00591 
<a name="l00592"></a>00592                 <span class="comment">/* we got the option for fixed downtime */</span>
<a name="l00593"></a>00593                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;fixed&quot;</span>)){
<a name="l00594"></a>00594                         x++;
<a name="l00595"></a>00595                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00596"></a>00596                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00597"></a>00597                                 <span class="keywordflow">break</span>;
<a name="l00598"></a>00598                         }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600                         <a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>=(atoi(variables[x])&gt;0)?<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>:<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00601"></a>00601                 }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603                 <span class="comment">/* we got the triggered by downtime option */</span>
<a name="l00604"></a>00604                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;trigger&quot;</span>)){
<a name="l00605"></a>00605                         x++;
<a name="l00606"></a>00606                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00607"></a>00607                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00608"></a>00608                                 <span class="keywordflow">break</span>;
<a name="l00609"></a>00609                         }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611                         <a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">triggered_by</a>=strtoul(variables[x],NULL,10);
<a name="l00612"></a>00612                 }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614                 <span class="comment">/* we got the child options */</span>
<a name="l00615"></a>00615                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;childoptions&quot;</span>)){
<a name="l00616"></a>00616                         x++;
<a name="l00617"></a>00617                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00618"></a>00618                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00619"></a>00619                                 <span class="keywordflow">break</span>;
<a name="l00620"></a>00620                         }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622                         <a class="code" href="cmd_8c.html#ad7dce00a0d3e7156cb54d6a7061abb00">child_options</a>=atoi(variables[x]);
<a name="l00623"></a>00623                 }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625                 <span class="comment">/* we found the plugin output */</span>
<a name="l00626"></a>00626                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;plugin_output&quot;</span>)){
<a name="l00627"></a>00627                         x++;
<a name="l00628"></a>00628                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00629"></a>00629                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00630"></a>00630                                 <span class="keywordflow">break</span>;
<a name="l00631"></a>00631                         }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633                         <span class="comment">/* protect against buffer overflows */</span>
<a name="l00634"></a>00634                         <span class="keywordflow">if</span>(strlen(variables[x])&gt;=<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>-1){
<a name="l00635"></a>00635                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00636"></a>00636                                 <span class="keywordflow">break</span>;
<a name="l00637"></a>00637                         } <span class="keywordflow">else</span>
<a name="l00638"></a>00638                                 strcpy(<a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>,variables[x]);
<a name="l00639"></a>00639                 }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641                 <span class="comment">/* we found the performance data */</span>
<a name="l00642"></a>00642                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;performance_data&quot;</span>)){
<a name="l00643"></a>00643                         x++;
<a name="l00644"></a>00644                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00645"></a>00645                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00646"></a>00646                                 <span class="keywordflow">break</span>;
<a name="l00647"></a>00647                         }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649                         <span class="comment">/* protect against buffer overflows */</span>
<a name="l00650"></a>00650                         <span class="keywordflow">if</span>(strlen(variables[x])&gt;=<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>-1){
<a name="l00651"></a>00651                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00652"></a>00652                                 <span class="keywordflow">break</span>;
<a name="l00653"></a>00653                         } <span class="keywordflow">else</span>
<a name="l00654"></a>00654                                 strcpy(<a class="code" href="cmd_8c.html#af10f6f871a018be899f199724459bc10">performance_data</a>,variables[x]);
<a name="l00655"></a>00655                 }
<a name="l00656"></a>00656 
<a name="l00657"></a>00657                 <span class="comment">/* we found the plugin state */</span>
<a name="l00658"></a>00658                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;plugin_state&quot;</span>)){
<a name="l00659"></a>00659                         x++;
<a name="l00660"></a>00660                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00661"></a>00661                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00662"></a>00662                                 <span class="keywordflow">break</span>;
<a name="l00663"></a>00663                         }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665                         <a class="code" href="cmd_8c.html#a72558e782d26e44b8764513c5f79d644">plugin_state</a>=atoi(variables[x]);
<a name="l00666"></a>00666                 }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668                 <span class="comment">/* we found the hour duration */</span>
<a name="l00669"></a>00669                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;hours&quot;</span>)){
<a name="l00670"></a>00670                         x++;
<a name="l00671"></a>00671                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00672"></a>00672                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00673"></a>00673                                 <span class="keywordflow">break</span>;
<a name="l00674"></a>00674                         }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676                         <span class="keywordflow">if</span>(atoi(variables[x])&lt;0){
<a name="l00677"></a>00677                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00678"></a>00678                                 <span class="keywordflow">break</span>;
<a name="l00679"></a>00679                         }
<a name="l00680"></a>00680                         <a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>+=(<span class="keywordtype">unsigned</span> long)(atoi(variables[x])*3600);
<a name="l00681"></a>00681                 }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683                 <span class="comment">/* we found the minute duration */</span>
<a name="l00684"></a>00684                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;minutes&quot;</span>)){
<a name="l00685"></a>00685                         x++;
<a name="l00686"></a>00686                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00687"></a>00687                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00688"></a>00688                                 <span class="keywordflow">break</span>;
<a name="l00689"></a>00689                         }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691                         <span class="keywordflow">if</span>(atoi(variables[x])&lt;0){
<a name="l00692"></a>00692                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00693"></a>00693                                 <span class="keywordflow">break</span>;
<a name="l00694"></a>00694                         }
<a name="l00695"></a>00695                         <a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>+=(<span class="keywordtype">unsigned</span> long)(atoi(variables[x])*60);
<a name="l00696"></a>00696                 }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698                 <span class="comment">/* we found the start time */</span>
<a name="l00699"></a>00699                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;start_time&quot;</span>)){
<a name="l00700"></a>00700                         x++;
<a name="l00701"></a>00701                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00702"></a>00702                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00703"></a>00703                                 <span class="keywordflow">break</span>;
<a name="l00704"></a>00704                         }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706                         <a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>=(<span class="keywordtype">char</span> *)malloc(strlen(variables[x])+1);
<a name="l00707"></a>00707                         <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>==NULL)
<a name="l00708"></a>00708                                 <a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00709"></a>00709                         <span class="keywordflow">else</span>
<a name="l00710"></a>00710                                 strcpy(<a class="code" href="cmd_8c.html#a5e20d2edff3bca92331f406d57f2bc7a">start_time_string</a>,variables[x]);
<a name="l00711"></a>00711                 }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713                 <span class="comment">/* we found the end time */</span>
<a name="l00714"></a>00714                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;end_time&quot;</span>)){
<a name="l00715"></a>00715                         x++;
<a name="l00716"></a>00716                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00717"></a>00717                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00718"></a>00718                                 <span class="keywordflow">break</span>;
<a name="l00719"></a>00719                         }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721                         <a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>=(<span class="keywordtype">char</span> *)malloc(strlen(variables[x])+1);
<a name="l00722"></a>00722                         <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>==NULL)
<a name="l00723"></a>00723                                 <a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00724"></a>00724                         <span class="keywordflow">else</span>
<a name="l00725"></a>00725                                 strcpy(<a class="code" href="cmd_8c.html#a587a386bcec8f7cd7e424ba857cb6257">end_time_string</a>,variables[x]);
<a name="l00726"></a>00726                 }
<a name="l00727"></a>00727 
<a name="l00728"></a>00728                 <span class="comment">/* we found the content type argument */</span>
<a name="l00729"></a>00729                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;content&quot;</span>)){
<a name="l00730"></a>00730                         x++;
<a name="l00731"></a>00731                         <span class="keywordflow">if</span>(variables[x]==NULL){
<a name="l00732"></a>00732                                 error=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00733"></a>00733                                 <span class="keywordflow">break</span>;
<a name="l00734"></a>00734                         }
<a name="l00735"></a>00735                         <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;wml&quot;</span>)){
<a name="l00736"></a>00736                                 <a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>=<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>;
<a name="l00737"></a>00737                                 <a class="code" href="avail_8c.html#a17b5e90c138d1b1d18eee26ff323f89e">display_header</a>=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00738"></a>00738                         } <span class="keywordflow">else</span>
<a name="l00739"></a>00739                                 <a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>=<a class="code" href="cgiutils_8h.html#a9e4256a1b327e4b8e76a269bf5287c00">HTML_CONTENT</a>;
<a name="l00740"></a>00740                 }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742                 <span class="comment">/* we found the forced notification option */</span>
<a name="l00743"></a>00743                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;force_notification&quot;</span>))
<a name="l00744"></a>00744                         <a class="code" href="cmd_8c.html#a8784590e30c25d5b86c91320abc8b5a6">force_notification</a>=<a class="code" href="include_2common_8h.html#abe6bd9d7eaffd34d1a4e3916798eaa3b">NOTIFICATION_OPTION_FORCED</a>;
<a name="l00745"></a>00745 
<a name="l00746"></a>00746                 <span class="comment">/* we found the broadcast notification option */</span>
<a name="l00747"></a>00747                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;broadcast_notification&quot;</span>))
<a name="l00748"></a>00748                         <a class="code" href="cmd_8c.html#a2ca36f69c287d587950d02b7aecdd471">broadcast_notification</a>=<a class="code" href="include_2common_8h.html#a1945ac579f8f06606f29091c88d13a5e">NOTIFICATION_OPTION_BROADCAST</a>;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750                 <span class="comment">/* we got the persistence option for a comment */</span>
<a name="l00751"></a>00751                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(variables[x],<span class="stringliteral">&quot;nodaemoncheck&quot;</span>))
<a name="l00752"></a>00752                         <a class="code" href="avail_8c.html#a8758a58819454e69684b26da2a9ab37f">daemon_check</a> = <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754                 }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756         <span class="comment">/* free memory allocated to the CGI variables */</span>
<a name="l00757"></a>00757         <a class="code" href="getcgi_8c.html#abad6259515f54432a61e074baecdbeff">free_cgivars</a>(variables);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759         <span class="keywordflow">return</span> <a class="code" href="cmd_8c.html#aa6a44bb7540c4f54ca854e7eccc677c0">error</a>;
<a name="l00760"></a>00760 }
<a name="l00761"></a>00761 
<a name="l00762"></a><a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255">00762</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<span class="keywordtype">int</span> list_type) {
<a name="l00763"></a>00763         <span class="keywordtype">int</span> x = 0;
<a name="l00764"></a>00764         <span class="keywordtype">int</span> row_color = 0;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00767"></a>00767         printf(<span class="stringliteral">&quot;&lt;tr CLASS=\&quot;sectionHeader\&quot;&gt;&lt;td COLSPAN=\&quot;2\&quot; &gt;Affected Objects&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00768"></a>00768 
<a name="l00769"></a>00769         <span class="keywordflow">if</span>(list_type==<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>)
<a name="l00770"></a>00770                 printf(<span class="stringliteral">&quot;&lt;tr class=\&quot;objectDescription\&quot;&gt;&lt;td width=\&quot;50%%\&quot;&gt;Host&lt;/td&gt;&lt;td width=\&quot;50%%\&quot;&gt;Service&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00771"></a>00771         <span class="keywordflow">else</span>
<a name="l00772"></a>00772                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00773"></a>00773 
<a name="l00774"></a>00774         <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l00775"></a>00775 
<a name="l00776"></a>00776                 <span class="keywordflow">if</span> (list_type==<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a> || list_type==<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a> ){
<a name="l00777"></a>00777                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l00778"></a>00778                                 <span class="keywordflow">continue</span>;
<a name="l00779"></a>00779                 } <span class="keywordflow">else</span> {
<a name="l00780"></a>00780                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00781"></a>00781                                 <span class="keywordflow">continue</span>;
<a name="l00782"></a>00782                 }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784                 row_color = (row_color==0)?1:0;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786                 printf(<span class="stringliteral">&quot;&lt;tr class=\&quot;status%s\&quot;&gt;&lt;td width=\&quot;50%%\&quot;&quot;</span>,(row_color==0)?<span class="stringliteral">&quot;Even&quot;</span>:<span class="stringliteral">&quot;Odd &quot;</span>);
<a name="l00787"></a>00787                 <span class="keywordflow">if</span> (list_type==<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>){
<a name="l00788"></a>00788                         <span class="comment">/* if hostname is empty print inputbox instead */</span>
<a name="l00789"></a>00789                         <span class="keywordflow">if</span>(!strcmp(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00790"></a>00790                                 printf(<span class="stringliteral">&quot;&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;host&#39; SIZE=30&gt;&lt;/td&gt;&quot;</span>);
<a name="l00791"></a>00791                         <span class="keywordflow">else</span>
<a name="l00792"></a>00792                                 printf(<span class="stringliteral">&quot;&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;host&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name));
<a name="l00793"></a>00793                         <span class="comment">/* if service description is empty print inputbox instead */</span>
<a name="l00794"></a>00794                         <span class="keywordflow">if</span>(!strcmp(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00795"></a>00795                                 printf(<span class="stringliteral">&quot;&lt;td&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;service&#39; SIZE=30&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00796"></a>00796                         <span class="keywordflow">else</span>
<a name="l00797"></a>00797                                 printf(<span class="stringliteral">&quot;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;service&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description));
<a name="l00798"></a>00798                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (list_type==<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>){
<a name="l00799"></a>00799                         <span class="comment">/* if hostname is empty print inputbox instead */</span>
<a name="l00800"></a>00800                         <span class="keywordflow">if</span>(!strcmp(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00801"></a>00801                                 printf(<span class="stringliteral">&quot; style=\&quot;font-weight:bold;\&quot;&gt;Host:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;host&#39; SIZE=30&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00802"></a>00802                         <span class="keywordflow">else</span>
<a name="l00803"></a>00803                                 printf(<span class="stringliteral">&quot; style=\&quot;font-weight:bold;\&quot;&gt;Host:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;host&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name));
<a name="l00804"></a>00804                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (list_type==<a class="code" href="cmd_8c.html#a46237026829582187c9f48046ac701c2">PRINT_COMMENT_LIST</a>){
<a name="l00805"></a>00805                         printf(<span class="stringliteral">&quot; style=\&quot;font-weight:bold;\&quot;&gt;Comment ID:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;com_id&#39; VALUE=&#39;%lu&#39;&gt;%lu&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x],<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l00806"></a>00806                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (list_type==<a class="code" href="cmd_8c.html#a752e0923edd9c335c636c19e8cc3d354">PRINT_DOWNTIME_LIST</a>){
<a name="l00807"></a>00807                         printf(<span class="stringliteral">&quot; style=\&quot;font-weight:bold;\&quot;&gt;Scheduled Downtime ID:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;down_id&#39; VALUE=&#39;%lu&#39;&gt;%lu&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x],<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l00808"></a>00808                 }
<a name="l00809"></a>00809         }
<a name="l00810"></a>00810 
<a name="l00811"></a>00811         <span class="keywordflow">return</span>;
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a><a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365">00814</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<span class="keywordtype">char</span> *content) {
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         printf(<span class="stringliteral">&quot;&lt;img src=&#39;%s%s&#39; onMouseOver=\&quot;return tooltip(&#39;&lt;table border=0 width=100%% height=100%%&gt;&quot;</span>,<a class="code" href="avail_8c.html#aca7df0d6cf5e9f0d6c3492b6e7238536">url_images_path</a>,<a class="code" href="cgiutils_8h.html#a05bfb1e94312db4e7a297c3e33565182">CONTEXT_HELP_ICON1</a>);
<a name="l00817"></a>00817         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;&quot;</span>,content);
<a name="l00818"></a>00818         printf(<span class="stringliteral">&quot;&lt;/table&gt;&#39;, &#39;&amp;nbsp;&amp;nbsp;&amp;nbsp;Help&#39;, &#39;border:1, width:500, xoffset:-250, yoffset:25, bordercolor:#333399, title_padding:2px, titletextcolor:#FFFFFF, backcolor:#CCCCFF&#39;);\&quot; onMouseOut=\&quot;return hideTip()\&quot;&quot;</span>);
<a name="l00819"></a>00819         printf(<span class="stringliteral">&quot; BORDER=0&gt;&quot;</span>);
<a name="l00820"></a>00820         <span class="keywordflow">return</span>;
<a name="l00821"></a>00821 }
<a name="l00822"></a>00822 
<a name="l00823"></a><a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b">00823</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<span class="keywordtype">int</span> element,<span class="keywordtype">int</span> cmd) {
<a name="l00824"></a>00824         time_t t;
<a name="l00825"></a>00825         <span class="keywordtype">char</span> buffer[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>];
<a name="l00826"></a>00826 
<a name="l00827"></a>00827         <span class="keywordflow">switch</span>(element) {
<a name="l00828"></a>00828 
<a name="l00829"></a>00829         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>:
<a name="l00830"></a>00830                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00831"></a>00831                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot; CLASS=&#39;sectionHeader&#39;&gt;Common Data&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00832"></a>00832                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00833"></a>00833                 <span class="keywordflow">break</span>;
<a name="l00834"></a>00834 
<a name="l00835"></a>00835         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>:
<a name="l00836"></a>00836                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Author (Your Name):&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00837"></a>00837                 <span class="keywordflow">if</span> (<a class="code" href="cgiutils_8c.html#a96cfe0add1d7f974dcc7bd87a929cb84">lock_author_names</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00838"></a>00838                         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;com_author&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>));
<a name="l00839"></a>00839                 <span class="keywordflow">else</span>
<a name="l00840"></a>00840                         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;INPUT&#39; NAME=&#39;com_author&#39; VALUE=&#39;%s&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>));
<a name="l00841"></a>00841                 <span class="keywordflow">break</span>;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>:
<a name="l00844"></a>00844 
<a name="l00845"></a>00845                 strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;If you work with other administrators, you may find it useful to share information about a host/service &quot;</span>
<a name="l00846"></a>00846                                  <span class="stringliteral">&quot;that is having problems if more than one of you may be working on it. &quot;</span>
<a name="l00847"></a>00847                                  <span class="stringliteral">&quot;Make sure to enter a brief description of what you are doing.&quot;</span>);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Comment:&quot;</span>);
<a name="l00850"></a>00850                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00851"></a>00851                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00852"></a>00852                 printf(<span class="stringliteral">&quot;&lt;TEXTAREA ID=\&quot;com_data\&quot; NAME=&#39;com_data&#39; COLS=25 ROWS=2 onkeyup=\&quot;check_input();\&quot;&gt;%s&lt;/TEXTAREA&gt;&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>));
<a name="l00853"></a>00853                 printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;DIV ID=&#39;com_data_error&#39; class=\&quot;inputError\&quot; style=\&quot;display:none;\&quot;&gt;Comment data can&#39;t be send empty&lt;/DIV&gt;&quot;</span>);
<a name="l00854"></a>00854                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00855"></a>00855                 <span class="keywordflow">break</span>;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a4b32eb4866f6a24727422571a8d69350">PRINT_CHECK_OUTPUT_BOX</a>:
<a name="l00858"></a>00858 
<a name="l00859"></a>00859                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Fill in the exact output string which sould be sent to %s&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00860"></a>00860                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00861"></a>00861 
<a name="l00862"></a>00862                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Check Output:&quot;</span>);
<a name="l00863"></a>00863                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00864"></a>00864                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00865"></a>00865                 printf(<span class="stringliteral">&quot;&lt;TEXTAREA ID=\&quot;plugin_output\&quot; NAME=&#39;plugin_output&#39; COLS=25 ROWS=2  onkeyup=\&quot;check_input();\&quot;&gt;&lt;/TEXTAREA&gt;&quot;</span>);
<a name="l00866"></a>00866                 printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;DIV ID=&#39;plugin_output_error&#39; class=\&quot;inputError\&quot; style=\&quot;display:none;\&quot;&gt;Output string can&#39;t be send empty&lt;/DIV&gt;&quot;</span>);
<a name="l00867"></a>00867                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00868"></a>00868                 <span class="keywordflow">break</span>;
<a name="l00869"></a>00869 
<a name="l00870"></a>00870         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a84e39a146adab49fb3a9b8cb4194853b">PRINT_PERFORMANCE_DATA_BOX</a>:
<a name="l00871"></a>00871 
<a name="l00872"></a>00872                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Fill in the exact performance data string which sould be sent to %s&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00873"></a>00873                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00874"></a>00874 
<a name="l00875"></a>00875                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Performance Data:&quot;</span>);
<a name="l00876"></a>00876                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00877"></a>00877                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00878"></a>00878                 printf(<span class="stringliteral">&quot;&lt;TEXTAREA NAME=&#39;performance_data&#39; COLS=25 ROWS=2&gt;&lt;/TEXTAREA&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00879"></a>00879                 <span class="keywordflow">break</span>;
<a name="l00880"></a>00880 
<a name="l00881"></a>00881         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a1e6d11bdf1bfe19430ffd7816970408a">PRINT_STICKY_ACK</a>:
<a name="l00882"></a>00882 
<a name="l00883"></a>00883                 strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;If you want acknowledgement to disable notifications until the host/service recovers, check this option.&quot;</span>);
<a name="l00884"></a>00884 
<a name="l00885"></a>00885                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Sticky Acknowledgement:&quot;</span>);
<a name="l00886"></a>00886                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00887"></a>00887                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00888"></a>00888                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;sticky_ack&#39; CHECKED&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00889"></a>00889                 <span class="keywordflow">break</span>;
<a name="l00890"></a>00890 
<a name="l00891"></a>00891         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a4dcc7d5d0bea4d9173c39aff95aee151">PRINT_SEND_NOTFICATION</a>:
<a name="l00892"></a>00892 
<a name="l00893"></a>00893                 strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;If you do not want an acknowledgement notification sent out to the appropriate contacts, uncheck this option.&quot;</span>);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Send Notification:&quot;</span>);
<a name="l00896"></a>00896                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00897"></a>00897                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00898"></a>00898                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;send_notification&#39; CHECKED&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00899"></a>00899                 <span class="keywordflow">break</span>;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#ac3b3e827c29cd7f1a02322fc093d41ba">PRINT_PERSISTENT</a>:
<a name="l00902"></a>00902 
<a name="l00903"></a>00903                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a> || cmd==<a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>)
<a name="l00904"></a>00904                         strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;If you would like the comment to remain once the acknowledgement is removed, check this checkbox.&quot;</span>);
<a name="l00905"></a>00905                 <span class="keywordflow">else</span> {
<a name="l00906"></a>00906                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;If you uncheck this option, the comment will automatically be deleted the next time %s is restarted.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00907"></a>00907                         <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00908"></a>00908                 }
<a name="l00909"></a>00909                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Persistent%s:&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a> || cmd==<a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>)?<span class="stringliteral">&quot; Comment&quot;</span>:<span class="stringliteral">&quot;&quot;</span>);
<a name="l00910"></a>00910                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00911"></a>00911                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00912"></a>00912                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;persistent&#39; %s&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,( <a class="code" href="cgiutils_8c.html#a9531538c18dc48bad32b0df6b0b072aa">persistent_ack_comments</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> || cmd==<a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a> )?<span class="stringliteral">&quot;CHECKED&quot;</span>:<span class="stringliteral">&quot;&quot;</span>);
<a name="l00913"></a>00913                 <span class="keywordflow">break</span>;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#afb881756569d660675c95410d0ed21c4">PRINT_NOTIFICATION_DELAY</a>:
<a name="l00916"></a>00916 
<a name="l00917"></a>00917                 strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;The notification delay will be disregarded if the host/service changes state before the next notification is scheduled to be sent out.&quot;</span>);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Notification Delay (minutes from now):&quot;</span>);
<a name="l00920"></a>00920                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00921"></a>00921                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00922"></a>00922                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;TEXT&#39; ID=&#39;not_dly&#39; NAME=&#39;not_dly&#39; VALUE=&#39;%d&#39; SIZE=\&quot;4\&quot;&gt;&quot;</span>,<a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>);
<a name="l00923"></a>00923                 printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;DIV ID=&#39;not_dly_error&#39; class=\&quot;inputError\&quot; style=\&quot;display:none;\&quot;&gt;Notification delay can&#39;t be zero&lt;/DIV&gt;&quot;</span>);
<a name="l00924"></a>00924                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00925"></a>00925                 <span class="keywordflow">break</span>;
<a name="l00926"></a>00926 
<a name="l00927"></a>00927         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a931ecb1e2b0a4b0171d7cf03a2a801a9">PRINT_START_TIME</a>:
<a name="l00928"></a>00928         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a>:
<a name="l00929"></a>00929         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a345b2c1603fcb60ca53f41a3b64a84db">PRINT_CHECK_TIME</a>:
<a name="l00930"></a>00930                 time(&amp;t);
<a name="l00931"></a>00931                 <span class="keywordflow">if</span> (element == <a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a> )
<a name="l00932"></a>00932                         t+=(<span class="keywordtype">unsigned</span> long)7200;
<a name="l00933"></a>00933                 <a class="code" href="cgiutils_8c.html#ac2ab6d1c01c10c6d18247c25637018de">get_time_string</a>(&amp;t,buffer,<span class="keyword">sizeof</span>(buffer)-1,<a class="code" href="include_2common_8h.html#a0e340fb0d5261012218a269341dc60ab">SHORT_DATE_TIME</a>);
<a name="l00934"></a>00934                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;&quot;</span>);
<a name="l00935"></a>00935                 <span class="keywordflow">if</span> (element == <a class="code" href="cmd_8c.html#a931ecb1e2b0a4b0171d7cf03a2a801a9">PRINT_START_TIME</a> ){
<a name="l00936"></a>00936                         strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;Set the start date/time for the downtime.&quot;</span>);
<a name="l00937"></a>00937                         printf(<span class="stringliteral">&quot;Start Time:&quot;</span>);
<a name="l00938"></a>00938                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (element == <a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a> ){
<a name="l00939"></a>00939                         strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;Set the end date/time for the downtime.&quot;</span>);
<a name="l00940"></a>00940                         printf(<span class="stringliteral">&quot;End Time:&quot;</span>);
<a name="l00941"></a>00941                 }<span class="keywordflow">else</span>{
<a name="l00942"></a>00942                         strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;Set the date/time when this check should be schedule to.&quot;</span>);
<a name="l00943"></a>00943                         printf(<span class="stringliteral">&quot;Check Time:&quot;</span>);
<a name="l00944"></a>00944                 }
<a name="l00945"></a>00945                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00946"></a>00946                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;%s_time&#39; VALUE=&#39;%s&#39; SIZE=\&quot;25\&quot;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,(element == <a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a> )?<span class="stringliteral">&quot;end&quot;</span>:<span class="stringliteral">&quot;start&quot;</span>,buffer);
<a name="l00947"></a>00947                 <span class="keywordflow">break</span>;
<a name="l00948"></a>00948 
<a name="l00949"></a>00949         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a43f6b9650f6014f525c4db5a497494b0">PRINT_FIXED_FLEXIBLE_TYPE</a>:
<a name="l00950"></a>00950 
<a name="l00951"></a>00951                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;If you select the &lt;i&gt;fixed&lt;/i&gt; option, the downtime will be in effect between the start and end times you specify. If you do not select the &lt;i&gt;fixed&lt;/i&gt; &quot;</span>
<a name="l00952"></a>00952                                  <span class="stringliteral">&quot;option, %s will treat this as &lt;i&gt;flexible&lt;/i&gt; downtime. Flexible downtime starts when the host goes down or becomes unreachable / service becomes critical (sometime between the &quot;</span>
<a name="l00953"></a>00953                                  <span class="stringliteral">&quot;start and end times you specified) and lasts as long as the duration of time you enter. The duration fields do not apply for fixed downtime.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00954"></a>00954                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Type:&quot;</span>);
<a name="l00957"></a>00957                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00958"></a>00958                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l00959"></a>00959 
<a name="l00960"></a>00960                 printf(<span class="stringliteral">&quot;\t&lt;SELECT ID=\&quot;flexible_selection\&quot; NAME=&#39;fixed&#39; onChange=\&quot;if (document.getElementById(&#39;flexible_selection&#39;).selectedIndex == 0) document.getElementById(&#39;fd_row&#39;).style.display = &#39;none&#39;; else document.getElementById(&#39;fd_row&#39;).style.display = &#39;&#39;;\&quot;&gt;\n&quot;</span>);
<a name="l00961"></a>00961                 printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=1\&quot;&gt;Fixed&lt;/OPTION&gt;\n&quot;</span>);
<a name="l00962"></a>00962                 printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=0\&quot;&gt;Flexible&lt;/OPTION&gt;\n&quot;</span>);
<a name="l00963"></a>00963                 printf(<span class="stringliteral">&quot;\t&lt;/SELECT&gt;\n&quot;</span>);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Enter here the duration of the downtime. %s will automatically delete the downtime after this time expired.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00966"></a>00966                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968                 printf(<span class="stringliteral">&quot;&lt;tr id=\&quot;fd_row\&quot; style=\&quot;display:none;\&quot;&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Flexible Duration:&quot;</span>);
<a name="l00969"></a>00969                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00970"></a>00970                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l00971"></a>00971                 printf(<span class="stringliteral">&quot;\t&lt;table border=0  cellspacing=0 cellpadding=0&gt;\n&quot;</span>);
<a name="l00972"></a>00972                 printf(<span class="stringliteral">&quot;\t\t&lt;tr&gt;\n&quot;</span>);
<a name="l00973"></a>00973                 printf(<span class="stringliteral">&quot;\t\t\t&lt;td&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;hours&#39; VALUE=&#39;2&#39; SIZE=2 MAXLENGTH=2&gt;&lt;/td&gt;\n&quot;</span>);
<a name="l00974"></a>00974                 printf(<span class="stringliteral">&quot;\t\t\t&lt;td width=\&quot;50\&quot;&gt;&amp;nbsp;Hours&lt;/td&gt;\n&quot;</span>);
<a name="l00975"></a>00975                 printf(<span class="stringliteral">&quot;\t\t\t&lt;td&gt;&lt;INPUT TYPE=&#39;TEXT&#39; NAME=&#39;minutes&#39; VALUE=&#39;0&#39; SIZE=2 MAXLENGTH=2&gt;&lt;/td&gt;\n&quot;</span>);
<a name="l00976"></a>00976                 printf(<span class="stringliteral">&quot;\t\t\t&lt;td width=\&quot;50\&quot;&gt;&amp;nbsp;Minutes&lt;/td&gt;\n&quot;</span>);
<a name="l00977"></a>00977                 printf(<span class="stringliteral">&quot;\t\t&lt;/tr&gt;\n&quot;</span>);
<a name="l00978"></a>00978                 printf(<span class="stringliteral">&quot;\t&lt;/table&gt;\n&quot;</span>);
<a name="l00979"></a>00979                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l00980"></a>00980                 <span class="keywordflow">break</span>;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a706bc1d19f4844a0a1b58ad9e5862eb3">PRINT_FORCE_CHECK</a>:
<a name="l00983"></a>00983 
<a name="l00984"></a>00984                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;If you select this option, %s will force a check of the host/service regardless of both what time the scheduled check occurs and whether or not checks are enabled for the host/service.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l00985"></a>00985                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l00986"></a>00986 
<a name="l00987"></a>00987                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Force Check:&quot;</span>);
<a name="l00988"></a>00988                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00989"></a>00989                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l00990"></a>00990                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;force_check&#39; %s&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,(<a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)?<span class="stringliteral">&quot;CHECKED&quot;</span>:<span class="stringliteral">&quot;&quot;</span>);
<a name="l00991"></a>00991                 <span class="keywordflow">break</span>;
<a name="l00992"></a>00992 
<a name="l00993"></a>00993         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a9f70a74726f225c57336802a087350c3">PRINT_BROADCAST_NOTIFICATION</a>:
<a name="l00994"></a>00994 
<a name="l00995"></a>00995                 strcpy(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="stringliteral">&quot;Selecting this option causes the notification to be sent out to all normal (non-escalated) and escalated contacts. These options allow you to override the normal notification logic if you need to get an important message out.&quot;</span>);
<a name="l00996"></a>00996 
<a name="l00997"></a>00997                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Broadcast:&quot;</span>);
<a name="l00998"></a>00998                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l00999"></a>00999                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l01000"></a>01000                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;broadcast_notification&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01001"></a>01001                 <span class="keywordflow">break</span>;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003         <span class="keywordflow">case</span> <a class="code" href="cmd_8c.html#a939639369cabf53029528fe52a35188d">PRINT_FORCE_NOTIFICATION</a>:
<a name="l01004"></a>01004 
<a name="l01005"></a>01005                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Custom notifications normally follow the regular notification logic in %s.  Selecting this option will force the notification to be sent out, regardless of the time restrictions, whether or not notifications are enabled, etc.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01006"></a>01006                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Forced:&quot;</span>);
<a name="l01009"></a>01009                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01010"></a>01010                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&quot;</span>);
<a name="l01011"></a>01011                 printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;force_notification&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01012"></a>01012                 <span class="keywordflow">break</span>;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014         <span class="keywordflow">default</span>:
<a name="l01015"></a>01015                 <span class="keywordflow">break</span>;
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018         <span class="keywordflow">return</span>;
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a><a class="code" href="cmd_8c.html#aed41d65bce45b47a7a13dc7092742c67">01021</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#aed41d65bce45b47a7a13dc7092742c67" title="Print form for all details to submit command.">request_command_data</a>(<span class="keywordtype">int</span> cmd){
<a name="l01022"></a>01022         <span class="keywordtype">char</span> <a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>[<a class="code" href="include_2common_8h.html#abc3b7b3fb4b6d28cf55211a0e83f43e7">MAX_DATETIME_LENGTH</a>];
<a name="l01023"></a>01023         <a class="code" href="structcontact__struct.html">contact</a> *temp_contact;
<a name="l01024"></a>01024         <a class="code" href="structscheduled__downtime__struct.html">scheduled_downtime</a> *temp_downtime;
<a name="l01025"></a>01025         <a class="code" href="structhost__struct.html">host</a> *temp_host=NULL;
<a name="l01026"></a>01026         <span class="keywordtype">char</span> action[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>];
<a name="l01027"></a>01027         <span class="keywordtype">int</span> found_trigger_objects=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01028"></a>01028 
<a name="l01029"></a>01029         <span class="comment">/* get default name to use for comment author */</span>
<a name="l01030"></a>01030         temp_contact=<a class="code" href="objects_8c.html#a5293c9bf6790cf9f1c795ea2116dc96c">find_contact</a>(current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>);
<a name="l01031"></a>01031         <span class="keywordflow">if</span>(temp_contact!=NULL &amp;&amp; temp_contact-&gt;<a class="code" href="structcontact__struct.html#abfdf4076ba4139741160db3d0f4f990a">alias</a>!=NULL)
<a name="l01032"></a>01032                 <a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=temp_contact-&gt;<a class="code" href="structcontact__struct.html#abfdf4076ba4139741160db3d0f4f990a">alias</a>;
<a name="l01033"></a>01033         <span class="keywordflow">else</span>
<a name="l01034"></a>01034                 <a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036         printf(<span class="stringliteral">&quot;&lt;BR&gt;&quot;</span>);
<a name="l01037"></a>01037 
<a name="l01038"></a>01038         <span class="keywordflow">switch</span>(cmd){
<a name="l01039"></a>01039 
<a name="l01040"></a>01040         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a>:
<a name="l01041"></a>01041         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a>:
<a name="l01042"></a>01042                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Add %s comments&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01043"></a>01043                 <span class="keywordflow">break</span>;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>:
<a name="l01046"></a>01046         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>:
<a name="l01047"></a>01047                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Delete %s comments&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01048"></a>01048                 <span class="keywordflow">break</span>;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>:
<a name="l01051"></a>01051         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a>:
<a name="l01052"></a>01052                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to delay the next problem notification that is sent out for specified %s. The notification delay will be disregarded if &quot;</span>
<a name="l01053"></a>01053                         <span class="stringliteral">&quot;the %s changes state before the next notification is scheduled to be sent out.  This command has no effect if the %s are currently %s.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;UP&quot;</span>:<span class="stringliteral">&quot;in an OK state&quot;</span>);
<a name="l01054"></a>01054                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Delay a %s notification&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01055"></a>01055                 <span class="keywordflow">break</span>;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>:
<a name="l01058"></a>01058         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a>:
<a name="l01059"></a>01059                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to schedule the next check of these %s. %s will re-queue the %s to be checked at the time you specify.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,(cmd==<a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01060"></a>01060                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule %s checks&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01061"></a>01061                 <span class="keywordflow">break</span>;
<a name="l01062"></a>01062 
<a name="l01063"></a>01063         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1fadade3f5ab1948696ffe4489fbf367">CMD_ENABLE_SVC_CHECK</a>:
<a name="l01064"></a>01064         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9fe6fa31702949a1eb89a1ea5cc3c201">CMD_DISABLE_SVC_CHECK</a>:
<a name="l01065"></a>01065                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s active service checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a1fadade3f5ab1948696ffe4489fbf367">CMD_ENABLE_SVC_CHECK</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01066"></a>01066                 <span class="keywordflow">break</span>;
<a name="l01067"></a>01067 
<a name="l01068"></a>01068         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>:
<a name="l01069"></a>01069         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab45ce82cbb8bd87132044462b2c2cf2d">CMD_DISABLE_NOTIFICATIONS</a>:
<a name="l01070"></a>01070                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to %s host and service notifications on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;enable&quot;</span>:<span class="stringliteral">&quot;disable&quot;</span>);
<a name="l01071"></a>01071                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01072"></a>01072                 <span class="keywordflow">break</span>;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4615951f5161b6b778a6cb3938ca438e">CMD_SHUTDOWN_PROCESS</a>:
<a name="l01075"></a>01075         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae706ffbffb7f812e813c492f9805908f">CMD_RESTART_PROCESS</a>:
<a name="l01076"></a>01076                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s the %s process&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4615951f5161b6b778a6cb3938ca438e">CMD_SHUTDOWN_PROCESS</a>)?<span class="stringliteral">&quot;Shutdown&quot;</span>:<span class="stringliteral">&quot;Restart&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01077"></a>01077                 <span class="keywordflow">break</span>;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>:
<a name="l01080"></a>01080         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a>:
<a name="l01081"></a>01081                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>)
<a name="l01082"></a>01082                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to enable active checks of all services associated with the specified host&quot;</span>);
<a name="l01083"></a>01083                 <span class="keywordflow">else</span> {
<a name="l01084"></a>01084                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to disable active checks of all services associated with the specified host. &quot;</span>
<a name="l01085"></a>01085                                 <span class="stringliteral">&quot;When a service is disabled %s will not monitor the service. Doing this will prevent any notifications being sent out for &quot;</span>
<a name="l01086"></a>01086                                 <span class="stringliteral">&quot;the specified service while it is disabled. In order to have %s check the service in the future you will have to re-enable the service. &quot;</span>
<a name="l01087"></a>01087                                 <span class="stringliteral">&quot;Note that disabling service checks may not necessarily prevent notifications from being sent out about the host which those services are associated with.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01088"></a>01088                 }
<a name="l01089"></a>01089                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s active checks of all services on these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01090"></a>01090                 <span class="keywordflow">break</span>;
<a name="l01091"></a>01091 
<a name="l01092"></a>01092         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a57d2695ba57df906ef8e4b120337a7b5">CMD_SCHEDULE_HOST_SVC_CHECKS</a>:
<a name="l01093"></a>01093                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule a check of all services for these hosts&quot;</span>);
<a name="l01094"></a>01094                 <span class="keywordflow">break</span>;
<a name="l01095"></a>01095 
<a name="l01096"></a>01096         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ca6928efc44b1722cacb66e985a7a2a">CMD_DEL_ALL_HOST_COMMENTS</a>:
<a name="l01097"></a>01097         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0e43a4b4d43616ff459be2deadf28a96">CMD_DEL_ALL_SVC_COMMENTS</a>:
<a name="l01098"></a>01098                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Delete all comments for these %s&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ca6928efc44b1722cacb66e985a7a2a">CMD_DEL_ALL_HOST_COMMENTS</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01099"></a>01099                 <span class="keywordflow">break</span>;
<a name="l01100"></a>01100 
<a name="l01101"></a>01101         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9304e561328b09b21afa89742b6b6342">CMD_ENABLE_SVC_NOTIFICATIONS</a>:
<a name="l01102"></a>01102         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a954e4e9c3acc9c73b2af2ac1fc19a768">CMD_DISABLE_SVC_NOTIFICATIONS</a>:
<a name="l01103"></a>01103                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for these services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a9304e561328b09b21afa89742b6b6342">CMD_ENABLE_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01104"></a>01104                 <span class="keywordflow">break</span>;
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>:
<a name="l01107"></a>01107         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>:
<a name="l01108"></a>01108                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01109"></a>01109                 <span class="keywordflow">break</span>;
<a name="l01110"></a>01110 
<a name="l01111"></a>01111         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l01112"></a>01112         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7e79b92ba7dbe949352433e4237db6e9">CMD_DISABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l01113"></a>01113                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to %s notifications for all hosts and services that lie &lt;i&gt;beyond&lt;/i&gt; the specified host (from the view of %s).&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>)?<span class="stringliteral">&quot;enable&quot;</span>:<span class="stringliteral">&quot;disable&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01114"></a>01114                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all hosts and services beyond these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01115"></a>01115                 <span class="keywordflow">break</span>;
<a name="l01116"></a>01116 
<a name="l01117"></a>01117         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l01118"></a>01118         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l01119"></a>01119                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all services on these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01120"></a>01120                 <span class="keywordflow">break</span>;
<a name="l01121"></a>01121 
<a name="l01122"></a>01122         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a>:
<a name="l01123"></a>01123         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>:
<a name="l01124"></a>01124                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Acknowledge %s problems&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01125"></a>01125                 <span class="keywordflow">break</span>;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1f12ceeaa459f528c3c96b024ec779e8">CMD_START_EXECUTING_HOST_CHECKS</a>:
<a name="l01128"></a>01128         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a29ba7e82e9fe9279ca412208548d94a8">CMD_STOP_EXECUTING_HOST_CHECKS</a>:
<a name="l01129"></a>01129                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s executing host checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a1f12ceeaa459f528c3c96b024ec779e8">CMD_START_EXECUTING_HOST_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01130"></a>01130                 <span class="keywordflow">break</span>;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>:
<a name="l01133"></a>01133         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9d3a2978d952e95c2b28cc2aebdc7722">CMD_STOP_EXECUTING_SVC_CHECKS</a>:
<a name="l01134"></a>01134                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>)
<a name="l01135"></a>01135                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to resume execution of active service checks on a program-wide basis. Individual services which are disabled will still not be checked.&quot;</span>);
<a name="l01136"></a>01136                 <span class="keywordflow">else</span>
<a name="l01137"></a>01137                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to temporarily stop %s from actively executing any service checks.  This will have the side effect of preventing any notifications from being sent out (for any and all services and hosts). &quot;</span>
<a name="l01138"></a>01138                                 <span class="stringliteral">&quot;Service checks will not be executed again until you issue a command to resume service check execution.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01139"></a>01139                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s executing active service checks&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01140"></a>01140                 <span class="keywordflow">break</span>;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l01143"></a>01143         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3a42e556cb0f6719ed8930d7bc68ff8f">CMD_STOP_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l01144"></a>01144                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to make %s %s accepting passive service check results that it finds in the external command file.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,(cmd==<a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>)?<span class="stringliteral">&quot;start&quot;</span>:<span class="stringliteral">&quot;stop&quot;</span>);
<a name="l01145"></a>01145                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s accepting passive service checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01146"></a>01146                 <span class="keywordflow">break</span>;
<a name="l01147"></a>01147 
<a name="l01148"></a>01148         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01149"></a>01149         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a15e9d66679fcb475fc1609b8b496b850">CMD_DISABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01150"></a>01150                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>)
<a name="l01151"></a>01151                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to allow %s to accept passive service check results that it finds in the external command file for this particular service.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01152"></a>01152                 <span class="keywordflow">else</span>
<a name="l01153"></a>01153                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to stop %s accepting passive service check results that it finds in the external command file for this particular service. All passive check results that are found for this service will be ignored.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01154"></a>01154                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s accepting passive service checks for these services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01155"></a>01155                 <span class="keywordflow">break</span>;
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>:
<a name="l01158"></a>01158         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9400fb3097302ed20125524ccd964129">CMD_DISABLE_EVENT_HANDLERS</a>:
<a name="l01159"></a>01159                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>)
<a name="l01160"></a>01160                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to allow %s to run host and service event handlers.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01161"></a>01161                 <span class="keywordflow">else</span>
<a name="l01162"></a>01162                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to temporarily prevent %s from running any host or service event handlers.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01163"></a>01163                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s event handlers on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01164"></a>01164                 <span class="keywordflow">break</span>;
<a name="l01165"></a>01165 
<a name="l01166"></a>01166         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>:
<a name="l01167"></a>01167         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad1c35cdf7cdb67da028c1fe8412db2d7">CMD_DISABLE_HOST_EVENT_HANDLER</a>:
<a name="l01168"></a>01168                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to %s the event handler for the selected hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>)?<span class="stringliteral">&quot;enable&quot;</span>:<span class="stringliteral">&quot;disable&quot;</span>);
<a name="l01169"></a>01169                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s the event handler for these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01170"></a>01170                 <span class="keywordflow">break</span>;
<a name="l01171"></a>01171 
<a name="l01172"></a>01172         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>:
<a name="l01173"></a>01173         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abf243659a69ee0d3365f200294cd08e3">CMD_DISABLE_SVC_EVENT_HANDLER</a>:
<a name="l01174"></a>01174                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to %s the event handler for the selected services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>)?<span class="stringliteral">&quot;enable&quot;</span>:<span class="stringliteral">&quot;disable&quot;</span>);
<a name="l01175"></a>01175                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s the event handler for these services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01176"></a>01176                 <span class="keywordflow">break</span>;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a>:
<a name="l01179"></a>01179         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>:
<a name="l01180"></a>01180                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>)
<a name="l01181"></a>01181                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to temporarily prevent %s from actively checking the status of a particular host. If %s needs to check the status of this host, it will assume that it is in the same state that it was in before checks were disabled.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01182"></a>01182                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s active host checks&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01183"></a>01183                 <span class="keywordflow">break</span>;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a94f3dde3552de89cc330e811c02ddf7b">CMD_STOP_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l01186"></a>01186         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aef5d645e19291f05fd060c2cf53f0897">CMD_START_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l01187"></a>01187                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#aef5d645e19291f05fd060c2cf53f0897">CMD_START_OBSESSING_OVER_SVC_CHECKS</a>)
<a name="l01188"></a>01188                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to have %s start obsessing over service checks. Read the documentation on distributed monitoring for more information on this.&quot;</span>, <a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01189"></a>01189                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s obsessing over service checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a94f3dde3552de89cc330e811c02ddf7b">CMD_STOP_OBSESSING_OVER_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Stop&quot;</span>:<span class="stringliteral">&quot;Start&quot;</span>);
<a name="l01190"></a>01190                 <span class="keywordflow">break</span>;
<a name="l01191"></a>01191 
<a name="l01192"></a>01192         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>:
<a name="l01193"></a>01193         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac28397aa6cedffbab2023b60bac0d2e6">CMD_REMOVE_SVC_ACKNOWLEDGEMENT</a>:
<a name="l01194"></a>01194                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to remove an acknowledgement for %s problems. Once the acknowledgement is removed, notifications may start being &quot;</span>
<a name="l01195"></a>01195                                 <span class="stringliteral">&quot;sent out about the %s problem.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01196"></a>01196                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Remove %s acknowledgements&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01197"></a>01197                 <span class="keywordflow">break</span>;
<a name="l01198"></a>01198 
<a name="l01199"></a>01199         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>:
<a name="l01200"></a>01200         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>:
<a name="l01201"></a>01201                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to schedule downtime for these %s. During the specified downtime, %s will not send notifications out about the %s. &quot;</span>
<a name="l01202"></a>01202                         <span class="stringliteral">&quot;When the scheduled downtime expires, %s will send out notifications for this %s as it normally would.  Scheduled downtimes are preserved &quot;</span>
<a name="l01203"></a>01203                         <span class="stringliteral">&quot;across program shutdowns and restarts.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01204"></a>01204                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule downtime for these %s&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01205"></a>01205                 <span class="keywordflow">break</span>;
<a name="l01206"></a>01206 
<a name="l01207"></a>01207         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a>:
<a name="l01208"></a>01208                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to schedule downtime for a particular host and all of its services.  During the specified downtime, %s will not send notifications out about the host. &quot;</span>
<a name="l01209"></a>01209                         <span class="stringliteral">&quot;Normally, a host in downtime will not send alerts about any services in a failed state. This option will explicitly set downtime for all services for this host. &quot;</span>
<a name="l01210"></a>01210                         <span class="stringliteral">&quot;When the scheduled downtime expires, %s will send out notifications for this host as it normally would. Scheduled downtimes are preserved &quot;</span>
<a name="l01211"></a>01211                         <span class="stringliteral">&quot;across program shutdowns and restarts.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l01212"></a>01212                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule downtime for all services for these hosts and the hosts themself&quot;</span>);
<a name="l01213"></a>01213                 <span class="keywordflow">break</span>;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>:
<a name="l01216"></a>01216         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>:
<a name="l01217"></a>01217                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to submit a passive check result for these %s. &quot;</span>
<a name="l01218"></a>01218                 <span class="stringliteral">&quot;It is particularly useful for resetting security-related %s to %s states once they have been dealt with.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;UP&quot;</span>:<span class="stringliteral">&quot;OK&quot;</span>);
<a name="l01219"></a>01219 
<a name="l01220"></a>01220                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Submit a passive check result for these %s&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01221"></a>01221                 <span class="keywordflow">break</span>;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4a59d232d64b69088dc669ed09934001">CMD_ENABLE_HOST_FLAP_DETECTION</a>:
<a name="l01224"></a>01224         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa45928e7825a90937f7c0550efff08ad">CMD_DISABLE_HOST_FLAP_DETECTION</a>:
<a name="l01225"></a>01225                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s flap detection for these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4a59d232d64b69088dc669ed09934001">CMD_ENABLE_HOST_FLAP_DETECTION</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01226"></a>01226                 <span class="keywordflow">break</span>;
<a name="l01227"></a>01227 
<a name="l01228"></a>01228         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a916163bc87138000b647eb3a7a275408">CMD_ENABLE_SVC_FLAP_DETECTION</a>:
<a name="l01229"></a>01229         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae535a5cd022cbc0aafe4766f93cb94c9">CMD_DISABLE_SVC_FLAP_DETECTION</a>:
<a name="l01230"></a>01230                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s flap detection for these services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a916163bc87138000b647eb3a7a275408">CMD_ENABLE_SVC_FLAP_DETECTION</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01231"></a>01231                 <span class="keywordflow">break</span>;
<a name="l01232"></a>01232 
<a name="l01233"></a>01233         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a410b3872c3b9541b96d415190f6cfd74">CMD_ENABLE_FLAP_DETECTION</a>:
<a name="l01234"></a>01234         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1ff1981c4f64505b315755af554c65a8">CMD_DISABLE_FLAP_DETECTION</a>:
<a name="l01235"></a>01235                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s flap detection for hosts and services on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a410b3872c3b9541b96d415190f6cfd74">CMD_ENABLE_FLAP_DETECTION</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01236"></a>01236                 <span class="keywordflow">break</span>;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01239"></a>01239         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01240"></a>01240                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all services in a particular hostgroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01241"></a>01241                 <span class="keywordflow">break</span>;
<a name="l01242"></a>01242 
<a name="l01243"></a>01243         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01244"></a>01244         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01245"></a>01245                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all hosts in a particular hostgroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01246"></a>01246                 <span class="keywordflow">break</span>;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l01249"></a>01249         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l01250"></a>01250                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s active checks of all services in a particular hostgroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01251"></a>01251                 <span class="keywordflow">break</span>;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>:
<a name="l01254"></a>01254         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>:
<a name="l01255"></a>01255                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Cancel scheduled downtime for these %s&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01256"></a>01256                 <span class="keywordflow">break</span>;
<a name="l01257"></a>01257 
<a name="l01258"></a>01258         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3dd1f74a3ce6023b0de5090764317f44">CMD_ENABLE_FAILURE_PREDICTION</a>:
<a name="l01259"></a>01259         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adec8f3e8e4479e2ffaef21d12260142f">CMD_DISABLE_FAILURE_PREDICTION</a>:
<a name="l01260"></a>01260                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s failure prediction for hosts and service on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a3dd1f74a3ce6023b0de5090764317f44">CMD_ENABLE_FAILURE_PREDICTION</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01261"></a>01261                 <span class="keywordflow">break</span>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a78b643a9413d31cef72ab0d0122e2af7">CMD_ENABLE_PERFORMANCE_DATA</a>:
<a name="l01264"></a>01264         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9d3c2b1b310393e27501b034eaf9b81">CMD_DISABLE_PERFORMANCE_DATA</a>:
<a name="l01265"></a>01265                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s performance data processing for hosts and services on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a78b643a9413d31cef72ab0d0122e2af7">CMD_ENABLE_PERFORMANCE_DATA</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01266"></a>01266                 <span class="keywordflow">break</span>;
<a name="l01267"></a>01267 
<a name="l01268"></a>01268         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>:
<a name="l01269"></a>01269         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>:
<a name="l01270"></a>01270                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule downtime for all %s in a particular hostgroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01271"></a>01271                 <span class="keywordflow">break</span>;
<a name="l01272"></a>01272 
<a name="l01273"></a>01273         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0231991dd77addd3dd0a67b75fe91b99">CMD_START_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l01274"></a>01274         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a059b4514eb08898aa69f4c880833c40c">CMD_STOP_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l01275"></a>01275                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s accepting passive host checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a0231991dd77addd3dd0a67b75fe91b99">CMD_START_ACCEPTING_PASSIVE_HOST_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01276"></a>01276                 <span class="keywordflow">break</span>;
<a name="l01277"></a>01277 
<a name="l01278"></a>01278         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a50253ccba246667112a01a6c7c32c5eb">CMD_ENABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l01279"></a>01279         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0ee96e57da3e75d6b0318ebebbcadc2">CMD_DISABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l01280"></a>01280                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s accepting passive checks for these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a50253ccba246667112a01a6c7c32c5eb">CMD_ENABLE_PASSIVE_HOST_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01281"></a>01281                 <span class="keywordflow">break</span>;
<a name="l01282"></a>01282 
<a name="l01283"></a>01283         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a81eb9c67248de83dd019697521b31bd6">CMD_START_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l01284"></a>01284         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a420810b071f18ba5a40e9e9e77634762">CMD_STOP_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l01285"></a>01285                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s obsessing over host checks on a program-wide basis&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a81eb9c67248de83dd019697521b31bd6">CMD_START_OBSESSING_OVER_HOST_CHECKS</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01286"></a>01286                 <span class="keywordflow">break</span>;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adeda57bb270ad5564f5a8c3b5e23a3c5">CMD_START_OBSESSING_OVER_SVC</a>:
<a name="l01289"></a>01289         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8d23223c53e3a79fb126217a54be75c8">CMD_STOP_OBSESSING_OVER_SVC</a>:
<a name="l01290"></a>01290                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s obsessing over these services&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#adeda57bb270ad5564f5a8c3b5e23a3c5">CMD_START_OBSESSING_OVER_SVC</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01291"></a>01291                 <span class="keywordflow">break</span>;
<a name="l01292"></a>01292 
<a name="l01293"></a>01293         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a99ba56196e437148c85510c23191a8fa">CMD_START_OBSESSING_OVER_HOST</a>:
<a name="l01294"></a>01294         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a04ee1063e5ca5ded66101bb60f5c1bbd">CMD_STOP_OBSESSING_OVER_HOST</a>:
<a name="l01295"></a>01295                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s obsessing over these hosts&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a99ba56196e437148c85510c23191a8fa">CMD_START_OBSESSING_OVER_HOST</a>)?<span class="stringliteral">&quot;Start&quot;</span>:<span class="stringliteral">&quot;Stop&quot;</span>);
<a name="l01296"></a>01296                 <span class="keywordflow">break</span>;
<a name="l01297"></a>01297 
<a name="l01298"></a>01298         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01299"></a>01299         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0b364d353364414254b771c84e9256d3">CMD_DISABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01300"></a>01300                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all services in a particular servicegroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01301"></a>01301                 <span class="keywordflow">break</span>;
<a name="l01302"></a>01302 
<a name="l01303"></a>01303         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01304"></a>01304         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6c96b4300cbb5a6dc2b2c8a63ebb55ea">CMD_DISABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01305"></a>01305                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s notifications for all hosts in a particular servicegroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01306"></a>01306                 <span class="keywordflow">break</span>;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l01309"></a>01309         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad429a7756a139718439e4d8ee671a778">CMD_DISABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l01310"></a>01310                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;%s active checks of all services in a particular servicegroup&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01311"></a>01311                 <span class="keywordflow">break</span>;
<a name="l01312"></a>01312 
<a name="l01313"></a>01313         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a>:
<a name="l01314"></a>01314                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule downtime for all hosts in a particular servicegroup&quot;</span>);
<a name="l01315"></a>01315                 <span class="keywordflow">break</span>;
<a name="l01316"></a>01316 
<a name="l01317"></a>01317         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a>:
<a name="l01318"></a>01318                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Schedule downtime for all services in a particular servicegroup&quot;</span>);
<a name="l01319"></a>01319                 <span class="keywordflow">break</span>;
<a name="l01320"></a>01320 
<a name="l01321"></a>01321         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>:
<a name="l01322"></a>01322         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0846859b12e531544dce8a09778f167">CMD_SEND_CUSTOM_SVC_NOTIFICATION</a>:
<a name="l01323"></a>01323                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This command is used to send a custom notification about the specified %s.  Useful in emergencies when you need to notify admins of an issue regarding a monitored system or service.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01324"></a>01324                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(action,<span class="keyword">sizeof</span>(action),<span class="stringliteral">&quot;Send a custom %s notification&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01325"></a>01325                 <span class="keywordflow">break</span>;
<a name="l01326"></a>01326 
<a name="l01327"></a>01327         <span class="keywordflow">default</span>:
<a name="l01328"></a>01328                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Sorry Dave, I can&#39;t let you do that...&quot;</span>,<span class="stringliteral">&quot;Executing an unknown command? Shame on you!&quot;</span>,2);
<a name="l01329"></a>01329 
<a name="l01330"></a>01330                 <span class="keywordflow">return</span>;
<a name="l01331"></a>01331         }
<a name="l01332"></a>01332 
<a name="l01333"></a>01333         <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01334"></a>01334         action[<span class="keyword">sizeof</span>(action)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336         <span class="comment">/* Javascript to check input */</span>
<a name="l01337"></a>01337         printf(<span class="stringliteral">&quot;&lt;script language=\&quot;JavaScript\&quot;&gt;\n&quot;</span>);
<a name="l01338"></a>01338         printf(<span class="stringliteral">&quot;function check_input(){\n&quot;</span>
<a name="l01339"></a>01339                 <span class="stringliteral">&quot;       if (document.getElementById(&#39;com_data&#39;)) {\n&quot;</span>
<a name="l01340"></a>01340                 <span class="stringliteral">&quot;               if (document.getElementById(&#39;com_data&#39;).value == &#39;&#39;) {\n&quot;</span>
<a name="l01341"></a>01341                 <span class="stringliteral">&quot;                       document.getElementById(&#39;com_data_error&#39;).style.display = &#39;&#39;;\n&quot;</span>
<a name="l01342"></a>01342                 <span class="stringliteral">&quot;                       return false;\n&quot;</span>
<a name="l01343"></a>01343                 <span class="stringliteral">&quot;               } else {\n&quot;</span>
<a name="l01344"></a>01344                 <span class="stringliteral">&quot;                       document.getElementById(&#39;com_data_error&#39;).style.display = &#39;none&#39;;\n&quot;</span>
<a name="l01345"></a>01345                 <span class="stringliteral">&quot;               }\n&quot;</span>
<a name="l01346"></a>01346                 <span class="stringliteral">&quot;       }\n&quot;</span>
<a name="l01347"></a>01347                 <span class="stringliteral">&quot;       if (document.getElementById(&#39;plugin_output&#39;)) {\n&quot;</span>
<a name="l01348"></a>01348                 <span class="stringliteral">&quot;               if (document.getElementById(&#39;plugin_output&#39;).value == &#39;&#39;) {\n&quot;</span>
<a name="l01349"></a>01349                 <span class="stringliteral">&quot;                       document.getElementById(&#39;plugin_output_error&#39;).style.display = &#39;&#39;;\n&quot;</span>
<a name="l01350"></a>01350                 <span class="stringliteral">&quot;                       return false;\n&quot;</span>
<a name="l01351"></a>01351                 <span class="stringliteral">&quot;               } else {\n&quot;</span>
<a name="l01352"></a>01352                 <span class="stringliteral">&quot;                       document.getElementById(&#39;plugin_output_error&#39;).style.display = &#39;none&#39;;\n&quot;</span>
<a name="l01353"></a>01353                 <span class="stringliteral">&quot;               }\n&quot;</span>
<a name="l01354"></a>01354                 <span class="stringliteral">&quot;       }\n&quot;</span>
<a name="l01355"></a>01355                 <span class="stringliteral">&quot;       if (document.getElementById(&#39;not_dly&#39;)) {\n&quot;</span>
<a name="l01356"></a>01356                 <span class="stringliteral">&quot;               if (parseInt(document.getElementById(&#39;not_dly&#39;).value) == 0 ) {\n&quot;</span>
<a name="l01357"></a>01357                 <span class="stringliteral">&quot;                       document.getElementById(&#39;not_dly_error&#39;).style.display = &#39;&#39;;\n&quot;</span>
<a name="l01358"></a>01358                 <span class="stringliteral">&quot;                       return false;\n&quot;</span>
<a name="l01359"></a>01359                 <span class="stringliteral">&quot;               }\n&quot;</span>
<a name="l01360"></a>01360                 <span class="stringliteral">&quot;       }\n&quot;</span>
<a name="l01361"></a>01361                 <span class="stringliteral">&quot;       return true;\n&quot;</span>
<a name="l01362"></a>01362                 <span class="stringliteral">&quot;}\n&quot;</span>
<a name="l01363"></a>01363                 <span class="stringliteral">&quot;&lt;/script&gt;\n&quot;</span>);
<a name="l01364"></a>01364 
<a name="l01365"></a>01365         printf(<span class="stringliteral">&quot;&lt;div align=&#39;center&#39;&gt;\n&quot;</span>);
<a name="l01366"></a>01366 
<a name="l01367"></a>01367         printf(<span class="stringliteral">&quot;&lt;form method=&#39;post&#39; action=&#39;%s&#39; onSubmit=\&quot;return check_input();\&quot;&gt;\n&quot;</span>, <a class="code" href="cgiutils_8h.html#af173d3a2e696b911ba91dbe78b5bd275">CMD_CGI</a>);
<a name="l01368"></a>01368 
<a name="l01369"></a>01369         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;cmd_typ&#39; VALUE=&#39;%d&#39;&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;cmd_mod&#39; VALUE=&#39;%d&#39;&gt;\n&quot;</span>,cmd,<a class="code" href="cgiutils_8h.html#a082df0eb1517a3361f75150080d22dca">CMDMODE_COMMIT</a>);
<a name="l01370"></a>01370 
<a name="l01371"></a>01371         <span class="comment">/* creating an extra table to make it compatible to IE6 &amp; IE7 to have a nice frame around the form, damn it */</span>
<a name="l01372"></a>01372         printf(<span class="stringliteral">&quot;&lt;TABLE CELLSPACING=&#39;0&#39; CELLPADDING=&#39;0&#39;&gt;&lt;TR&gt;&lt;TD CLASS=&#39;boxFrame BoxWidth&#39;&gt;\n&quot;</span>);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374         printf(<span class="stringliteral">&quot;&lt;TABLE CELLSPACING=&#39;2&#39; CELLPADDING=&#39;0&#39; class=&#39;contentTable&#39;&gt;\n&quot;</span>);
<a name="l01375"></a>01375 
<a name="l01376"></a>01376         printf(<span class="stringliteral">&quot;&lt;tr CLASS=&#39;sectionHeader&#39;&gt;&lt;td COLSPAN=&#39;2&#39;&gt;Action&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01377"></a>01377         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=&#39;2&#39;&gt;%s &quot;</span>,action);
<a name="l01378"></a>01378         <span class="keywordflow">if</span> (strlen(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>) &gt; 2)
<a name="l01379"></a>01379                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01380"></a>01380         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01381"></a>01381 
<a name="l01382"></a>01382         <span class="keywordflow">switch</span>(cmd){
<a name="l01383"></a>01383 
<a name="l01384"></a>01384         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a>:
<a name="l01385"></a>01385         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>:
<a name="l01386"></a>01386         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a>:
<a name="l01387"></a>01387         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a>:
<a name="l01388"></a>01388 
<a name="l01389"></a>01389                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a> || cmd==<a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a>)
<a name="l01390"></a>01390                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01391"></a>01391                 <span class="keywordflow">else</span>
<a name="l01392"></a>01392                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01393"></a>01393 
<a name="l01394"></a>01394                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01395"></a>01395                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01396"></a>01396                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01397"></a>01397                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ac3b3e827c29cd7f1a02322fc093d41ba">PRINT_PERSISTENT</a>,cmd);
<a name="l01398"></a>01398 
<a name="l01399"></a>01399                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a> || cmd==<a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>){
<a name="l01400"></a>01400                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a1e6d11bdf1bfe19430ffd7816970408a">PRINT_STICKY_ACK</a>,cmd);
<a name="l01401"></a>01401                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a4dcc7d5d0bea4d9173c39aff95aee151">PRINT_SEND_NOTFICATION</a>,cmd);
<a name="l01402"></a>01402                 }
<a name="l01403"></a>01403 
<a name="l01404"></a>01404                 <span class="keywordflow">break</span>;
<a name="l01405"></a>01405 
<a name="l01406"></a>01406         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>:
<a name="l01407"></a>01407         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>:
<a name="l01408"></a>01408         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>:
<a name="l01409"></a>01409         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>:
<a name="l01410"></a>01410 
<a name="l01411"></a>01411                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>)
<a name="l01412"></a>01412                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#a46237026829582187c9f48046ac701c2">PRINT_COMMENT_LIST</a>);
<a name="l01413"></a>01413                 <span class="keywordflow">else</span>
<a name="l01414"></a>01414                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#a752e0923edd9c335c636c19e8cc3d354">PRINT_DOWNTIME_LIST</a>);
<a name="l01415"></a>01415 
<a name="l01416"></a>01416                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01417"></a>01417                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01418"></a>01418                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01419"></a>01419                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01420"></a>01420                 }
<a name="l01421"></a>01421 
<a name="l01422"></a>01422                 <span class="keywordflow">break</span>;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a>:
<a name="l01425"></a>01425         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>:
<a name="l01426"></a>01426 
<a name="l01427"></a>01427                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a>)
<a name="l01428"></a>01428                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01429"></a>01429                 <span class="keywordflow">else</span>
<a name="l01430"></a>01430                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01431"></a>01431 
<a name="l01432"></a>01432                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01433"></a>01433 
<a name="l01434"></a>01434                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01435"></a>01435                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01436"></a>01436                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01437"></a>01437                 }
<a name="l01438"></a>01438 
<a name="l01439"></a>01439                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#afb881756569d660675c95410d0ed21c4">PRINT_NOTIFICATION_DELAY</a>,cmd);
<a name="l01440"></a>01440 
<a name="l01441"></a>01441                 <span class="keywordflow">break</span>;
<a name="l01442"></a>01442 
<a name="l01443"></a>01443         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a>:
<a name="l01444"></a>01444         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>:
<a name="l01445"></a>01445         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a57d2695ba57df906ef8e4b120337a7b5">CMD_SCHEDULE_HOST_SVC_CHECKS</a>:
<a name="l01446"></a>01446 
<a name="l01447"></a>01447                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a>)
<a name="l01448"></a>01448                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01449"></a>01449                 <span class="keywordflow">else</span>
<a name="l01450"></a>01450                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01451"></a>01451 
<a name="l01452"></a>01452                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01453"></a>01453 
<a name="l01454"></a>01454                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01455"></a>01455                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01456"></a>01456                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01457"></a>01457                 }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a345b2c1603fcb60ca53f41a3b64a84db">PRINT_CHECK_TIME</a>,cmd);
<a name="l01460"></a>01460                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a706bc1d19f4844a0a1b58ad9e5862eb3">PRINT_FORCE_CHECK</a>,cmd);
<a name="l01461"></a>01461 
<a name="l01462"></a>01462                 <span class="keywordflow">break</span>;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1fadade3f5ab1948696ffe4489fbf367">CMD_ENABLE_SVC_CHECK</a>:
<a name="l01465"></a>01465         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9fe6fa31702949a1eb89a1ea5cc3c201">CMD_DISABLE_SVC_CHECK</a>:
<a name="l01466"></a>01466         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0e43a4b4d43616ff459be2deadf28a96">CMD_DEL_ALL_SVC_COMMENTS</a>:
<a name="l01467"></a>01467         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9304e561328b09b21afa89742b6b6342">CMD_ENABLE_SVC_NOTIFICATIONS</a>:
<a name="l01468"></a>01468         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a954e4e9c3acc9c73b2af2ac1fc19a768">CMD_DISABLE_SVC_NOTIFICATIONS</a>:
<a name="l01469"></a>01469         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01470"></a>01470         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a15e9d66679fcb475fc1609b8b496b850">CMD_DISABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01471"></a>01471         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>:
<a name="l01472"></a>01472         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abf243659a69ee0d3365f200294cd08e3">CMD_DISABLE_SVC_EVENT_HANDLER</a>:
<a name="l01473"></a>01473         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac28397aa6cedffbab2023b60bac0d2e6">CMD_REMOVE_SVC_ACKNOWLEDGEMENT</a>:
<a name="l01474"></a>01474         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a916163bc87138000b647eb3a7a275408">CMD_ENABLE_SVC_FLAP_DETECTION</a>:
<a name="l01475"></a>01475         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae535a5cd022cbc0aafe4766f93cb94c9">CMD_DISABLE_SVC_FLAP_DETECTION</a>:
<a name="l01476"></a>01476         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adeda57bb270ad5564f5a8c3b5e23a3c5">CMD_START_OBSESSING_OVER_SVC</a>:
<a name="l01477"></a>01477         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8d23223c53e3a79fb126217a54be75c8">CMD_STOP_OBSESSING_OVER_SVC</a>:
<a name="l01478"></a>01478 
<a name="l01479"></a>01479                 <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01480"></a>01480 
<a name="l01481"></a>01481                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01482"></a>01482                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01483"></a>01483                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01484"></a>01484                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01485"></a>01485                 }
<a name="l01486"></a>01486 
<a name="l01487"></a>01487                 <span class="keywordflow">break</span>;
<a name="l01488"></a>01488 
<a name="l01489"></a>01489         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>:
<a name="l01490"></a>01490         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a>:
<a name="l01491"></a>01491         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l01492"></a>01492         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l01493"></a>01493         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>:
<a name="l01494"></a>01494         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>:
<a name="l01495"></a>01495         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ca6928efc44b1722cacb66e985a7a2a">CMD_DEL_ALL_HOST_COMMENTS</a>:
<a name="l01496"></a>01496         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l01497"></a>01497         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7e79b92ba7dbe949352433e4237db6e9">CMD_DISABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l01498"></a>01498         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>:
<a name="l01499"></a>01499         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad1c35cdf7cdb67da028c1fe8412db2d7">CMD_DISABLE_HOST_EVENT_HANDLER</a>:
<a name="l01500"></a>01500         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a>:
<a name="l01501"></a>01501         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>:
<a name="l01502"></a>01502         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>:
<a name="l01503"></a>01503         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4a59d232d64b69088dc669ed09934001">CMD_ENABLE_HOST_FLAP_DETECTION</a>:
<a name="l01504"></a>01504         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa45928e7825a90937f7c0550efff08ad">CMD_DISABLE_HOST_FLAP_DETECTION</a>:
<a name="l01505"></a>01505         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a50253ccba246667112a01a6c7c32c5eb">CMD_ENABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l01506"></a>01506         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0ee96e57da3e75d6b0318ebebbcadc2">CMD_DISABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l01507"></a>01507         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a99ba56196e437148c85510c23191a8fa">CMD_START_OBSESSING_OVER_HOST</a>:
<a name="l01508"></a>01508         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a04ee1063e5ca5ded66101bb60f5c1bbd">CMD_STOP_OBSESSING_OVER_HOST</a>:
<a name="l01509"></a>01509 
<a name="l01510"></a>01510                 <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01511"></a>01511 
<a name="l01512"></a>01512                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01513"></a>01513                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01514"></a>01514                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01515"></a>01515                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01516"></a>01516                 }
<a name="l01517"></a>01517 
<a name="l01518"></a>01518                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>){
<a name="l01519"></a>01519                         <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>!=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01520"></a>01520                                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01521"></a>01521                 }
<a name="l01522"></a>01522 
<a name="l01523"></a>01523                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a>){
<a name="l01524"></a>01524 
<a name="l01525"></a>01525                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;This %s %s of the host too.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a> ||cmd==<a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;enables&quot;</span>:<span class="stringliteral">&quot;disables&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a>)?<span class="stringliteral">&quot;checks&quot;</span>:<span class="stringliteral">&quot;notifications&quot;</span>);
<a name="l01526"></a>01526                         <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01527"></a>01527 
<a name="l01528"></a>01528                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;%s For Host Too:&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01529"></a>01529                         <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01530"></a>01530                         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;ahas&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01531"></a>01531                 }
<a name="l01532"></a>01532 
<a name="l01533"></a>01533                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>){
<a name="l01534"></a>01534 
<a name="l01535"></a>01535                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;%s notifications te be sent out to child hosts.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01536"></a>01536                         <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01537"></a>01537 
<a name="l01538"></a>01538                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;%s Notifications For Child Hosts Too:&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01539"></a>01539                         <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01540"></a>01540                         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;ptc&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01541"></a>01541                 }
<a name="l01542"></a>01542                 <span class="keywordflow">break</span>;
<a name="l01543"></a>01543 
<a name="l01544"></a>01544         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>:
<a name="l01545"></a>01545         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab45ce82cbb8bd87132044462b2c2cf2d">CMD_DISABLE_NOTIFICATIONS</a>:
<a name="l01546"></a>01546         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4615951f5161b6b778a6cb3938ca438e">CMD_SHUTDOWN_PROCESS</a>:
<a name="l01547"></a>01547         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae706ffbffb7f812e813c492f9805908f">CMD_RESTART_PROCESS</a>:
<a name="l01548"></a>01548         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>:
<a name="l01549"></a>01549         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9d3a2978d952e95c2b28cc2aebdc7722">CMD_STOP_EXECUTING_SVC_CHECKS</a>:
<a name="l01550"></a>01550         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l01551"></a>01551         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3a42e556cb0f6719ed8930d7bc68ff8f">CMD_STOP_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l01552"></a>01552         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>:
<a name="l01553"></a>01553         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9400fb3097302ed20125524ccd964129">CMD_DISABLE_EVENT_HANDLERS</a>:
<a name="l01554"></a>01554         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aef5d645e19291f05fd060c2cf53f0897">CMD_START_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l01555"></a>01555         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a94f3dde3552de89cc330e811c02ddf7b">CMD_STOP_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l01556"></a>01556         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a410b3872c3b9541b96d415190f6cfd74">CMD_ENABLE_FLAP_DETECTION</a>:
<a name="l01557"></a>01557         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1ff1981c4f64505b315755af554c65a8">CMD_DISABLE_FLAP_DETECTION</a>:
<a name="l01558"></a>01558         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3dd1f74a3ce6023b0de5090764317f44">CMD_ENABLE_FAILURE_PREDICTION</a>:
<a name="l01559"></a>01559         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adec8f3e8e4479e2ffaef21d12260142f">CMD_DISABLE_FAILURE_PREDICTION</a>:
<a name="l01560"></a>01560         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a78b643a9413d31cef72ab0d0122e2af7">CMD_ENABLE_PERFORMANCE_DATA</a>:
<a name="l01561"></a>01561         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9d3c2b1b310393e27501b034eaf9b81">CMD_DISABLE_PERFORMANCE_DATA</a>:
<a name="l01562"></a>01562         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1f12ceeaa459f528c3c96b024ec779e8">CMD_START_EXECUTING_HOST_CHECKS</a>:
<a name="l01563"></a>01563         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a29ba7e82e9fe9279ca412208548d94a8">CMD_STOP_EXECUTING_HOST_CHECKS</a>:
<a name="l01564"></a>01564         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0231991dd77addd3dd0a67b75fe91b99">CMD_START_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l01565"></a>01565         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a059b4514eb08898aa69f4c880833c40c">CMD_STOP_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l01566"></a>01566         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a81eb9c67248de83dd019697521b31bd6">CMD_START_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l01567"></a>01567         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a420810b071f18ba5a40e9e9e77634762">CMD_STOP_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l01568"></a>01568 
<a name="l01569"></a>01569                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01570"></a>01570                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01571"></a>01571                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01572"></a>01572                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01573"></a>01573                 } <span class="keywordflow">else</span>  {
<a name="l01574"></a>01574                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01575"></a>01575                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td CLASS=&#39;objectDescription&#39; colspan=2&gt;There are no options for this command.&lt;br&gt;Click the &#39;Commit&#39; button to submit the command.&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01576"></a>01576                 }
<a name="l01577"></a>01577 
<a name="l01578"></a>01578                 <span class="keywordflow">break</span>;
<a name="l01579"></a>01579 
<a name="l01580"></a>01580         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>:
<a name="l01581"></a>01581         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>:
<a name="l01582"></a>01582 
<a name="l01583"></a>01583                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>)
<a name="l01584"></a>01584                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01585"></a>01585                 <span class="keywordflow">else</span>
<a name="l01586"></a>01586                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01587"></a>01587 
<a name="l01588"></a>01588                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01589"></a>01589 
<a name="l01590"></a>01590                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01591"></a>01591                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01592"></a>01592                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01593"></a>01593                 }
<a name="l01594"></a>01594 
<a name="l01595"></a>01595                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Set the state which should be send to %s for this %s.&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;hosts&quot;</span>:<span class="stringliteral">&quot;services&quot;</span>);
<a name="l01596"></a>01596                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01597"></a>01597 
<a name="l01598"></a>01598                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Check Result:&quot;</span>);
<a name="l01599"></a>01599                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01600"></a>01600                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l01601"></a>01601                 printf(<span class="stringliteral">&quot;\t&lt;SELECT NAME=&#39;plugin_state&#39;&gt;\n&quot;</span>);
<a name="l01602"></a>01602                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>){
<a name="l01603"></a>01603                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=%d SELECTED&gt;OK&lt;/OPTION&gt;\n&quot;</span>,<a class="code" href="cgiutils_8h.html#a35937514c20ebac19d6598f04416db7e">STATE_OK</a>);
<a name="l01604"></a>01604                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=%d&gt;WARNING&lt;/OPTION&gt;\n&quot;</span>,<a class="code" href="cgiutils_8h.html#a4b06ae38f5452bbb219bb49f0081c3f0">STATE_WARNING</a>);
<a name="l01605"></a>01605                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=%d&gt;UNKNOWN&lt;/OPTION&gt;\n&quot;</span>,<a class="code" href="cgiutils_8h.html#a3a671c5b5d9122f1158555575bc0feb1">STATE_UNKNOWN</a>);
<a name="l01606"></a>01606                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=%d&gt;CRITICAL&lt;/OPTION&gt;\n&quot;</span>,<a class="code" href="cgiutils_8h.html#a19827c887254e66b983c3269a42562bc">STATE_CRITICAL</a>);
<a name="l01607"></a>01607                 }<span class="keywordflow">else</span>{
<a name="l01608"></a>01608                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=0 SELECTED&gt;UP&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01609"></a>01609                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=1&gt;DOWN&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01610"></a>01610                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=2&gt;UNREACHABLE&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01611"></a>01611                 }
<a name="l01612"></a>01612                 printf(<span class="stringliteral">&quot;\t&lt;/SELECT&gt;\n&quot;</span>);
<a name="l01613"></a>01613                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01614"></a>01614 
<a name="l01615"></a>01615                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a4b32eb4866f6a24727422571a8d69350">PRINT_CHECK_OUTPUT_BOX</a>,cmd);
<a name="l01616"></a>01616                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a84e39a146adab49fb3a9b8cb4194853b">PRINT_PERFORMANCE_DATA_BOX</a>,cmd);
<a name="l01617"></a>01617 
<a name="l01618"></a>01618                 <span class="keywordflow">break</span>;
<a name="l01619"></a>01619 
<a name="l01620"></a>01620         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>:
<a name="l01621"></a>01621         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a>:
<a name="l01622"></a>01622         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>:
<a name="l01623"></a>01623 
<a name="l01624"></a>01624                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>)
<a name="l01625"></a>01625                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01626"></a>01626                 <span class="keywordflow">else</span>
<a name="l01627"></a>01627                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01630"></a>01630                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01631"></a>01631                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01632"></a>01632 
<a name="l01633"></a>01633                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Define here if this downtime should get triggerd by another downtime of a particular %s.&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>)?<span class="stringliteral">&quot;host&quot;</span>:<span class="stringliteral">&quot;service&quot;</span>);
<a name="l01634"></a>01634                 <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01635"></a>01635 
<a name="l01636"></a>01636                 printf(<span class="stringliteral">&quot;&lt;tr id=\&quot;trigger_select\&quot;&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Triggered By:&quot;</span>);
<a name="l01637"></a>01637                 <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01638"></a>01638                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l01639"></a>01639                 printf(<span class="stringliteral">&quot;\t&lt;SELECT name=&#39;trigger&#39;&gt;\n&quot;</span>);
<a name="l01640"></a>01640                 printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;0&#39;&gt;N/A&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01641"></a>01641 
<a name="l01642"></a>01642                 <span class="keywordflow">for</span>(temp_downtime=scheduled_downtime_list;temp_downtime!=NULL;temp_downtime=temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ae5d4b42e863be95f996d66868c110b72">next</a>){
<a name="l01643"></a>01643                         <span class="keywordflow">if</span>(temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a3cdf7dd7488ab496ed38027a2c816d42">type</a>!=<a class="code" href="include_2common_8h.html#a77195a4fb52f9a56a0cda733723f6356">HOST_DOWNTIME</a>)
<a name="l01644"></a>01644                                 <span class="keywordflow">continue</span>;
<a name="l01645"></a>01645 
<a name="l01646"></a>01646                         <span class="comment">/* find the host... */</span>
<a name="l01647"></a>01647                          temp_host=<a class="code" href="objects_8c.html#a00522e51ee51756c73a5395e6d1498d3">find_host</a>(temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a75ec5aa68f0ba2710b58e0c311973a01">host_name</a>);
<a name="l01648"></a>01648 
<a name="l01649"></a>01649                          <span class="comment">/* make sure user has rights to view this host */</span>
<a name="l01650"></a>01650                         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a7fb183794972b86441a8c58689f2b67c">is_authorized_for_host</a>(temp_host,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l01651"></a>01651                                 <span class="keywordflow">continue</span>;
<a name="l01652"></a>01652 
<a name="l01653"></a>01653                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;%lu&#39;&gt;&quot;</span>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ace400e14a79c8afe5bc7bcc23411b760">downtime_id</a>);
<a name="l01654"></a>01654                         <a class="code" href="cgiutils_8c.html#ac2ab6d1c01c10c6d18247c25637018de">get_time_string</a>(&amp;temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a32045816273bd00e37dc146bbb1f339d">start_time</a>,start_time,<span class="keyword">sizeof</span>(start_time),<a class="code" href="include_2common_8h.html#a0e340fb0d5261012218a269341dc60ab">SHORT_DATE_TIME</a>);
<a name="l01655"></a>01655                         printf(<span class="stringliteral">&quot;ID: %lu, Host &#39;%s&#39; starting @ %s&lt;/OPTION&gt;\n&quot;</span>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ace400e14a79c8afe5bc7bcc23411b760">downtime_id</a>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a75ec5aa68f0ba2710b58e0c311973a01">host_name</a>,start_time);
<a name="l01656"></a>01656                         found_trigger_objects=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01657"></a>01657                 }
<a name="l01658"></a>01658                 <span class="keywordflow">for</span>(temp_downtime=scheduled_downtime_list;temp_downtime!=NULL;temp_downtime=temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ae5d4b42e863be95f996d66868c110b72">next</a>){
<a name="l01659"></a>01659                         <span class="keywordflow">if</span>(temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a3cdf7dd7488ab496ed38027a2c816d42">type</a>!=<a class="code" href="include_2common_8h.html#a5e655b3a19f529bafe697bdeeaf0e145">SERVICE_DOWNTIME</a>)
<a name="l01660"></a>01660                                 <span class="keywordflow">continue</span>;
<a name="l01661"></a>01661 
<a name="l01662"></a>01662                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;%lu&#39;&gt;&quot;</span>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ace400e14a79c8afe5bc7bcc23411b760">downtime_id</a>);
<a name="l01663"></a>01663                         <a class="code" href="cgiutils_8c.html#ac2ab6d1c01c10c6d18247c25637018de">get_time_string</a>(&amp;temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a32045816273bd00e37dc146bbb1f339d">start_time</a>,start_time,<span class="keyword">sizeof</span>(start_time),<a class="code" href="include_2common_8h.html#a0e340fb0d5261012218a269341dc60ab">SHORT_DATE_TIME</a>);
<a name="l01664"></a>01664                         printf(<span class="stringliteral">&quot;ID: %lu, Service &#39;%s&#39; on host &#39;%s&#39; starting @ %s&lt;/OPTION&gt;\n&quot;</span>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#ace400e14a79c8afe5bc7bcc23411b760">downtime_id</a>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a6832da598408fbf942d33363a16b16ae">service_description</a>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a75ec5aa68f0ba2710b58e0c311973a01">host_name</a>,start_time);
<a name="l01665"></a>01665                         found_trigger_objects=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01666"></a>01666                 }
<a name="l01667"></a>01667 
<a name="l01668"></a>01668                 printf(<span class="stringliteral">&quot;\t&lt;/SELECT&gt;\n&quot;</span>);
<a name="l01669"></a>01669                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01670"></a>01670 
<a name="l01671"></a>01671                 <span class="comment">/* hide &quot;Triggerd by&quot; selction if nothing is found to get triggerd from */</span>
<a name="l01672"></a>01672                 <span class="keywordflow">if</span>(!found_trigger_objects)
<a name="l01673"></a>01673                         printf(<span class="stringliteral">&quot;&lt;tr style=\&quot;display:none;\&quot;&gt;&lt;td colspan=2&gt;&lt;script language=\&quot;JavaScript\&quot;&gt;document.getElementById(&#39;trigger_select&#39;).style.display = &#39;none&#39;;&lt;/script&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01674"></a>01674 
<a name="l01675"></a>01675                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a931ecb1e2b0a4b0171d7cf03a2a801a9">PRINT_START_TIME</a>,cmd);
<a name="l01676"></a>01676                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a>,cmd);
<a name="l01677"></a>01677                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a43f6b9650f6014f525c4db5a497494b0">PRINT_FIXED_FLEXIBLE_TYPE</a>,cmd);
<a name="l01678"></a>01678 
<a name="l01679"></a>01679                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>){
<a name="l01680"></a>01680                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>,<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>),<span class="stringliteral">&quot;Define here what should be done with the child hosts of these hosts.&quot;</span>);
<a name="l01681"></a>01681                         <a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>[<span class="keyword">sizeof</span>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l01682"></a>01682 
<a name="l01683"></a>01683                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Child Hosts:&quot;</span>);
<a name="l01684"></a>01684                         <a class="code" href="cmd_8c.html#a142aa6208b0bb5598d7bc77cc9bf0365" title="print the mouseover box with help text">print_help_box</a>(<a class="code" href="cmd_8c.html#a4826c74dbacaf4977f3c389322490349">help_text</a>);
<a name="l01685"></a>01685                         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l01686"></a>01686                         printf(<span class="stringliteral">&quot;\t&lt;SELECT name=&#39;childoptions&#39;&gt;\n&quot;</span>);
<a name="l01687"></a>01687                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;0&#39;&gt;Do nothing with child hosts&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01688"></a>01688                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;1&#39;&gt;Schedule triggered downtime for all child hosts&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01689"></a>01689                         printf(<span class="stringliteral">&quot;\t\t&lt;OPTION VALUE=&#39;2&#39;&gt;Schedule non-triggered downtime for all child hosts&lt;/OPTION&gt;\n&quot;</span>);
<a name="l01690"></a>01690                         printf(<span class="stringliteral">&quot;\t&lt;/SELECT&gt;\n&quot;</span>);
<a name="l01691"></a>01691                         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01692"></a>01692                 }
<a name="l01693"></a>01693 
<a name="l01694"></a>01694                 <span class="keywordflow">break</span>;
<a name="l01695"></a>01695 
<a name="l01696"></a>01696         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01697"></a>01697         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01698"></a>01698         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01699"></a>01699         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01700"></a>01700         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l01701"></a>01701         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l01702"></a>01702 
<a name="l01703"></a>01703                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01704"></a>01704                 printf(<span class="stringliteral">&quot;&lt;tr class=\&quot;statusEven\&quot; &gt;&lt;td width=\&quot;50%%\&quot; style=\&quot;font-weight:bold;\&quot;&gt;Hostgroup Name:&lt;/td&gt;&quot;</span>);
<a name="l01705"></a>01705                 printf(<span class="stringliteral">&quot;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;hostgroup&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>));
<a name="l01706"></a>01706 
<a name="l01707"></a>01707                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01708"></a>01708                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01709"></a>01709                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01710"></a>01710                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01711"></a>01711                 }
<a name="l01712"></a>01712 
<a name="l01713"></a>01713                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>){
<a name="l01714"></a>01714 
<a name="l01715"></a>01715                         <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>!=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01716"></a>01716                                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01717"></a>01717 
<a name="l01718"></a>01718                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;%s For Hosts Too:&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01719"></a>01719                         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;ahas&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01720"></a>01720                 }
<a name="l01721"></a>01721                 <span class="keywordflow">break</span>;
<a name="l01722"></a>01722 
<a name="l01723"></a>01723         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01724"></a>01724         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0b364d353364414254b771c84e9256d3">CMD_DISABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l01725"></a>01725         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01726"></a>01726         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6c96b4300cbb5a6dc2b2c8a63ebb55ea">CMD_DISABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l01727"></a>01727         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l01728"></a>01728         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad429a7756a139718439e4d8ee671a778">CMD_DISABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l01729"></a>01729 
<a name="l01730"></a>01730                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01731"></a>01731                 printf(<span class="stringliteral">&quot;&lt;tr class=\&quot;statusEven\&quot;&gt;&lt;td width=\&quot;50%%\&quot; style=\&quot;font-weight:bold;\&quot;&gt;Servicegroup Name:&lt;/td&gt;&quot;</span>);
<a name="l01732"></a>01732                 printf(<span class="stringliteral">&quot;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;servicegroup&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>));
<a name="l01733"></a>01733 
<a name="l01734"></a>01734                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01735"></a>01735                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01736"></a>01736                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01737"></a>01737                         <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01738"></a>01738                 }
<a name="l01739"></a>01739 
<a name="l01740"></a>01740                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#ad429a7756a139718439e4d8ee671a778">CMD_DISABLE_SERVICEGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#a0b364d353364414254b771c84e9256d3">CMD_DISABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>){
<a name="l01741"></a>01741 
<a name="l01742"></a>01742                         <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>!=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01743"></a>01743                                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01744"></a>01744 
<a name="l01745"></a>01745                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;%s For Hosts Too:&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>,(cmd==<a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a> || cmd==<a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>)?<span class="stringliteral">&quot;Enable&quot;</span>:<span class="stringliteral">&quot;Disable&quot;</span>);
<a name="l01746"></a>01746                         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;ahas&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01747"></a>01747                 }
<a name="l01748"></a>01748                 <span class="keywordflow">break</span>;
<a name="l01749"></a>01749 
<a name="l01750"></a>01750         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>:
<a name="l01751"></a>01751         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>:
<a name="l01752"></a>01752         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a>:
<a name="l01753"></a>01753         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a>:
<a name="l01754"></a>01754 
<a name="l01755"></a>01755                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01756"></a>01756                 printf(<span class="stringliteral">&quot;&lt;tr class=\&quot;statusEven\&quot;&gt;&lt;td width=\&quot;50%%\&quot; style=\&quot;font-weight:bold;\&quot;&gt;&quot;</span>);
<a name="l01757"></a>01757                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>)
<a name="l01758"></a>01758                         printf(<span class="stringliteral">&quot;Hostgroup Name:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;hostgroup&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>));
<a name="l01759"></a>01759                 <span class="keywordflow">else</span>
<a name="l01760"></a>01760                         printf(<span class="stringliteral">&quot;Servicegroup Name:&lt;/td&gt;&lt;td&gt;&lt;INPUT TYPE=&#39;HIDDEN&#39; NAME=&#39;servicegroup&#39; VALUE=&#39;%s&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>),<a class="code" href="cgiutils_8c.html#ac1d29fc60873ee007c1153dc90ea24f9">escape_string</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>));
<a name="l01761"></a>01761 
<a name="l01762"></a>01762                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01763"></a>01763                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01764"></a>01764                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01765"></a>01765                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a931ecb1e2b0a4b0171d7cf03a2a801a9">PRINT_START_TIME</a>,cmd);
<a name="l01766"></a>01766                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ae50fe9d3b683fe77eb39925ba29811b2">PRINT_END_TIME</a>,cmd);
<a name="l01767"></a>01767                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a43f6b9650f6014f525c4db5a497494b0">PRINT_FIXED_FLEXIBLE_TYPE</a>,cmd);
<a name="l01768"></a>01768 
<a name="l01769"></a>01769                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a>){
<a name="l01770"></a>01770                         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=\&quot;objectDescription descriptionleft\&quot;&gt;Schedule Downtime For Hosts Too:&lt;/td&gt;&lt;td align=\&quot;left\&quot;&gt;\n&quot;</span>);
<a name="l01771"></a>01771                         printf(<span class="stringliteral">&quot;&lt;INPUT TYPE=&#39;checkbox&#39; NAME=&#39;ahas&#39;&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01772"></a>01772                 }
<a name="l01773"></a>01773                 <span class="keywordflow">break</span>;
<a name="l01774"></a>01774 
<a name="l01775"></a>01775         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>:
<a name="l01776"></a>01776         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0846859b12e531544dce8a09778f167">CMD_SEND_CUSTOM_SVC_NOTIFICATION</a>:
<a name="l01777"></a>01777 
<a name="l01778"></a>01778                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ad0846859b12e531544dce8a09778f167">CMD_SEND_CUSTOM_SVC_NOTIFICATION</a>)
<a name="l01779"></a>01779                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ad685ce54f02f0da43b70e8ebb42d490b">PRINT_SERVICE_LIST</a>);
<a name="l01780"></a>01780                 <span class="keywordflow">else</span>
<a name="l01781"></a>01781                         <a class="code" href="cmd_8c.html#ab63cec2ce556bae77a5b223598d92255" title="print the list of affected objects">print_object_list</a>(<a class="code" href="cmd_8c.html#ae8242ae5b2a2eda1d83ac1367ad2d329">PRINT_HOST_LIST</a>);
<a name="l01782"></a>01782 
<a name="l01783"></a>01783                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad2e5e435c3703dbd619547e76b9f7b95">PRINT_COMMON_HEADER</a>,cmd);
<a name="l01784"></a>01784                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#ad383e03b6e8bd53496a5f2e7bbe3a72b">PRINT_AUTHOR</a>,cmd);
<a name="l01785"></a>01785                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a7288d1107aa1ce360091671681301302">PRINT_COMMENT_BOX</a>,cmd);
<a name="l01786"></a>01786                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a939639369cabf53029528fe52a35188d">PRINT_FORCE_NOTIFICATION</a>,cmd);
<a name="l01787"></a>01787                 <a class="code" href="cmd_8c.html#a7d221cf5fb68591abe4cdf20de9fd85b" title="strips out semicolons and newlines from comment data">print_form_element</a>(<a class="code" href="cmd_8c.html#a9f70a74726f225c57336802a087350c3">PRINT_BROADCAST_NOTIFICATION</a>,cmd);
<a name="l01788"></a>01788 
<a name="l01789"></a>01789                 <span class="keywordflow">break</span>;
<a name="l01790"></a>01790 
<a name="l01791"></a>01791         <span class="keywordflow">default</span>:
<a name="l01792"></a>01792                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td CLASS=&#39;objectDescription&#39; COLSPAN=\&quot;2\&quot;&gt;This should not be happening... :-(&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01793"></a>01793         }
<a name="l01794"></a>01794 
<a name="l01795"></a>01795 
<a name="l01796"></a>01796         printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td COLSPAN=\&quot;2\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01797"></a>01797         printf(<span class="stringliteral">&quot;&lt;tr CLASS=&#39;sectionHeader&#39;&gt;&lt;td COLSPAN=\&quot;2\&quot; class=\&quot;commitButton\&quot;&gt;&lt;INPUT TYPE=\&quot;submit\&quot; NAME=\&quot;btnSubmit\&quot; VALUE=\&quot;Commit\&quot; class=\&quot;submitButton\&quot;&gt;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&lt;a HREF=\&quot;javascript:window.history.go(-1)\&quot;&gt;Cancel&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l01798"></a>01798 
<a name="l01799"></a>01799         printf(<span class="stringliteral">&quot;&lt;/table&gt;\n&quot;</span>);
<a name="l01800"></a>01800         printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&quot;</span>); <span class="comment">/* Outer frame */</span>
<a name="l01801"></a>01801         printf(<span class="stringliteral">&quot;&lt;/form&gt;\n&quot;</span>);
<a name="l01802"></a>01802 
<a name="l01803"></a>01803         printf(<span class="stringliteral">&quot;&lt;/div&gt;\n&quot;</span>);
<a name="l01804"></a>01804 
<a name="l01805"></a>01805         <span class="keywordflow">return</span>;
<a name="l01806"></a>01806 }
<a name="l01807"></a>01807 
<a name="l01808"></a><a class="code" href="cmd_8c.html#a8859f113fed8a091483259d3071c623f">01808</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a8859f113fed8a091483259d3071c623f" title="submits the command data and checks for sanity">commit_command_data</a>(<span class="keywordtype">int</span> cmd){
<a name="l01809"></a>01809         <span class="keywordtype">char</span> error_string[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>];
<a name="l01810"></a>01810         <a class="code" href="structservice__struct.html">service</a> *temp_service;
<a name="l01811"></a>01811         <a class="code" href="structhost__struct.html">host</a> *temp_host;
<a name="l01812"></a>01812         <a class="code" href="structhostgroup__struct.html">hostgroup</a> *temp_hostgroup;
<a name="l01813"></a>01813         <a class="code" href="structcomment__struct.html">comment</a> *temp_comment;
<a name="l01814"></a>01814         <a class="code" href="structscheduled__downtime__struct.html">scheduled_downtime</a> *temp_downtime;
<a name="l01815"></a>01815         <a class="code" href="structservicegroup__struct.html">servicegroup</a> *temp_servicegroup=NULL;
<a name="l01816"></a>01816         <a class="code" href="structcontact__struct.html">contact</a> *temp_contact=NULL;
<a name="l01817"></a>01817         <span class="keywordtype">int</span> x=0;
<a name="l01818"></a>01818         <span class="keywordtype">int</span> e=0;
<a name="l01819"></a>01819         <span class="keywordtype">short</span> error_found=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01820"></a>01820         <span class="keywordtype">short</span> cmd_has_objects = <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01821"></a>01821         <span class="keywordtype">short</span> row_color = 0;
<a name="l01822"></a>01822 
<a name="l01823"></a>01823         <span class="comment">/* get authentication information */</span>
<a name="l01824"></a>01824         <a class="code" href="cgiauth_8c.html#a6fd1465f39a46eecf4013821ea859270">get_authentication_information</a>(&amp;current_authdata);
<a name="l01825"></a>01825 
<a name="l01826"></a>01826         <span class="comment">/* allways set the first element to FALSE*/</span>
<a name="l01827"></a>01827         <span class="comment">/* If there is a single COMMAND witch is not coverd correctly throught the following cases it won&#39;t get executed */</span>
<a name="l01828"></a>01828         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01829"></a>01829 
<a name="l01830"></a>01830         <span class="comment">/* get name to use for author */</span>
<a name="l01831"></a>01831         <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#a96cfe0add1d7f974dcc7bd87a929cb84">lock_author_names</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l01832"></a>01832                 temp_contact=<a class="code" href="objects_8c.html#a5293c9bf6790cf9f1c795ea2116dc96c">find_contact</a>(current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>);
<a name="l01833"></a>01833                 <span class="keywordflow">if</span>(temp_contact!=NULL &amp;&amp; temp_contact-&gt;<a class="code" href="structcontact__struct.html#abfdf4076ba4139741160db3d0f4f990a">alias</a>!=NULL)
<a name="l01834"></a>01834                         <a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=temp_contact-&gt;<a class="code" href="structcontact__struct.html#abfdf4076ba4139741160db3d0f4f990a">alias</a>;
<a name="l01835"></a>01835                 <span class="keywordflow">else</span>
<a name="l01836"></a>01836                         <a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>=current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>;
<a name="l01837"></a>01837         }
<a name="l01838"></a>01838 
<a name="l01839"></a>01839         <span class="keywordflow">switch</span>(cmd){
<a name="l01840"></a>01840 
<a name="l01841"></a>01841 
<a name="l01842"></a>01842         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a>:
<a name="l01843"></a>01843         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a>:
<a name="l01844"></a>01844         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a>:
<a name="l01845"></a>01845         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>:
<a name="l01846"></a>01846         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>:
<a name="l01847"></a>01847         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0846859b12e531544dce8a09778f167">CMD_SEND_CUSTOM_SVC_NOTIFICATION</a>:
<a name="l01848"></a>01848 
<a name="l01849"></a>01849                 <span class="comment">/* make sure we have author name, and comment data... */</span>
<a name="l01850"></a>01850                 <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l01851"></a>01851 
<a name="l01852"></a>01852                 <span class="comment">/* clean up the comment data */</span>
<a name="l01853"></a>01853                 <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l01854"></a>01854                 <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l01855"></a>01855 
<a name="l01856"></a>01856                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l01857"></a>01857 
<a name="l01858"></a>01858                         cmd_has_objects = <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01859"></a>01859 
<a name="l01860"></a>01860                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l01861"></a>01861                                 <span class="keywordflow">continue</span>;
<a name="l01862"></a>01862 
<a name="l01863"></a>01863                         <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l01864"></a>01864                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01865"></a>01865                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a> || cmd==<a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>) {
<a name="l01866"></a>01866                                 temp_host=<a class="code" href="objects_8c.html#a00522e51ee51756c73a5395e6d1498d3">find_host</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l01867"></a>01867                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a6261bb0d6a380f3a9004c419215a4a4d">is_authorized_for_host_commands</a>(temp_host,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01868"></a>01868                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01869"></a>01869                         } <span class="keywordflow">else</span> {
<a name="l01870"></a>01870                                 temp_service=<a class="code" href="objects_8c.html#ab1d2d0b3d54898c574aa58b9fe332aa6">find_service</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description);
<a name="l01871"></a>01871                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#ae571f329c94c06d4802ff202d048d266">is_authorized_for_service_commands</a>(temp_service,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01872"></a>01872                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01873"></a>01873                         }
<a name="l01874"></a>01874                 }
<a name="l01875"></a>01875                 <span class="keywordflow">break</span>;
<a name="l01876"></a>01876 
<a name="l01877"></a>01877         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>:
<a name="l01878"></a>01878         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>:
<a name="l01879"></a>01879 
<a name="l01880"></a>01880                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01881"></a>01881                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l01882"></a>01882                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l01883"></a>01883                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l01884"></a>01884                 }
<a name="l01885"></a>01885 
<a name="l01886"></a>01886                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l01887"></a>01887 
<a name="l01888"></a>01888                         cmd_has_objects = <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01889"></a>01889 
<a name="l01890"></a>01890                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l01891"></a>01891                                 <span class="keywordflow">continue</span>;
<a name="l01892"></a>01892 
<a name="l01893"></a>01893                         <span class="comment">/* check the sanity of the comment id */</span>
<a name="l01894"></a>01894                         <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]==0) {
<a name="l01895"></a>01895                                 error[e++].message=strdup(<span class="stringliteral">&quot;Comment id cannot be 0&quot;</span>);
<a name="l01896"></a>01896                                 <span class="keywordflow">continue</span>;
<a name="l01897"></a>01897                         }
<a name="l01898"></a>01898 
<a name="l01899"></a>01899                         <span class="comment">/* find the comment */</span>
<a name="l01900"></a>01900                         <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>)
<a name="l01901"></a>01901                                 temp_comment=<a class="code" href="comments_8c.html#a4e9e16cc471f3d6525ecc123aac62ce7">find_host_comment</a>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l01902"></a>01902                         <span class="keywordflow">else</span>
<a name="l01903"></a>01903                                 temp_comment=<a class="code" href="comments_8c.html#aa6e8d30bde07dfeb9a24037f5940993f">find_service_comment</a>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l01904"></a>01904 
<a name="l01905"></a>01905                         <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l01906"></a>01906                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01907"></a>01907                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a> &amp;&amp; temp_comment!=NULL) {
<a name="l01908"></a>01908                                 temp_host=<a class="code" href="objects_8c.html#a00522e51ee51756c73a5395e6d1498d3">find_host</a>(temp_comment-&gt;<a class="code" href="structcomment__struct.html#aa5326b27e493006a37b5c0be7651bf05">host_name</a>);
<a name="l01909"></a>01909                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a6261bb0d6a380f3a9004c419215a4a4d">is_authorized_for_host_commands</a>(temp_host,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01910"></a>01910                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01911"></a>01911                         }
<a name="l01912"></a>01912                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a> &amp;&amp; temp_comment!=NULL) {
<a name="l01913"></a>01913                                 temp_service=<a class="code" href="objects_8c.html#ab1d2d0b3d54898c574aa58b9fe332aa6">find_service</a>(temp_comment-&gt;<a class="code" href="structcomment__struct.html#aa5326b27e493006a37b5c0be7651bf05">host_name</a>,temp_comment-&gt;<a class="code" href="structcomment__struct.html#a4562f22f78c485d19f2d422d280d4198">service_description</a>);
<a name="l01914"></a>01914                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#ae571f329c94c06d4802ff202d048d266">is_authorized_for_service_commands</a>(temp_service,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01915"></a>01915                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01916"></a>01916                         }
<a name="l01917"></a>01917                 }
<a name="l01918"></a>01918 
<a name="l01919"></a>01919                 <span class="comment">/* free comment data */</span>
<a name="l01920"></a>01920                 <a class="code" href="comments_8c.html#a37577a9b0b1fdb420bd5a2a84f0995f7">free_comment_data</a>();
<a name="l01921"></a>01921 
<a name="l01922"></a>01922                 <span class="keywordflow">break</span>;
<a name="l01923"></a>01923 
<a name="l01924"></a>01924         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>:
<a name="l01925"></a>01925         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>:
<a name="l01926"></a>01926 
<a name="l01927"></a>01927                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01928"></a>01928                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l01929"></a>01929                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l01930"></a>01930                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l01931"></a>01931                 }
<a name="l01932"></a>01932 
<a name="l01933"></a>01933                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l01934"></a>01934 
<a name="l01935"></a>01935                         cmd_has_objects = <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01936"></a>01936 
<a name="l01937"></a>01937                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l01938"></a>01938                                 <span class="keywordflow">continue</span>;
<a name="l01939"></a>01939 
<a name="l01940"></a>01940                         <span class="comment">/* check the sanity of the downtime id */</span>
<a name="l01941"></a>01941                         <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]==0){
<a name="l01942"></a>01942                                 error[e++].message=strdup(<span class="stringliteral">&quot;Downtime id cannot be 0&quot;</span>);
<a name="l01943"></a>01943                                 <span class="keywordflow">continue</span>;
<a name="l01944"></a>01944                         }
<a name="l01945"></a>01945 
<a name="l01946"></a>01946                         <span class="comment">/* find the downtime entry */</span>
<a name="l01947"></a>01947                         <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>)
<a name="l01948"></a>01948                                 temp_downtime=<a class="code" href="downtime_8c.html#a152f939b69fbd323d2728f58dd158a7e">find_host_downtime</a>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l01949"></a>01949                         <span class="keywordflow">else</span>
<a name="l01950"></a>01950                                 temp_downtime=<a class="code" href="downtime_8c.html#a74052405a382ae4d1cd4f8b8596a53a4">find_service_downtime</a>(<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l01951"></a>01951 
<a name="l01952"></a>01952                         <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l01953"></a>01953                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01954"></a>01954                         <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a> &amp;&amp; temp_downtime!=NULL){
<a name="l01955"></a>01955                                 temp_host=<a class="code" href="objects_8c.html#a00522e51ee51756c73a5395e6d1498d3">find_host</a>(temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a75ec5aa68f0ba2710b58e0c311973a01">host_name</a>);
<a name="l01956"></a>01956                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a6261bb0d6a380f3a9004c419215a4a4d">is_authorized_for_host_commands</a>(temp_host,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01957"></a>01957                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01958"></a>01958                         }
<a name="l01959"></a>01959                         <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a> &amp;&amp; temp_downtime!=NULL){
<a name="l01960"></a>01960                                 temp_service=<a class="code" href="objects_8c.html#ab1d2d0b3d54898c574aa58b9fe332aa6">find_service</a>(temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a75ec5aa68f0ba2710b58e0c311973a01">host_name</a>,temp_downtime-&gt;<a class="code" href="structscheduled__downtime__struct.html#a6832da598408fbf942d33363a16b16ae">service_description</a>);
<a name="l01961"></a>01961                                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#ae571f329c94c06d4802ff202d048d266">is_authorized_for_service_commands</a>(temp_service,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01962"></a>01962                                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01963"></a>01963                         }
<a name="l01964"></a>01964                 }
<a name="l01965"></a>01965 
<a name="l01966"></a>01966                 <span class="comment">/* free downtime data */</span>
<a name="l01967"></a>01967                 <a class="code" href="downtime_8c.html#a5fe1f91c90029cb9809f152a5668ca42">free_downtime_data</a>();
<a name="l01968"></a>01968 
<a name="l01969"></a>01969                 <span class="keywordflow">break</span>;
<a name="l01970"></a>01970 
<a name="l01971"></a>01971         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a>:
<a name="l01972"></a>01972         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1fadade3f5ab1948696ffe4489fbf367">CMD_ENABLE_SVC_CHECK</a>:
<a name="l01973"></a>01973         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9fe6fa31702949a1eb89a1ea5cc3c201">CMD_DISABLE_SVC_CHECK</a>:
<a name="l01974"></a>01974         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0e43a4b4d43616ff459be2deadf28a96">CMD_DEL_ALL_SVC_COMMENTS</a>:
<a name="l01975"></a>01975         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9304e561328b09b21afa89742b6b6342">CMD_ENABLE_SVC_NOTIFICATIONS</a>:
<a name="l01976"></a>01976         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a954e4e9c3acc9c73b2af2ac1fc19a768">CMD_DISABLE_SVC_NOTIFICATIONS</a>:
<a name="l01977"></a>01977         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01978"></a>01978         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a15e9d66679fcb475fc1609b8b496b850">CMD_DISABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l01979"></a>01979         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>:
<a name="l01980"></a>01980         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abf243659a69ee0d3365f200294cd08e3">CMD_DISABLE_SVC_EVENT_HANDLER</a>:
<a name="l01981"></a>01981         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac28397aa6cedffbab2023b60bac0d2e6">CMD_REMOVE_SVC_ACKNOWLEDGEMENT</a>:
<a name="l01982"></a>01982         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>:
<a name="l01983"></a>01983         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>:
<a name="l01984"></a>01984         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a>:
<a name="l01985"></a>01985         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a916163bc87138000b647eb3a7a275408">CMD_ENABLE_SVC_FLAP_DETECTION</a>:
<a name="l01986"></a>01986         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae535a5cd022cbc0aafe4766f93cb94c9">CMD_DISABLE_SVC_FLAP_DETECTION</a>:
<a name="l01987"></a>01987         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adeda57bb270ad5564f5a8c3b5e23a3c5">CMD_START_OBSESSING_OVER_SVC</a>:
<a name="l01988"></a>01988         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8d23223c53e3a79fb126217a54be75c8">CMD_STOP_OBSESSING_OVER_SVC</a>:
<a name="l01989"></a>01989 
<a name="l01990"></a>01990                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a> || <a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l01991"></a>01991                         <span class="comment">/* make sure we have author and comment data */</span>
<a name="l01992"></a>01992                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l01993"></a>01993 
<a name="l01994"></a>01994                         <span class="comment">/* make sure we have start/end times for downtime */</span>
<a name="l01995"></a>01995                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>)
<a name="l01996"></a>01996                                 <a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d" title="checks if comment and author are not empty strings">check_time_sanity</a>(&amp;e);
<a name="l01997"></a>01997 
<a name="l01998"></a>01998                         <span class="comment">/* clean up the comment data if scheduling downtime */</span>
<a name="l01999"></a>01999                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l02000"></a>02000                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02001"></a>02001                 }
<a name="l02002"></a>02002 
<a name="l02003"></a>02003                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02004"></a>02004 
<a name="l02005"></a>02005                         cmd_has_objects = <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02006"></a>02006 
<a name="l02007"></a>02007                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL || <a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description == NULL)
<a name="l02008"></a>02008                                 <span class="keywordflow">continue</span>;
<a name="l02009"></a>02009 
<a name="l02010"></a>02010                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02011"></a>02011                         temp_service=<a class="code" href="objects_8c.html#ab1d2d0b3d54898c574aa58b9fe332aa6">find_service</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description);
<a name="l02012"></a>02012                         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#ae571f329c94c06d4802ff202d048d266">is_authorized_for_service_commands</a>(temp_service,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02013"></a>02013                                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02014"></a>02014                 }
<a name="l02015"></a>02015 
<a name="l02016"></a>02016                 <span class="comment">/* make sure we have passive check info (if necessary) */</span>
<a name="l02017"></a>02017                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a> &amp;&amp; !strcmp(<a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l02018"></a>02018                         error[e++].message=strdup(<span class="stringliteral">&quot;Check output cannot be blank&quot;</span>);
<a name="l02019"></a>02019 
<a name="l02020"></a>02020                 <span class="comment">/* make sure we have a notification delay (if necessary) */</span>
<a name="l02021"></a>02021                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a> &amp;&amp; <a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>&lt;=0)
<a name="l02022"></a>02022                         error[e++].message=strdup(<span class="stringliteral">&quot;Notification delay must be greater than 0&quot;</span>);
<a name="l02023"></a>02023 
<a name="l02024"></a>02024                 <span class="comment">/* make sure we have check time (if necessary) */</span>
<a name="l02025"></a>02025                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a> &amp;&amp; <a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>==(time_t)0)
<a name="l02026"></a>02026                         error[e++].message=strdup(<span class="stringliteral">&quot;Start time must be non-zero or bad format has been submitted&quot;</span>);
<a name="l02027"></a>02027 
<a name="l02028"></a>02028                 <span class="keywordflow">break</span>;
<a name="l02029"></a>02029 
<a name="l02030"></a>02030         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>:
<a name="l02031"></a>02031         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab45ce82cbb8bd87132044462b2c2cf2d">CMD_DISABLE_NOTIFICATIONS</a>:
<a name="l02032"></a>02032         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4615951f5161b6b778a6cb3938ca438e">CMD_SHUTDOWN_PROCESS</a>:
<a name="l02033"></a>02033         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae706ffbffb7f812e813c492f9805908f">CMD_RESTART_PROCESS</a>:
<a name="l02034"></a>02034         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>:
<a name="l02035"></a>02035         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9d3a2978d952e95c2b28cc2aebdc7722">CMD_STOP_EXECUTING_SVC_CHECKS</a>:
<a name="l02036"></a>02036         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l02037"></a>02037         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3a42e556cb0f6719ed8930d7bc68ff8f">CMD_STOP_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l02038"></a>02038         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>:
<a name="l02039"></a>02039         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9400fb3097302ed20125524ccd964129">CMD_DISABLE_EVENT_HANDLERS</a>:
<a name="l02040"></a>02040         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aef5d645e19291f05fd060c2cf53f0897">CMD_START_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l02041"></a>02041         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a94f3dde3552de89cc330e811c02ddf7b">CMD_STOP_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l02042"></a>02042         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a410b3872c3b9541b96d415190f6cfd74">CMD_ENABLE_FLAP_DETECTION</a>:
<a name="l02043"></a>02043         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1ff1981c4f64505b315755af554c65a8">CMD_DISABLE_FLAP_DETECTION</a>:
<a name="l02044"></a>02044         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3dd1f74a3ce6023b0de5090764317f44">CMD_ENABLE_FAILURE_PREDICTION</a>:
<a name="l02045"></a>02045         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adec8f3e8e4479e2ffaef21d12260142f">CMD_DISABLE_FAILURE_PREDICTION</a>:
<a name="l02046"></a>02046         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a78b643a9413d31cef72ab0d0122e2af7">CMD_ENABLE_PERFORMANCE_DATA</a>:
<a name="l02047"></a>02047         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9d3c2b1b310393e27501b034eaf9b81">CMD_DISABLE_PERFORMANCE_DATA</a>:
<a name="l02048"></a>02048         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1f12ceeaa459f528c3c96b024ec779e8">CMD_START_EXECUTING_HOST_CHECKS</a>:
<a name="l02049"></a>02049         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a29ba7e82e9fe9279ca412208548d94a8">CMD_STOP_EXECUTING_HOST_CHECKS</a>:
<a name="l02050"></a>02050         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0231991dd77addd3dd0a67b75fe91b99">CMD_START_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l02051"></a>02051         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a059b4514eb08898aa69f4c880833c40c">CMD_STOP_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l02052"></a>02052         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a81eb9c67248de83dd019697521b31bd6">CMD_START_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l02053"></a>02053         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a420810b071f18ba5a40e9e9e77634762">CMD_STOP_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l02054"></a>02054 
<a name="l02055"></a>02055                 <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02056"></a>02056                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l02057"></a>02057                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l02058"></a>02058                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02059"></a>02059                 }
<a name="l02060"></a>02060 
<a name="l02061"></a>02061                 <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l02062"></a>02062                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02063"></a>02063                 <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#ae3f6d2dab4898db493e84e42e44ebdfa">is_authorized_for_system_commands</a>(&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02064"></a>02064                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02065"></a>02065                 <span class="keywordflow">break</span>;
<a name="l02066"></a>02066 
<a name="l02067"></a>02067         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>:
<a name="l02068"></a>02068         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a>:
<a name="l02069"></a>02069         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ca6928efc44b1722cacb66e985a7a2a">CMD_DEL_ALL_HOST_COMMENTS</a>:
<a name="l02070"></a>02070         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a57d2695ba57df906ef8e4b120337a7b5">CMD_SCHEDULE_HOST_SVC_CHECKS</a>:
<a name="l02071"></a>02071         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>:
<a name="l02072"></a>02072         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>:
<a name="l02073"></a>02073         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l02074"></a>02074         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7e79b92ba7dbe949352433e4237db6e9">CMD_DISABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l02075"></a>02075         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l02076"></a>02076         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l02077"></a>02077         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>:
<a name="l02078"></a>02078         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad1c35cdf7cdb67da028c1fe8412db2d7">CMD_DISABLE_HOST_EVENT_HANDLER</a>:
<a name="l02079"></a>02079         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a>:
<a name="l02080"></a>02080         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>:
<a name="l02081"></a>02081         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>:
<a name="l02082"></a>02082         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>:
<a name="l02083"></a>02083         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a>:
<a name="l02084"></a>02084         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>:
<a name="l02085"></a>02085         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4a59d232d64b69088dc669ed09934001">CMD_ENABLE_HOST_FLAP_DETECTION</a>:
<a name="l02086"></a>02086         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa45928e7825a90937f7c0550efff08ad">CMD_DISABLE_HOST_FLAP_DETECTION</a>:
<a name="l02087"></a>02087         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>:
<a name="l02088"></a>02088         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a50253ccba246667112a01a6c7c32c5eb">CMD_ENABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l02089"></a>02089         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0ee96e57da3e75d6b0318ebebbcadc2">CMD_DISABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l02090"></a>02090         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>:
<a name="l02091"></a>02091         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a99ba56196e437148c85510c23191a8fa">CMD_START_OBSESSING_OVER_HOST</a>:
<a name="l02092"></a>02092         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a04ee1063e5ca5ded66101bb60f5c1bbd">CMD_STOP_OBSESSING_OVER_HOST</a>:
<a name="l02093"></a>02093 
<a name="l02094"></a>02094                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a> || <a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02095"></a>02095                         <span class="comment">/* make sure we have author and comment data */</span>
<a name="l02096"></a>02096                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l02097"></a>02097 
<a name="l02098"></a>02098                         <span class="comment">/* make sure we have start/end times for downtime */</span>
<a name="l02099"></a>02099                         <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a>)
<a name="l02100"></a>02100                                 <a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d" title="checks if comment and author are not empty strings">check_time_sanity</a>(&amp;e);
<a name="l02101"></a>02101 
<a name="l02102"></a>02102                         <span class="comment">/* clean up the comment data if scheduling downtime */</span>
<a name="l02103"></a>02103                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l02104"></a>02104                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02105"></a>02105                 }
<a name="l02106"></a>02106 
<a name="l02107"></a>02107                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02108"></a>02108 
<a name="l02109"></a>02109                         cmd_has_objects = <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02110"></a>02110 
<a name="l02111"></a>02111                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02112"></a>02112                                 <span class="keywordflow">continue</span>;
<a name="l02113"></a>02113 
<a name="l02114"></a>02114                         <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l02115"></a>02115                         <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02116"></a>02116                         temp_host=<a class="code" href="objects_8c.html#a00522e51ee51756c73a5395e6d1498d3">find_host</a>(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02117"></a>02117                         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a6261bb0d6a380f3a9004c419215a4a4d">is_authorized_for_host_commands</a>(temp_host,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02118"></a>02118                                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02119"></a>02119                 }
<a name="l02120"></a>02120 
<a name="l02121"></a>02121                 <span class="comment">/* make sure we have a notification delay (if necessary) */</span>
<a name="l02122"></a>02122                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a> &amp;&amp; <a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>&lt;=0)
<a name="l02123"></a>02123                         error[e++].message=strdup(<span class="stringliteral">&quot;Notification delay must be greater than 0&quot;</span>);
<a name="l02124"></a>02124 
<a name="l02125"></a>02125                 <span class="comment">/* make sure we have check time (if necessary) */</span>
<a name="l02126"></a>02126                 <span class="keywordflow">if</span>((cmd==<a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a> || cmd==<a class="code" href="include_2common_8h.html#a57d2695ba57df906ef8e4b120337a7b5">CMD_SCHEDULE_HOST_SVC_CHECKS</a>) &amp;&amp; <a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>==(time_t)0)
<a name="l02127"></a>02127                         error[e++].message=strdup(<span class="stringliteral">&quot;Start time must be non-zero or bad format has been submitted&quot;</span>);
<a name="l02128"></a>02128 
<a name="l02129"></a>02129                 <span class="comment">/* make sure we have passive check info (if necessary) */</span>
<a name="l02130"></a>02130                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a> &amp;&amp; !strcmp(<a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l02131"></a>02131                         error[e++].message=strdup(<span class="stringliteral">&quot;Check output cannot be blank&quot;</span>);
<a name="l02132"></a>02132 
<a name="l02133"></a>02133                 <span class="keywordflow">break</span>;
<a name="l02134"></a>02134 
<a name="l02135"></a>02135         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02136"></a>02136         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02137"></a>02137         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02138"></a>02138         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02139"></a>02139         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l02140"></a>02140         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l02141"></a>02141         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>:
<a name="l02142"></a>02142         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>:
<a name="l02143"></a>02143         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02144"></a>02144         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0b364d353364414254b771c84e9256d3">CMD_DISABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02145"></a>02145         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02146"></a>02146         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6c96b4300cbb5a6dc2b2c8a63ebb55ea">CMD_DISABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02147"></a>02147         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l02148"></a>02148         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad429a7756a139718439e4d8ee671a778">CMD_DISABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l02149"></a>02149         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a>:
<a name="l02150"></a>02150         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a>:
<a name="l02151"></a>02151 
<a name="l02152"></a>02152 
<a name="l02153"></a>02153                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a> \
<a name="l02154"></a>02154                 || cmd==<a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>){
<a name="l02155"></a>02155                         <span class="comment">/* make sure we have author and comment data */</span>
<a name="l02156"></a>02156                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l02157"></a>02157 
<a name="l02158"></a>02158                         <span class="comment">/* make sure we have start/end times for downtime */</span>
<a name="l02159"></a>02159                         <a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d" title="checks if comment and author are not empty strings">check_time_sanity</a>(&amp;e);
<a name="l02160"></a>02160 
<a name="l02161"></a>02161                         <span class="comment">/* clean up the comment data if scheduling downtime */</span>
<a name="l02162"></a>02162                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l02163"></a>02163                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02164"></a>02164                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02165"></a>02165                         <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(&amp;e);
<a name="l02166"></a>02166                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>);
<a name="l02167"></a>02167                         <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02168"></a>02168                 }
<a name="l02169"></a>02169 
<a name="l02170"></a>02170                 <span class="comment">/* see if the user is authorized to issue a command... */</span>
<a name="l02171"></a>02171                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02172"></a>02172                 <span class="keywordflow">if</span>(cmd==<a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>  || cmd==<a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a> || \
<a name="l02173"></a>02173                    cmd==<a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a> || cmd==<a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a> || \
<a name="l02174"></a>02174                    cmd==<a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>         || cmd==<a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a> || \
<a name="l02175"></a>02175                    cmd==<a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>    || cmd==<a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a> ){
<a name="l02176"></a>02176                         temp_hostgroup=<a class="code" href="objects_8c.html#aa7d4295d39f8443f9f19b1d04649dc92">find_hostgroup</a>(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02177"></a>02177                         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#af67bf07f188776bf358afe8a829d4a3f">is_authorized_for_hostgroup</a>(temp_hostgroup,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02178"></a>02178                                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02179"></a>02179                 } <span class="keywordflow">else</span> {
<a name="l02180"></a>02180                         temp_servicegroup=<a class="code" href="objects_8c.html#a04df5b80c21b884931124435483123cd">find_servicegroup</a>(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02181"></a>02181                         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a71977dcaffe64f1f8630c113dadf0a8c">is_authorized_for_servicegroup</a>(temp_servicegroup,&amp;current_authdata)==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02182"></a>02182                                 <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x]=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02183"></a>02183                 }
<a name="l02184"></a>02184 
<a name="l02185"></a>02185                 <span class="keywordflow">break</span>;
<a name="l02186"></a>02186 
<a name="l02187"></a>02187         <span class="keywordflow">default</span>:
<a name="l02188"></a>02188                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Sorry Dave, I can&#39;t let you do that...&quot;</span>,<span class="stringliteral">&quot;Executing an unknown command? Shame on you!&quot;</span>,2);
<a name="l02189"></a>02189 
<a name="l02190"></a>02190                 <span class="keywordflow">return</span>;
<a name="l02191"></a>02191         }
<a name="l02192"></a>02192 
<a name="l02193"></a>02193 
<a name="l02194"></a>02194         <span class="comment">/*</span>
<a name="l02195"></a>02195 <span class="comment">         * these are supposed to be implanted inside the</span>
<a name="l02196"></a>02196 <span class="comment">         * completed commands shipped off to Icinga and</span>
<a name="l02197"></a>02197 <span class="comment">         * must therefore never contain &#39;;&#39;</span>
<a name="l02198"></a>02198 <span class="comment">         */</span>
<a name="l02199"></a>02199         <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02200"></a>02200                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02201"></a>02201                         <span class="keywordflow">continue</span>;
<a name="l02202"></a>02202 
<a name="l02203"></a>02203                 <span class="keywordflow">if</span> (strchr(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>, <span class="charliteral">&#39;;&#39;</span>)) {
<a name="l02204"></a>02204                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(error_string,<span class="keyword">sizeof</span>(error_string),<span class="stringliteral">&quot;The hostname \&quot;%s\&quot; contains a semicolon&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name);
<a name="l02205"></a>02205                         error_string[<span class="keyword">sizeof</span>(error_string)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l02206"></a>02206                         error[e++].message=(<span class="keywordtype">char</span> *)strdup(error_string);
<a name="l02207"></a>02207                 }
<a name="l02208"></a>02208                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description != NULL &amp;&amp; strchr(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description, <span class="charliteral">&#39;;&#39;</span>)) {
<a name="l02209"></a>02209                         <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(error_string,<span class="keyword">sizeof</span>(error_string),<span class="stringliteral">&quot;The service description \&quot;%s\&quot; on host \&quot;%s\&quot; contains a semicolon&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].host_name);
<a name="l02210"></a>02210                         error_string[<span class="keyword">sizeof</span>(error_string)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l02211"></a>02211                         error[e++].message=strdup(error_string);
<a name="l02212"></a>02212                 }
<a name="l02213"></a>02213         }
<a name="l02214"></a>02214         <span class="keywordflow">if</span> (<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a> &amp;&amp; strchr(<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>, <span class="charliteral">&#39;;&#39;</span>))
<a name="l02215"></a>02215                 error[e++].message=strdup(<span class="stringliteral">&quot;The hostgroup name contains a semicolon&quot;</span>);
<a name="l02216"></a>02216         <span class="keywordflow">if</span> (<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a> &amp;&amp; strchr(<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>, <span class="charliteral">&#39;;&#39;</span>))
<a name="l02217"></a>02217                 error[e++].message=strdup(<span class="stringliteral">&quot;The servicegroup name  contains a semicolon&quot;</span>);
<a name="l02218"></a>02218 
<a name="l02219"></a>02219         printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;DIV align=&#39;center&#39;&gt;\n&quot;</span>);
<a name="l02220"></a>02220 
<a name="l02221"></a>02221         <span class="comment">/* if Icinga isn&#39;t checking external commands, don&#39;t do anything... */</span>
<a name="l02222"></a>02222         <span class="keywordflow">if</span>(<a class="code" href="commands_8c.html#abf64fe29cddb0d890bbece7d4d970c18">check_external_commands</a>==<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){
<a name="l02223"></a>02223                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Sorry, but Icinga is currently not checking for external commands, so your command will not be committed!&quot;</span>,<span class="stringliteral">&quot;Read the documentation for information on how to enable external commands...&quot;</span>,2);
<a name="l02224"></a>02224 
<a name="l02225"></a>02225                 <span class="keywordflow">return</span>;
<a name="l02226"></a>02226         }
<a name="l02227"></a>02227 
<a name="l02228"></a>02228         <span class="comment">/* to be safe, we are going to REQUIRE that the authentication functionality is enabled... */</span>
<a name="l02229"></a>02229         <span class="keywordflow">if</span>(<a class="code" href="cgiauth_8c.html#a8c8675d6714b8a8dce33fe43e0368efc">use_authentication</a>==<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>){
<a name="l02230"></a>02230                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Sorry Dave, I can&#39;t let you do that...&quot;</span>,<span class="stringliteral">&quot;It seems that you have chosen to not use the authentication functionality of the CGIs. I don&#39;t want to be personally responsible for what may happen as a result of allowing unauthorized users to issue commands to Icinga, so you&#39;ll have to disable this safeguard if you are really stubborn and want to invite trouble. Read the section on CGI authentication in the HTML documentation to learn how you can enable authentication and why you should want to.&quot;</span>,2);
<a name="l02231"></a>02231 
<a name="l02232"></a>02232                 <span class="keywordflow">return</span>;
<a name="l02233"></a>02233         }
<a name="l02234"></a>02234 
<a name="l02235"></a>02235         <span class="comment">/* Check if we found errors which preventing us from submiting the command */</span>
<a name="l02236"></a>02236         <span class="keywordflow">if</span>(e&gt;0) {
<a name="l02237"></a>02237                 printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;errorBox&#39;&gt;\n&quot;</span>);
<a name="l02238"></a>02238                 printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;errorMessage&#39;&gt;&lt;table cellspacing=0 cellpadding=0 border=0&gt;&lt;tr&gt;&lt;td width=55&gt;&lt;img src=\&quot;%s%s\&quot; border=0&gt;&lt;/td&gt;&quot;</span>,<a class="code" href="avail_8c.html#aca7df0d6cf5e9f0d6c3492b6e7238536">url_images_path</a>,<a class="code" href="cgiutils_8h.html#adc7fbc9a8618213934d5c461ecce4c16">CMD_STOP_ICON</a>);
<a name="l02239"></a>02239                 printf(<span class="stringliteral">&quot;&lt;td CLASS=&#39;errorMessage&#39;&gt;Following errors occured.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/DIV&gt;\n&quot;</span>);
<a name="l02240"></a>02240                 printf(<span class="stringliteral">&quot;&lt;table cellspacing=0 cellpadding=0 border=0 class=&#39;errorTable&#39;&gt;\n&quot;</span>);
<a name="l02241"></a>02241                 <span class="keywordflow">for</span> (e=0; e&lt;<a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; e++) {
<a name="l02242"></a>02242                         <span class="keywordflow">if</span> (error[e].<a class="code" href="structerrorlist.html#ab45003869c371e665838f6ae643599cb">message</a>==NULL)
<a name="l02243"></a>02243                                 <span class="keywordflow">continue</span>;
<a name="l02244"></a>02244                         <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>==<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>)
<a name="l02245"></a>02245                                 printf(<span class="stringliteral">&quot;&lt;p&gt;Error: %s&lt;/p&gt;&lt;BR&gt;\n&quot;</span>,error[e].<a class="code" href="structerrorlist.html#ab45003869c371e665838f6ae643599cb">message</a>);
<a name="l02246"></a>02246                         <span class="keywordflow">else</span> {
<a name="l02247"></a>02247                                 printf(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td class=&#39;errorString&#39;&gt;ERROR:&lt;/td&gt;&lt;td class=&#39;errorContent&#39;&gt;%s&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>,error[e].message);
<a name="l02248"></a>02248                         }
<a name="l02249"></a>02249                 }
<a name="l02250"></a>02250                 printf(<span class="stringliteral">&quot;&lt;/table&gt;\n&lt;/DIV&gt;\n&quot;</span>);
<a name="l02251"></a>02251                 printf(<span class="stringliteral">&quot;&lt;BR&gt;\n&quot;</span>);
<a name="l02252"></a>02252                 printf(<span class="stringliteral">&quot;&lt;table cellspacing=0 cellpadding=0 border=0 class=&#39;BoxWidth&#39;&gt;&lt;tr&gt;\n&quot;</span>);
<a name="l02253"></a>02253                 printf(<span class="stringliteral">&quot;&lt;td align=&#39;left&#39; width=&#39;50%%&#39;&gt;&lt;input type=&#39;submit&#39; value=&#39;&lt; Go back and fix it&#39; onClick=&#39;window.history.go(-1);&#39; class=&#39;submitButton&#39;&gt;&lt;/td&gt;\n&quot;</span>);
<a name="l02254"></a>02254                 printf(<span class="stringliteral">&quot;&lt;td align=&#39;right&#39; width=&#39;50%%&#39;&gt;&lt;input type=&#39;submit&#39; value=&#39;Get me out of here&#39; onClick=&#39;window.history.go(-2);&#39; class=&#39;submitButton&#39;&gt;&lt;/td&gt;\n&quot;</span>);
<a name="l02255"></a>02255                 printf(<span class="stringliteral">&quot;&lt;/tr&gt;&lt;/table&gt;&lt;/DIV&gt;&quot;</span>);
<a name="l02256"></a>02256                 <span class="keywordflow">return</span>;
<a name="l02257"></a>02257         }
<a name="l02258"></a>02258 
<a name="l02259"></a>02259         <span class="comment">/* Let&#39;s see if we have a command witch dosn&#39;t have any host, services or downtime/comment id&#39;s and check the authorisation */</span>
<a name="l02260"></a>02260         <span class="keywordflow">if</span> (cmd_has_objects == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> &amp;&amp; <a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[0]==<a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> ) {
<a name="l02261"></a>02261                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;Sorry, but you are not authorized to commit the specified command.&quot;</span>,<span class="stringliteral">&quot;Read the section of the documentation that deals with authentication and authorization in the CGIs for more information.&quot;</span>,2);
<a name="l02262"></a>02262 
<a name="l02263"></a>02263                 <span class="keywordflow">return</span>;
<a name="l02264"></a>02264         }
<a name="l02265"></a>02265 
<a name="l02266"></a>02266         <span class="comment">/* everything looks okay, so let&#39;s go ahead and commit the command... */</span>
<a name="l02267"></a>02267         <a class="code" href="cmd_8c.html#a4873a696e1f079765288bef01136ed51" title="checks the authorization and passes the data to cmd_submitf">commit_command</a>(cmd);
<a name="l02268"></a>02268 
<a name="l02269"></a>02269         <span class="comment">/* for commands without objects get the first result*/</span>
<a name="l02270"></a>02270         <span class="keywordflow">if</span>(cmd_has_objects == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
<a name="l02271"></a>02271                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[0]==<a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>){
<a name="l02272"></a>02272                         <span class="keywordflow">if</span>(<a class="code" href="avail_8c.html#aa0c17588e219a0f3df9507e75ea0949f">content_type</a>==<a class="code" href="cgiutils_8h.html#a3a62a4b30e6bdb96406bb1ead331294e">WML_CONTENT</a>)
<a name="l02273"></a>02273                                 printf(<span class="stringliteral">&quot;&lt;p&gt;Your command was submitted sucessfully...&lt;/p&gt;\n&quot;</span>);
<a name="l02274"></a>02274                         <span class="keywordflow">else</span>{
<a name="l02275"></a>02275                                 printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;successBox&#39;&gt;\n&quot;</span>);
<a name="l02276"></a>02276                                 printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;successMessage&#39;&gt;Your command request was successfully submitted to %s for processing.&lt;BR&gt;&lt;BR&gt;\n&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l02277"></a>02277                                 printf(<span class="stringliteral">&quot;Note: It may take a while before the command is actually processed.&lt;/DIV&gt;\n&quot;</span>);
<a name="l02278"></a>02278                                 printf(<span class="stringliteral">&quot;&lt;/DIV&gt;\n&quot;</span>);
<a name="l02279"></a>02279                                 printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;input type=&#39;submit&#39; value=&#39;Done&#39; onClick=&#39;window.history.go(-2);&#39; class=&#39;submitButton&#39;&gt;&lt;/DIV&gt;\n&quot;</span>);
<a name="l02280"></a>02280                         }
<a name="l02281"></a>02281                 }<span class="keywordflow">else</span>{
<a name="l02282"></a>02282                         <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;An error occurred while attempting to commit your command for processing.&quot;</span>,<span class="stringliteral">&quot;Unfortunately I can&#39;t determine the root cause of this problem.&quot;</span>,2);
<a name="l02283"></a>02283                 }
<a name="l02284"></a>02284         } <span class="keywordflow">else</span> {
<a name="l02285"></a>02285                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02286"></a>02286                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a> ) {
<a name="l02287"></a>02287                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l02288"></a>02288                                         <span class="keywordflow">continue</span>;
<a name="l02289"></a>02289                         } <span class="keywordflow">else</span> {
<a name="l02290"></a>02290                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02291"></a>02291                                         <span class="keywordflow">continue</span>;
<a name="l02292"></a>02292                         }
<a name="l02293"></a>02293 
<a name="l02294"></a>02294                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> || <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] == <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>) {
<a name="l02295"></a>02295                                 error_found=<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02296"></a>02296                                 <span class="keywordflow">break</span>;
<a name="l02297"></a>02297                         }
<a name="l02298"></a>02298                 }
<a name="l02299"></a>02299 
<a name="l02300"></a>02300                 <span class="keywordflow">if</span> (error_found) {
<a name="l02301"></a>02301                         <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(<span class="stringliteral">&quot;An error occurred while attempting to commit your command for processing.&quot;</span>,<span class="stringliteral">&quot;Not all commands could be send off successfully...&quot;</span>,0);
<a name="l02302"></a>02302                 } <span class="keywordflow">else</span> {
<a name="l02303"></a>02303                         printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;successBox&#39;&gt;\n&quot;</span>);
<a name="l02304"></a>02304                         printf(<span class="stringliteral">&quot;&lt;DIV CLASS=&#39;successMessage&#39;&gt;Your command requests were successfully submitted to %s for processing.&lt;BR&gt;&lt;BR&gt;\n&quot;</span>,<a class="code" href="include_2common_8h.html#a3b6a35b8be8405a9db72cc5dea97954b">PROGRAM_NAME</a>);
<a name="l02305"></a>02305                         printf(<span class="stringliteral">&quot;Note: It may take a while before the commands are actually processed.&lt;/DIV&gt;\n&quot;</span>);
<a name="l02306"></a>02306                         printf(<span class="stringliteral">&quot;&lt;/DIV&gt;\n&quot;</span>);
<a name="l02307"></a>02307                 }
<a name="l02308"></a>02308 
<a name="l02309"></a>02309                 printf(<span class="stringliteral">&quot;&lt;BR&gt;\n&quot;</span>);
<a name="l02310"></a>02310                 printf(<span class="stringliteral">&quot;&lt;TABLE CELLSPACING=&#39;0&#39; CELLPADDING=0 BORDER=0 CLASS=&#39;BoxWidth&#39;&gt;\n&quot;</span>);
<a name="l02311"></a>02311                 printf(<span class="stringliteral">&quot;&lt;tr class=&#39;BoxWidth&#39;&gt;&lt;td width=&#39;33%%&#39;&gt;&lt;/td&gt;&lt;td width=&#39;33%%&#39; align=&#39;center&#39;&gt;&lt;input type=&#39;submit&#39; value=&#39;Done&#39; onClick=&#39;window.history.go(-2);&#39; class=&#39;submitButton&#39;&gt;&lt;/td&gt;&lt;td width=&#39;33%%&#39; align=&#39;right&#39;&gt;\n&quot;</span>);
<a name="l02312"></a>02312                 <span class="keywordflow">if</span> (!error_found)
<a name="l02313"></a>02313                         printf(<span class="stringliteral">&quot;&lt;input type=&#39;submit&#39; value=&#39;Let me see what has been done&#39; onClick=\&quot;document.getElementById(&#39;sumCommit&#39;).style.display = &#39;&#39;;\&quot; class=&#39;submitButton&#39;&gt;\n&quot;</span>);
<a name="l02314"></a>02314                 printf(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/TR&gt;&lt;/TABLE&gt;\n&quot;</span>);
<a name="l02315"></a>02315                 printf(<span class="stringliteral">&quot;&lt;BR&gt;&lt;BR&gt;\n&quot;</span>);
<a name="l02316"></a>02316 
<a name="l02317"></a>02317                 printf(<span class="stringliteral">&quot;&lt;TABLE CELLSPACING=&#39;0&#39; CELLPADDING=&#39;0&#39; ID=&#39;sumCommit&#39; %s&gt;&lt;TR&gt;&lt;TD CLASS=&#39;boxFrame BoxWidth&#39;&gt;\n&quot;</span>,(error_found)?<span class="stringliteral">&quot;&quot;</span>:<span class="stringliteral">&quot;style=&#39;display:none;&#39;&quot;</span>);
<a name="l02318"></a>02318                 printf(<span class="stringliteral">&quot;&lt;table cellspacing=2 cellpadding=0 border=0 class=&#39;contentTable&#39;&gt;\n&quot;</span>);
<a name="l02319"></a>02319                 <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>)
<a name="l02320"></a>02320                         printf(<span class="stringliteral">&quot;&lt;tr class=&#39;sumHeader&#39;&gt;&lt;td width=&#39;80%%&#39;&gt;Comment ID&lt;/td&gt;&lt;td width=&#39;20%%&#39;&gt;Status&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l02321"></a>02321                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>)
<a name="l02322"></a>02322                         printf(<span class="stringliteral">&quot;&lt;tr class=&#39;sumHeader&#39;&gt;&lt;td width=&#39;80%%&#39;&gt;Downtime ID&lt;/td&gt;&lt;td width=&#39;20%%&#39;&gt;Status&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l02323"></a>02323                 <span class="keywordflow">else</span>
<a name="l02324"></a>02324                         printf(<span class="stringliteral">&quot;&lt;tr class=&#39;sumHeader&#39;&gt;&lt;td width=&#39;40%%&#39;&gt;Host&lt;/td&gt;&lt;td width=&#39;40%%&#39;&gt;Service&lt;/td&gt;&lt;td width=&#39;20%%&#39;&gt;Status&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l02325"></a>02325 
<a name="l02326"></a>02326                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02327"></a>02327 
<a name="l02328"></a>02328                         <span class="keywordflow">if</span> (cmd==<a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a> || cmd==<a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a> || cmd==<a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>) {
<a name="l02329"></a>02329                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l02330"></a>02330                                         <span class="keywordflow">continue</span>;
<a name="l02331"></a>02331                                 row_color = (row_color==0)?1:0;
<a name="l02332"></a>02332                                 printf(<span class="stringliteral">&quot;&lt;tr class=&#39;status%s&#39;&gt;&lt;td&gt;%lu&lt;/td&gt;&lt;td&gt;&quot;</span>,(row_color==0)?<span class="stringliteral">&quot;Even&quot;</span>:<span class="stringliteral">&quot;Odd &quot;</span>,<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l02333"></a>02333                         } <span class="keywordflow">else</span> {
<a name="l02334"></a>02334                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02335"></a>02335                                         <span class="keywordflow">continue</span>;
<a name="l02336"></a>02336                                 row_color = (row_color==0)?1:0;
<a name="l02337"></a>02337 
<a name="l02338"></a>02338                                 printf(<span class="stringliteral">&quot;&lt;tr class=&#39;status%s&#39;&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;&quot;</span>,(row_color==0)?<span class="stringliteral">&quot;Even&quot;</span>:<span class="stringliteral">&quot;Odd &quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,(<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description != NULL)?<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description:<span class="stringliteral">&quot;N/A&quot;</span>);
<a name="l02339"></a>02339                         }
<a name="l02340"></a>02340                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l02341"></a>02341                                 printf(<span class="stringliteral">&quot;&lt;DIV class=&#39;commitFailed&#39;&gt;Not Authorized&lt;/DIV&gt;&quot;</span>);
<a name="l02342"></a>02342                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] == <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>)
<a name="l02343"></a>02343                                 printf(<span class="stringliteral">&quot;&lt;DIV class=&#39;commitFailed&#39;&gt;FAILED&lt;/DIV&gt;&quot;</span>);
<a name="l02344"></a>02344                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] == <a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>)
<a name="l02345"></a>02345                                 printf(<span class="stringliteral">&quot;&lt;DIV class=&#39;commitSuccess&#39;&gt;Successful&lt;/DIV&gt;&quot;</span>);
<a name="l02346"></a>02346                         <span class="keywordflow">else</span>
<a name="l02347"></a>02347                                 printf(<span class="stringliteral">&quot;&lt;DIV class=&#39;commitUnknown&#39;&gt;Unknown&lt;/DIV&gt;&quot;</span>);
<a name="l02348"></a>02348 
<a name="l02349"></a>02349                         printf(<span class="stringliteral">&quot;&lt;/TD&gt;&lt;TR&gt;\n&quot;</span>);
<a name="l02350"></a>02350                 }
<a name="l02351"></a>02351                 printf(<span class="stringliteral">&quot;&lt;/TABLE&gt;\n&quot;</span>);
<a name="l02352"></a>02352                 printf(<span class="stringliteral">&quot;&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;&lt;/DIV&gt;\n&quot;</span>);
<a name="l02353"></a>02353         }
<a name="l02354"></a>02354         <span class="keywordflow">return</span>;
<a name="l02355"></a>02355 }
<a name="l02356"></a>02356 
<a name="l02357"></a>02357 
<a name="l02362"></a><a class="code" href="cmd_8c.html#a85b8182750276969e81fe38de2f14287">02362</a> <a class="code" href="cmd_8c.html#a85b8182750276969e81fe38de2f14287" title="doe&#39;s some checks before passing data to write_command_to_file">__attribute__</a>((format(printf, 2, 3)))
<a name="l02363"></a>02363 static <span class="keywordtype">int</span> cmd_submitf(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, const <span class="keywordtype">char</span> *fmt, ...){
<a name="l02364"></a>02364         <span class="keywordtype">char</span> cmd[<a class="code" href="include_2common_8h.html#a3f77bd41e4daa95db02bcd919bf9a485">MAX_EXTERNAL_COMMAND_LENGTH</a>];
<a name="l02365"></a>02365         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="objects_8h.html#a088e7e255920b314b3a74c9163ba65a0">command</a>;
<a name="l02366"></a>02366         <span class="keywordtype">int</span> len, len2;
<a name="l02367"></a>02367         va_list ap;
<a name="l02368"></a>02368 
<a name="l02369"></a>02369         command = <a class="code" href="cmd_8c.html#aa42189d96638a4f13aaf48a5128eafde">extcmd_get_name</a>(<span class="keywordtype">id</span>);
<a name="l02370"></a>02370         <span class="comment">/*</span>
<a name="l02371"></a>02371 <span class="comment">         * We disallow sending &#39;CHANGE&#39; commands from the cgi&#39;s</span>
<a name="l02372"></a>02372 <span class="comment">         * until we do proper session handling to prevent cross-site</span>
<a name="l02373"></a>02373 <span class="comment">         * request forgery</span>
<a name="l02374"></a>02374 <span class="comment">         */</span>
<a name="l02375"></a>02375         <span class="keywordflow">if</span> (!command || (strlen(command) &gt; 6 &amp;&amp; !memcmp(<span class="stringliteral">&quot;CHANGE&quot;</span>, command, 6)))
<a name="l02376"></a>02376                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02377"></a>02377 
<a name="l02378"></a>02378         <span class="keywordflow">if</span>(<a class="code" href="commands_8c.html#ad0b68c2d5394aea2ad23c94641936dc1">log_external_commands_user</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02379"></a>02379                 <a class="code" href="cgiauth_8c.html#a6fd1465f39a46eecf4013821ea859270">get_authentication_information</a>(&amp;current_authdata);
<a name="l02380"></a>02380                 len = <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(cmd, <span class="keyword">sizeof</span>(cmd) - 1, <span class="stringliteral">&quot;[%lu] %s;%s;&quot;</span>, time(NULL), command, current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>);
<a name="l02381"></a>02381         } <span class="keywordflow">else</span> {
<a name="l02382"></a>02382                 len = <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(cmd, <span class="keyword">sizeof</span>(cmd) - 1, <span class="stringliteral">&quot;[%lu] %s;&quot;</span>, time(NULL), command);
<a name="l02383"></a>02383         }
<a name="l02384"></a>02384 
<a name="l02385"></a>02385         <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02386"></a>02386                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02387"></a>02387 
<a name="l02388"></a>02388         <span class="keywordflow">if</span>(fmt) {
<a name="l02389"></a>02389                 va_start(ap, fmt);
<a name="l02390"></a>02390                 len2 = <a class="code" href="snprintf_8c.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>(&amp;cmd[len], <span class="keyword">sizeof</span>(cmd) - len - 1, fmt, ap);
<a name="l02391"></a>02391                 va_end(ap);
<a name="l02392"></a>02392                 <span class="keywordflow">if</span> (len2 &lt; 0)
<a name="l02393"></a>02393                         <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02394"></a>02394         }
<a name="l02395"></a>02395 
<a name="l02396"></a>02396         <span class="keywordflow">return</span> <a class="code" href="cmd_8c.html#afb6cb65ae7812183ed147dd6539e59e7" title="write the command to Icinga command pipe">write_command_to_file</a>(cmd);
<a name="l02397"></a>02397 }
<a name="l02398"></a>02398 
<a name="l02399"></a><a class="code" href="cmd_8c.html#a4873a696e1f079765288bef01136ed51">02399</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#a4873a696e1f079765288bef01136ed51" title="checks the authorization and passes the data to cmd_submitf">commit_command</a>(<span class="keywordtype">int</span> cmd){
<a name="l02400"></a>02400         time_t <a class="code" href="status_8c.html#ab1938d5563a4d7b5ef9b9f74a685508b">current_time</a>;
<a name="l02401"></a>02401         time_t scheduled_time;
<a name="l02402"></a>02402         time_t notification_time;
<a name="l02403"></a>02403         <span class="keywordtype">int</span> x = 0;
<a name="l02404"></a>02404 
<a name="l02405"></a>02405         <span class="comment">/* get the current time */</span>
<a name="l02406"></a>02406         time(&amp;current_time);
<a name="l02407"></a>02407 
<a name="l02408"></a>02408         <span class="comment">/* get the scheduled time */</span>
<a name="l02409"></a>02409         scheduled_time=current_time+(<a class="code" href="cmd_8c.html#ad5481c62c063787258f51f2a5526edcf">schedule_delay</a>*60);
<a name="l02410"></a>02410 
<a name="l02411"></a>02411         <span class="comment">/* get the notification time */</span>
<a name="l02412"></a>02412         notification_time=current_time+(<a class="code" href="cmd_8c.html#a370961270608af791e9054e0b1fa0990">notification_delay</a>*60);
<a name="l02413"></a>02413 
<a name="l02414"></a>02414         <span class="comment">/* decide how to form the command line... */</span>
<a name="l02415"></a>02415         <span class="keywordflow">switch</span>(cmd){
<a name="l02416"></a>02416 
<a name="l02417"></a>02417                 <span class="comment">/* commands without arguments */</span>
<a name="l02418"></a>02418         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a464c233975ae39f42acc00b1d40060bf">CMD_START_EXECUTING_SVC_CHECKS</a>:
<a name="l02419"></a>02419         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9d3a2978d952e95c2b28cc2aebdc7722">CMD_STOP_EXECUTING_SVC_CHECKS</a>:
<a name="l02420"></a>02420         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a36bf265e1a75dc3cf7ff937bc03db136">CMD_START_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l02421"></a>02421         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3a42e556cb0f6719ed8930d7bc68ff8f">CMD_STOP_ACCEPTING_PASSIVE_SVC_CHECKS</a>:
<a name="l02422"></a>02422         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a12405ec48fbaca1f155d6bc0f5b6e134">CMD_ENABLE_EVENT_HANDLERS</a>:
<a name="l02423"></a>02423         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9400fb3097302ed20125524ccd964129">CMD_DISABLE_EVENT_HANDLERS</a>:
<a name="l02424"></a>02424         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aef5d645e19291f05fd060c2cf53f0897">CMD_START_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l02425"></a>02425         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a94f3dde3552de89cc330e811c02ddf7b">CMD_STOP_OBSESSING_OVER_SVC_CHECKS</a>:
<a name="l02426"></a>02426         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a410b3872c3b9541b96d415190f6cfd74">CMD_ENABLE_FLAP_DETECTION</a>:
<a name="l02427"></a>02427         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1ff1981c4f64505b315755af554c65a8">CMD_DISABLE_FLAP_DETECTION</a>:
<a name="l02428"></a>02428         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3dd1f74a3ce6023b0de5090764317f44">CMD_ENABLE_FAILURE_PREDICTION</a>:
<a name="l02429"></a>02429         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adec8f3e8e4479e2ffaef21d12260142f">CMD_DISABLE_FAILURE_PREDICTION</a>:
<a name="l02430"></a>02430         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a78b643a9413d31cef72ab0d0122e2af7">CMD_ENABLE_PERFORMANCE_DATA</a>:
<a name="l02431"></a>02431         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9d3c2b1b310393e27501b034eaf9b81">CMD_DISABLE_PERFORMANCE_DATA</a>:
<a name="l02432"></a>02432         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1f12ceeaa459f528c3c96b024ec779e8">CMD_START_EXECUTING_HOST_CHECKS</a>:
<a name="l02433"></a>02433         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a29ba7e82e9fe9279ca412208548d94a8">CMD_STOP_EXECUTING_HOST_CHECKS</a>:
<a name="l02434"></a>02434         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0231991dd77addd3dd0a67b75fe91b99">CMD_START_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l02435"></a>02435         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a059b4514eb08898aa69f4c880833c40c">CMD_STOP_ACCEPTING_PASSIVE_HOST_CHECKS</a>:
<a name="l02436"></a>02436         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a81eb9c67248de83dd019697521b31bd6">CMD_START_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l02437"></a>02437         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a420810b071f18ba5a40e9e9e77634762">CMD_STOP_OBSESSING_OVER_HOST_CHECKS</a>:
<a name="l02438"></a>02438                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02439"></a>02439                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,NULL);
<a name="l02440"></a>02440                 <span class="keywordflow">break</span>;
<a name="l02441"></a>02441 
<a name="l02442"></a>02442                 <span class="comment">/* simple host commands */</span>
<a name="l02443"></a>02443         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4a59d232d64b69088dc669ed09934001">CMD_ENABLE_HOST_FLAP_DETECTION</a>:
<a name="l02444"></a>02444         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa45928e7825a90937f7c0550efff08ad">CMD_DISABLE_HOST_FLAP_DETECTION</a>:
<a name="l02445"></a>02445         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a50253ccba246667112a01a6c7c32c5eb">CMD_ENABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l02446"></a>02446         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0ee96e57da3e75d6b0318ebebbcadc2">CMD_DISABLE_PASSIVE_HOST_CHECKS</a>:
<a name="l02447"></a>02447         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a99ba56196e437148c85510c23191a8fa">CMD_START_OBSESSING_OVER_HOST</a>:
<a name="l02448"></a>02448         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a04ee1063e5ca5ded66101bb60f5c1bbd">CMD_STOP_OBSESSING_OVER_HOST</a>:
<a name="l02449"></a>02449         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ca6928efc44b1722cacb66e985a7a2a">CMD_DEL_ALL_HOST_COMMENTS</a>:
<a name="l02450"></a>02450         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a099b74e2d71ee2bf70dcf7113882d92f">CMD_ENABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l02451"></a>02451         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7e79b92ba7dbe949352433e4237db6e9">CMD_DISABLE_ALL_NOTIFICATIONS_BEYOND_HOST</a>:
<a name="l02452"></a>02452         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad20bb7ce4132f1d7b5dc8d7e52c7fd63">CMD_ENABLE_HOST_EVENT_HANDLER</a>:
<a name="l02453"></a>02453         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad1c35cdf7cdb67da028c1fe8412db2d7">CMD_DISABLE_HOST_EVENT_HANDLER</a>:
<a name="l02454"></a>02454         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a>:
<a name="l02455"></a>02455         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>:
<a name="l02456"></a>02456         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8dfa30706484edb33a84f03bc235cd6b">CMD_REMOVE_HOST_ACKNOWLEDGEMENT</a>:
<a name="l02457"></a>02457                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02458"></a>02458                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02459"></a>02459                                 <span class="keywordflow">continue</span>;
<a name="l02460"></a>02460                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02461"></a>02461                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02462"></a>02462                 }
<a name="l02463"></a>02463                 <span class="keywordflow">break</span>;
<a name="l02464"></a>02464 
<a name="l02465"></a>02465                 <span class="comment">/* simple service commands */</span>
<a name="l02466"></a>02466         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a916163bc87138000b647eb3a7a275408">CMD_ENABLE_SVC_FLAP_DETECTION</a>:
<a name="l02467"></a>02467         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae535a5cd022cbc0aafe4766f93cb94c9">CMD_DISABLE_SVC_FLAP_DETECTION</a>:
<a name="l02468"></a>02468         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a6c91ad4e0dc27319720410597f6382">CMD_ENABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l02469"></a>02469         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a15e9d66679fcb475fc1609b8b496b850">CMD_DISABLE_PASSIVE_SVC_CHECKS</a>:
<a name="l02470"></a>02470         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#adeda57bb270ad5564f5a8c3b5e23a3c5">CMD_START_OBSESSING_OVER_SVC</a>:
<a name="l02471"></a>02471         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8d23223c53e3a79fb126217a54be75c8">CMD_STOP_OBSESSING_OVER_SVC</a>:
<a name="l02472"></a>02472         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0e43a4b4d43616ff459be2deadf28a96">CMD_DEL_ALL_SVC_COMMENTS</a>:
<a name="l02473"></a>02473         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9304e561328b09b21afa89742b6b6342">CMD_ENABLE_SVC_NOTIFICATIONS</a>:
<a name="l02474"></a>02474         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a954e4e9c3acc9c73b2af2ac1fc19a768">CMD_DISABLE_SVC_NOTIFICATIONS</a>:
<a name="l02475"></a>02475         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9c0b2a3aa909c6b412f6f178e2eaa52e">CMD_ENABLE_SVC_EVENT_HANDLER</a>:
<a name="l02476"></a>02476         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abf243659a69ee0d3365f200294cd08e3">CMD_DISABLE_SVC_EVENT_HANDLER</a>:
<a name="l02477"></a>02477         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1fadade3f5ab1948696ffe4489fbf367">CMD_ENABLE_SVC_CHECK</a>:
<a name="l02478"></a>02478         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a9fe6fa31702949a1eb89a1ea5cc3c201">CMD_DISABLE_SVC_CHECK</a>:
<a name="l02479"></a>02479         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac28397aa6cedffbab2023b60bac0d2e6">CMD_REMOVE_SVC_ACKNOWLEDGEMENT</a>:
<a name="l02480"></a>02480                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02481"></a>02481                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02482"></a>02482                                 <span class="keywordflow">continue</span>;
<a name="l02483"></a>02483                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02484"></a>02484                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description);
<a name="l02485"></a>02485                 }
<a name="l02486"></a>02486                 <span class="keywordflow">break</span>;
<a name="l02487"></a>02487 
<a name="l02488"></a>02488         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af7d41f57030c58feb857a2d25f6ef057">CMD_ADD_HOST_COMMENT</a>:
<a name="l02489"></a>02489                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02490"></a>02490                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02491"></a>02491                                 <span class="keywordflow">continue</span>;
<a name="l02492"></a>02492                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02493"></a>02493                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02494"></a>02494                 }
<a name="l02495"></a>02495                 <span class="keywordflow">break</span>;
<a name="l02496"></a>02496 
<a name="l02497"></a>02497         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a46004113c584da3d7cbfe6ebfde143af">CMD_ADD_SVC_COMMENT</a>:
<a name="l02498"></a>02498                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02499"></a>02499                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02500"></a>02500                                 <span class="keywordflow">continue</span>;
<a name="l02501"></a>02501                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02502"></a>02502                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02503"></a>02503                 }
<a name="l02504"></a>02504                 <span class="keywordflow">break</span>;
<a name="l02505"></a>02505 
<a name="l02506"></a>02506         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae19c8afd837332be9dc66dd1f96ecd83">CMD_DEL_HOST_COMMENT</a>:
<a name="l02507"></a>02507         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abe8af3eb56433833f964e0c417383ab6">CMD_DEL_SVC_COMMENT</a>:
<a name="l02508"></a>02508         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad31723b9edb07951adc11561145c2a6c">CMD_DEL_HOST_DOWNTIME</a>:
<a name="l02509"></a>02509         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0fd99267e26d827cfd5e6353419ceac4">CMD_DEL_SVC_DOWNTIME</a>:
<a name="l02510"></a>02510                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02511"></a>02511                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x] == <a class="code" href="include_2common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l02512"></a>02512                                 <span class="keywordflow">continue</span>;
<a name="l02513"></a>02513                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02514"></a>02514                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a51f73ccc241b6ce18ee72c60d58c5335">multi_ids</a>[x]);
<a name="l02515"></a>02515                 }
<a name="l02516"></a>02516                 <span class="keywordflow">break</span>;
<a name="l02517"></a>02517 
<a name="l02518"></a>02518         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4dbcaccca3aba41d4205f2293c226aa1">CMD_DELAY_HOST_NOTIFICATION</a>:
<a name="l02519"></a>02519                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02520"></a>02520                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02521"></a>02521                                 <span class="keywordflow">continue</span>;
<a name="l02522"></a>02522                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02523"></a>02523                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,notification_time);
<a name="l02524"></a>02524                 }
<a name="l02525"></a>02525                 <span class="keywordflow">break</span>;
<a name="l02526"></a>02526 
<a name="l02527"></a>02527         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a56ca60e2f27db6c6c50634ed0b7926b5">CMD_DELAY_SVC_NOTIFICATION</a>:
<a name="l02528"></a>02528                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02529"></a>02529                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02530"></a>02530                                 <span class="keywordflow">continue</span>;
<a name="l02531"></a>02531                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02532"></a>02532                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,notification_time);
<a name="l02533"></a>02533                 }
<a name="l02534"></a>02534                 <span class="keywordflow">break</span>;
<a name="l02535"></a>02535 
<a name="l02536"></a>02536         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5793ef56944cec564e061b9e32044920">CMD_SCHEDULE_SVC_CHECK</a>:
<a name="l02537"></a>02537         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1353497130e25eef8e339a5daa05eebe">CMD_SCHEDULE_FORCED_SVC_CHECK</a>:
<a name="l02538"></a>02538                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02539"></a>02539                         cmd=<a class="code" href="include_2common_8h.html#a1353497130e25eef8e339a5daa05eebe">CMD_SCHEDULE_FORCED_SVC_CHECK</a>;
<a name="l02540"></a>02540                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02541"></a>02541                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02542"></a>02542                                 <span class="keywordflow">continue</span>;
<a name="l02543"></a>02543                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02544"></a>02544                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>);
<a name="l02545"></a>02545                 }
<a name="l02546"></a>02546                 <span class="keywordflow">break</span>;
<a name="l02547"></a>02547 
<a name="l02548"></a>02548         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab45ce82cbb8bd87132044462b2c2cf2d">CMD_DISABLE_NOTIFICATIONS</a>:
<a name="l02549"></a>02549         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a41c6a6759ac2dfeca69f5203977336c4">CMD_ENABLE_NOTIFICATIONS</a>:
<a name="l02550"></a>02550         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4615951f5161b6b778a6cb3938ca438e">CMD_SHUTDOWN_PROCESS</a>:
<a name="l02551"></a>02551         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae706ffbffb7f812e813c492f9805908f">CMD_RESTART_PROCESS</a>:
<a name="l02552"></a>02552                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02553"></a>02553                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%lu&quot;</span>,scheduled_time);
<a name="l02554"></a>02554                 <span class="keywordflow">break</span>;
<a name="l02555"></a>02555 
<a name="l02556"></a>02556         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>:
<a name="l02557"></a>02557         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aa3e13dadc895b527a393b5a7a82a7d8c">CMD_DISABLE_HOST_SVC_CHECKS</a>:
<a name="l02558"></a>02558                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02559"></a>02559                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02560"></a>02560                                 <span class="keywordflow">continue</span>;
<a name="l02561"></a>02561                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02562"></a>02562                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02563"></a>02563                 }
<a name="l02564"></a>02564                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02565"></a>02565                         cmd = (cmd == <a class="code" href="include_2common_8h.html#a6b21301d50f049f46f6aed64604cfbf4">CMD_ENABLE_HOST_SVC_CHECKS</a>) ? <a class="code" href="include_2common_8h.html#afe042ec618f029877ad68c642168b7af">CMD_ENABLE_HOST_CHECK</a> : <a class="code" href="include_2common_8h.html#a0780ab3245b39141eda0c744fe6d6646">CMD_DISABLE_HOST_CHECK</a>;
<a name="l02566"></a>02566                         <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02567"></a>02567                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02568"></a>02568                                         <span class="keywordflow">continue</span>;
<a name="l02569"></a>02569                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02570"></a>02570                                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02571"></a>02571                         }
<a name="l02572"></a>02572                 }
<a name="l02573"></a>02573                 <span class="keywordflow">break</span>;
<a name="l02574"></a>02574 
<a name="l02575"></a>02575         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a57d2695ba57df906ef8e4b120337a7b5">CMD_SCHEDULE_HOST_SVC_CHECKS</a>:
<a name="l02576"></a>02576                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a> == <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02577"></a>02577                         cmd = <a class="code" href="include_2common_8h.html#afe48053442015599dc93276513dd1b7a">CMD_SCHEDULE_FORCED_HOST_SVC_CHECKS</a>;
<a name="l02578"></a>02578                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02579"></a>02579                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02580"></a>02580                                 <span class="keywordflow">continue</span>;
<a name="l02581"></a>02581                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02582"></a>02582                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,scheduled_time);
<a name="l02583"></a>02583                 }
<a name="l02584"></a>02584                 <span class="keywordflow">break</span>;
<a name="l02585"></a>02585 
<a name="l02586"></a>02586         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>:
<a name="l02587"></a>02587         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>:
<a name="l02588"></a>02588                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a3aa3bc94533aab17cb34c6703a252db4">propagate_to_children</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02589"></a>02589                         cmd = (cmd == <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a>) ? <a class="code" href="include_2common_8h.html#a1a3e274c38679187b366772faa3ad315">CMD_ENABLE_HOST_AND_CHILD_NOTIFICATIONS</a> : <a class="code" href="include_2common_8h.html#ab614636c41cd24cae4c528922d802827">CMD_DISABLE_HOST_AND_CHILD_NOTIFICATIONS</a>;
<a name="l02590"></a>02590                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02591"></a>02591                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02592"></a>02592                                 <span class="keywordflow">continue</span>;
<a name="l02593"></a>02593                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02594"></a>02594                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02595"></a>02595                 }
<a name="l02596"></a>02596                 <span class="keywordflow">break</span>;
<a name="l02597"></a>02597 
<a name="l02598"></a>02598         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l02599"></a>02599         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5d51373b3399c07152c09c1b7ed0a0dc">CMD_DISABLE_HOST_SVC_NOTIFICATIONS</a>:
<a name="l02600"></a>02600                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02601"></a>02601                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02602"></a>02602                                 <span class="keywordflow">continue</span>;
<a name="l02603"></a>02603                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02604"></a>02604                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02605"></a>02605                 }
<a name="l02606"></a>02606                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02607"></a>02607                         cmd = (cmd == <a class="code" href="include_2common_8h.html#a72be85800979e05cd920a1ae99b4dc35">CMD_ENABLE_HOST_SVC_NOTIFICATIONS</a>) ? <a class="code" href="include_2common_8h.html#a3e58cabff982fae3e9ea4319242883a3">CMD_ENABLE_HOST_NOTIFICATIONS</a> : <a class="code" href="include_2common_8h.html#abd91ab6721c6e82cddfbc87f2a25039b">CMD_DISABLE_HOST_NOTIFICATIONS</a>;
<a name="l02608"></a>02608                         <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02609"></a>02609                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02610"></a>02610                                         <span class="keywordflow">continue</span>;
<a name="l02611"></a>02611                                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02612"></a>02612                                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>);
<a name="l02613"></a>02613                         }
<a name="l02614"></a>02614                 }
<a name="l02615"></a>02615                 <span class="keywordflow">break</span>;
<a name="l02616"></a>02616 
<a name="l02617"></a>02617         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ac4b322c35cfcb7def0bbba93e9724255">CMD_ACKNOWLEDGE_HOST_PROBLEM</a>:
<a name="l02618"></a>02618                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02619"></a>02619                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02620"></a>02620                                 <span class="keywordflow">continue</span>;
<a name="l02621"></a>02621                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02622"></a>02622                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%d;%d;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,(<a class="code" href="cmd_8c.html#a72b6dc8eb7e681d1c76ac1e84ecd5e79">sticky_ack</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)?<a class="code" href="include_2common_8h.html#a20d768ff427f46df3c3c1abbd31a081e">ACKNOWLEDGEMENT_STICKY</a>:<a class="code" href="include_2common_8h.html#a1bcd09fb6b178a332a4f438d4e929db5">ACKNOWLEDGEMENT_NORMAL</a>,<a class="code" href="cmd_8c.html#a891c67ceefc726acfabaa78113552c1a">send_notification</a>,<a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02623"></a>02623                 }
<a name="l02624"></a>02624                 <span class="keywordflow">break</span>;
<a name="l02625"></a>02625 
<a name="l02626"></a>02626         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6a7098bcd9f70af3b3a05bcd77330841">CMD_ACKNOWLEDGE_SVC_PROBLEM</a>:
<a name="l02627"></a>02627                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02628"></a>02628                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02629"></a>02629                                 <span class="keywordflow">continue</span>;
<a name="l02630"></a>02630                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02631"></a>02631                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%d;%d;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,(<a class="code" href="cmd_8c.html#a72b6dc8eb7e681d1c76ac1e84ecd5e79">sticky_ack</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)?<a class="code" href="include_2common_8h.html#a20d768ff427f46df3c3c1abbd31a081e">ACKNOWLEDGEMENT_STICKY</a>:<a class="code" href="include_2common_8h.html#a1bcd09fb6b178a332a4f438d4e929db5">ACKNOWLEDGEMENT_NORMAL</a>,<a class="code" href="cmd_8c.html#a891c67ceefc726acfabaa78113552c1a">send_notification</a>,<a class="code" href="cmd_8c.html#a404216d63ec51b55963dd8445d96cbc8">persistent_comment</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02632"></a>02632                 }
<a name="l02633"></a>02633                 <span class="keywordflow">break</span>;
<a name="l02634"></a>02634 
<a name="l02635"></a>02635         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6ee3e56df987de87dc688edaedbf4213">CMD_PROCESS_SERVICE_CHECK_RESULT</a>:
<a name="l02636"></a>02636                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02637"></a>02637                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02638"></a>02638                                 <span class="keywordflow">continue</span>;
<a name="l02639"></a>02639                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02640"></a>02640                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%d;%s|%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<a class="code" href="cmd_8c.html#a72558e782d26e44b8764513c5f79d644">plugin_state</a>,<a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>,<a class="code" href="cmd_8c.html#af10f6f871a018be899f199724459bc10">performance_data</a>);
<a name="l02641"></a>02641                 }
<a name="l02642"></a>02642                 <span class="keywordflow">break</span>;
<a name="l02643"></a>02643 
<a name="l02644"></a>02644         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a4ea6d463eb95f9c71aa4876c5204620c">CMD_PROCESS_HOST_CHECK_RESULT</a>:
<a name="l02645"></a>02645                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02646"></a>02646                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02647"></a>02647                                 <span class="keywordflow">continue</span>;
<a name="l02648"></a>02648                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02649"></a>02649                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%d;%s|%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a72558e782d26e44b8764513c5f79d644">plugin_state</a>,<a class="code" href="cmd_8c.html#afea5bc0cd40f5041479a985a8965dc19">plugin_output</a>,<a class="code" href="cmd_8c.html#af10f6f871a018be899f199724459bc10">performance_data</a>);
<a name="l02650"></a>02650                 }
<a name="l02651"></a>02651                 <span class="keywordflow">break</span>;
<a name="l02652"></a>02652 
<a name="l02653"></a>02653         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#af8fd3b915f085b6a81a7a31dfae2f404">CMD_SCHEDULE_HOST_DOWNTIME</a>:
<a name="l02654"></a>02654                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#ad7dce00a0d3e7156cb54d6a7061abb00">child_options</a>==1)
<a name="l02655"></a>02655                         cmd = <a class="code" href="include_2common_8h.html#a34aab20bf0c5109191699af5653ec463">CMD_SCHEDULE_AND_PROPAGATE_TRIGGERED_HOST_DOWNTIME</a>;
<a name="l02656"></a>02656                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#ad7dce00a0d3e7156cb54d6a7061abb00">child_options</a> == 2)
<a name="l02657"></a>02657                         cmd = <a class="code" href="include_2common_8h.html#ac276a173d2f8e7298b9c71712bc5af48">CMD_SCHEDULE_AND_PROPAGATE_HOST_DOWNTIME</a>;
<a name="l02658"></a>02658                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02659"></a>02659                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02660"></a>02660                                 <span class="keywordflow">continue</span>;
<a name="l02661"></a>02661                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02662"></a>02662                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;%lu;%lu;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">triggered_by</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02663"></a>02663                 }
<a name="l02664"></a>02664                 <span class="keywordflow">break</span>;
<a name="l02665"></a>02665 
<a name="l02666"></a>02666         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ab9a83681fcb8264606beeedb5d97f987">CMD_SCHEDULE_HOST_SVC_DOWNTIME</a>:
<a name="l02667"></a>02667                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02668"></a>02668                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02669"></a>02669                                 <span class="keywordflow">continue</span>;
<a name="l02670"></a>02670                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02671"></a>02671                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;%lu;%lu;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">triggered_by</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02672"></a>02672                 }
<a name="l02673"></a>02673                 <span class="keywordflow">break</span>;
<a name="l02674"></a>02674 
<a name="l02675"></a>02675         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#afd66f21ac4e9597a3fa18df77c71d7ef">CMD_SCHEDULE_SVC_DOWNTIME</a>:
<a name="l02676"></a>02676                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02677"></a>02677                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02678"></a>02678                                 <span class="keywordflow">continue</span>;
<a name="l02679"></a>02679                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02680"></a>02680                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%lu;%lu;%d;%lu;%lu;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ac9cc43b1e9b15d8034bb1a6cc9e4af71">triggered_by</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02681"></a>02681                 }
<a name="l02682"></a>02682                 <span class="keywordflow">break</span>;
<a name="l02683"></a>02683 
<a name="l02684"></a>02684         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a7c1b0cb8800dc8e815e62ac99becaa87">CMD_SCHEDULE_HOST_CHECK</a>:
<a name="l02685"></a>02685                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a74ef2011da0dd6563eee9f1453be9dd5">force_check</a> == <a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l02686"></a>02686                         cmd = <a class="code" href="include_2common_8h.html#a35a4c8e80e9be2b5140653459e5b241e">CMD_SCHEDULE_FORCED_HOST_CHECK</a>;
<a name="l02687"></a>02687                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02688"></a>02688                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02689"></a>02689                                 <span class="keywordflow">continue</span>;
<a name="l02690"></a>02690                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02691"></a>02691                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>);
<a name="l02692"></a>02692                 }
<a name="l02693"></a>02693                 <span class="keywordflow">break</span>;
<a name="l02694"></a>02694 
<a name="l02695"></a>02695         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5cfcb56836c4425617e0029cc0765421">CMD_SEND_CUSTOM_HOST_NOTIFICATION</a>:
<a name="l02696"></a>02696                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02697"></a>02697                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02698"></a>02698                                 <span class="keywordflow">continue</span>;
<a name="l02699"></a>02699                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02700"></a>02700                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,(<a class="code" href="cmd_8c.html#a8784590e30c25d5b86c91320abc8b5a6">force_notification</a> | <a class="code" href="cmd_8c.html#a2ca36f69c287d587950d02b7aecdd471">broadcast_notification</a>),<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02701"></a>02701                 }
<a name="l02702"></a>02702                 <span class="keywordflow">break</span>;
<a name="l02703"></a>02703 
<a name="l02704"></a>02704         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad0846859b12e531544dce8a09778f167">CMD_SEND_CUSTOM_SVC_NOTIFICATION</a>:
<a name="l02705"></a>02705                 <span class="keywordflow">for</span> ( x = 0; x &lt; <a class="code" href="cmd_8c.html#ac773049173a6e1fb7af38a7a56acc7bb">NUMBER_OF_STRUCTS</a>; x++ ) {
<a name="l02706"></a>02706                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a> == NULL)
<a name="l02707"></a>02707                                 <span class="keywordflow">continue</span>;
<a name="l02708"></a>02708                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02709"></a>02709                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%s;%d;%s;%s&quot;</span>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].<a class="code" href="avail_8c.html#a02aa7a3fdc25e6809e64d0ac48ad68dc">host_name</a>,<a class="code" href="cmd_8c.html#a64cd0ee897349d48b9600d30212c1520">commands</a>[x].description,(<a class="code" href="cmd_8c.html#a8784590e30c25d5b86c91320abc8b5a6">force_notification</a> | <a class="code" href="cmd_8c.html#a2ca36f69c287d587950d02b7aecdd471">broadcast_notification</a>),<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02710"></a>02710                 }
<a name="l02711"></a>02711                 <span class="keywordflow">break</span>;
<a name="l02712"></a>02712 
<a name="l02713"></a>02713 
<a name="l02714"></a>02714                 <span class="comment">/***** HOSTGROUP COMMANDS *****/</span>
<a name="l02715"></a>02715 
<a name="l02716"></a>02716         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02717"></a>02717         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aeadb85d6cb60926e3ee8858c71e6c349">CMD_DISABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02718"></a>02718                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02719"></a>02719                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02720"></a>02720                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02721"></a>02721                         cmd = (cmd == <a class="code" href="include_2common_8h.html#a8e8751d4e0cf9d91a95085be3a0b70b1">CMD_ENABLE_HOSTGROUP_SVC_NOTIFICATIONS</a>) ? <a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a> : <a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>;
<a name="l02722"></a>02722                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02723"></a>02723                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02724"></a>02724                 }
<a name="l02725"></a>02725                 <span class="keywordflow">break</span>;
<a name="l02726"></a>02726 
<a name="l02727"></a>02727         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a49d393d97a84c7354172221251d312ae">CMD_ENABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02728"></a>02728         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1710d25e2a3d70fa749253c5396c4cd2">CMD_DISABLE_HOSTGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02729"></a>02729                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02730"></a>02730                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02731"></a>02731                 <span class="keywordflow">break</span>;
<a name="l02732"></a>02732 
<a name="l02733"></a>02733         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l02734"></a>02734         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae6e0db225a968ae1118349dba9596d29">CMD_DISABLE_HOSTGROUP_SVC_CHECKS</a>:
<a name="l02735"></a>02735                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02736"></a>02736                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02737"></a>02737                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02738"></a>02738                         cmd = (cmd == <a class="code" href="include_2common_8h.html#aead1105b804ca0b41740f9fafcb3e382">CMD_ENABLE_HOSTGROUP_SVC_CHECKS</a>) ? <a class="code" href="include_2common_8h.html#ab242ac163dc536eef123c43bd49f622d">CMD_ENABLE_HOSTGROUP_HOST_CHECKS</a> : <a class="code" href="include_2common_8h.html#ad7e000aa6553d5ba3c48dc6100eec34e">CMD_DISABLE_HOSTGROUP_HOST_CHECKS</a>;
<a name="l02739"></a>02739                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02740"></a>02740                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>);
<a name="l02741"></a>02741                 }
<a name="l02742"></a>02742                 <span class="keywordflow">break</span>;
<a name="l02743"></a>02743 
<a name="l02744"></a>02744         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>:
<a name="l02745"></a>02745                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02746"></a>02746                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02747"></a>02747                 <span class="keywordflow">break</span>;
<a name="l02748"></a>02748 
<a name="l02749"></a>02749         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#aff80a7c61704d1cd45c56c6a8048d57d">CMD_SCHEDULE_HOSTGROUP_SVC_DOWNTIME</a>:
<a name="l02750"></a>02750                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02751"></a>02751                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02752"></a>02752                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02753"></a>02753                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02754"></a>02754                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(<a class="code" href="include_2common_8h.html#a3e7de04e60db412230d2f9053f711f64">CMD_SCHEDULE_HOSTGROUP_HOST_DOWNTIME</a>,<span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#ad11f35775c11bb1018b17bb4a2dc0a0f">hostgroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02755"></a>02755                 }
<a name="l02756"></a>02756                 <span class="keywordflow">break</span>;
<a name="l02757"></a>02757 
<a name="l02758"></a>02758 
<a name="l02759"></a>02759                 <span class="comment">/***** SERVICEGROUP COMMANDS *****/</span>
<a name="l02760"></a>02760 
<a name="l02761"></a>02761         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02762"></a>02762         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a0b364d353364414254b771c84e9256d3">CMD_DISABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>:
<a name="l02763"></a>02763                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02764"></a>02764                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02765"></a>02765                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02766"></a>02766                         cmd = (cmd == <a class="code" href="include_2common_8h.html#a5bf657755fbbfde03d7611dd4f3b79ff">CMD_ENABLE_SERVICEGROUP_SVC_NOTIFICATIONS</a>) ? <a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a> : <a class="code" href="include_2common_8h.html#a6c96b4300cbb5a6dc2b2c8a63ebb55ea">CMD_DISABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>;
<a name="l02767"></a>02767                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02768"></a>02768                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02769"></a>02769                 }
<a name="l02770"></a>02770                 <span class="keywordflow">break</span>;
<a name="l02771"></a>02771 
<a name="l02772"></a>02772         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6b8a1db966eb5e5d0802f21a0cabbedd">CMD_ENABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02773"></a>02773         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a6c96b4300cbb5a6dc2b2c8a63ebb55ea">CMD_DISABLE_SERVICEGROUP_HOST_NOTIFICATIONS</a>:
<a name="l02774"></a>02774                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02775"></a>02775                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02776"></a>02776                 <span class="keywordflow">break</span>;
<a name="l02777"></a>02777 
<a name="l02778"></a>02778         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l02779"></a>02779         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#ad429a7756a139718439e4d8ee671a778">CMD_DISABLE_SERVICEGROUP_SVC_CHECKS</a>:
<a name="l02780"></a>02780                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02781"></a>02781                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02782"></a>02782                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>){
<a name="l02783"></a>02783                         cmd = (cmd == <a class="code" href="include_2common_8h.html#ae73fbf545ea0d6842390fb0e2bec96dd">CMD_ENABLE_SERVICEGROUP_SVC_CHECKS</a>) ? <a class="code" href="include_2common_8h.html#acd66dc0014929152d0a6216e8a451a76">CMD_ENABLE_SERVICEGROUP_HOST_CHECKS</a> : <a class="code" href="include_2common_8h.html#a55e8d1e1a3d030667a705a4345997949">CMD_DISABLE_SERVICEGROUP_HOST_CHECKS</a>;
<a name="l02784"></a>02784                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02785"></a>02785                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(cmd,<span class="stringliteral">&quot;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>);
<a name="l02786"></a>02786                 }
<a name="l02787"></a>02787                 <span class="keywordflow">break</span>;
<a name="l02788"></a>02788 
<a name="l02789"></a>02789         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a>:
<a name="l02790"></a>02790                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02791"></a>02791                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02792"></a>02792                 <span class="keywordflow">break</span>;
<a name="l02793"></a>02793 
<a name="l02794"></a>02794         <span class="keywordflow">case</span> <a class="code" href="include_2common_8h.html#a1e799b8d4c9a291e4687cbf30cb58b56">CMD_SCHEDULE_SERVICEGROUP_SVC_DOWNTIME</a>:
<a name="l02795"></a>02795                 <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02796"></a>02796                         <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = cmd_submitf(cmd,<span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02797"></a>02797                 <span class="keywordflow">if</span>(<a class="code" href="cmd_8c.html#a835bb276b4e11a7a7fc046fd53243fa4">affect_host_and_services</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02798"></a>02798                         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#aa9f07ef6184a6e35c013417119d5860e">is_authorized</a>[x])
<a name="l02799"></a>02799                                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] |= cmd_submitf(<a class="code" href="include_2common_8h.html#a576d370e15163072ba796ff65aaeaeee">CMD_SCHEDULE_SERVICEGROUP_HOST_DOWNTIME</a>, <span class="stringliteral">&quot;%s;%lu;%lu;%d;0;%lu;%s;%s&quot;</span>,<a class="code" href="avail_8c.html#a5bac8006c9ce38f423e06a13c08cca37">servicegroup_name</a>,<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>,<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>,<a class="code" href="cmd_8c.html#a86dfe359cca7409a5923c131a5bf68a9">fixed</a>,<a class="code" href="cmd_8c.html#ae81de36d17fc64f5a94560d0885d98f9">duration</a>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02800"></a>02800                 }
<a name="l02801"></a>02801                 <span class="keywordflow">break</span>;
<a name="l02802"></a>02802 
<a name="l02803"></a>02803         <span class="keywordflow">default</span>:
<a name="l02804"></a>02804                 <a class="code" href="cmd_8c.html#a18fffd21deda69e79dde5a9c8db3fd78">submit_result</a>[x] = <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02805"></a>02805                 <span class="keywordflow">break</span>;
<a name="l02806"></a>02806         }
<a name="l02807"></a>02807 
<a name="l02808"></a>02808         <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;
<a name="l02809"></a>02809 }
<a name="l02810"></a>02810 
<a name="l02811"></a><a class="code" href="cmd_8c.html#afb6cb65ae7812183ed147dd6539e59e7">02811</a> <span class="keywordtype">int</span> <a class="code" href="cmd_8c.html#afb6cb65ae7812183ed147dd6539e59e7" title="write the command to Icinga command pipe">write_command_to_file</a>(<span class="keywordtype">char</span> *cmd){
<a name="l02812"></a>02812         <span class="keywordtype">char</span> buffer[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>];
<a name="l02813"></a>02813         <span class="keywordtype">char</span> ip_address[16];
<a name="l02814"></a>02814         <span class="keywordtype">char</span> *p;
<a name="l02815"></a>02815         FILE *fp;
<a name="l02816"></a>02816         <span class="keyword">struct </span>stat statbuf;
<a name="l02817"></a>02817         <span class="keywordtype">char</span> error_string[<a class="code" href="include_2common_8h.html#a23c82337fe6c21111837512469ea40af">MAX_INPUT_BUFFER</a>];
<a name="l02818"></a>02818 
<a name="l02819"></a>02819         <span class="comment">/*</span>
<a name="l02820"></a>02820 <span class="comment">         * Commands are not allowed to have newlines in them, as</span>
<a name="l02821"></a>02821 <span class="comment">         * that allows malicious users to hand-craft requests that</span>
<a name="l02822"></a>02822 <span class="comment">         * bypass the access-restrictions.</span>
<a name="l02823"></a>02823 <span class="comment">         */</span>
<a name="l02824"></a>02824         <span class="keywordflow">if</span> (!cmd || !*cmd || strchr(cmd, <span class="charliteral">&#39;\n&#39;</span>))
<a name="l02825"></a>02825                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02826"></a>02826 
<a name="l02827"></a>02827         <span class="comment">/* bail out if the external command file doesn&#39;t exist */</span>
<a name="l02828"></a>02828         <span class="keywordflow">if</span>(stat(<a class="code" href="commands_8c.html#ad6bb81fae52e357701eadd493eca7902">command_file</a>,&amp;statbuf)){
<a name="l02829"></a>02829                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(error_string,<span class="keyword">sizeof</span>(error_string),<span class="stringliteral">&quot;Error: Could not stat() command file &#39;%s&#39;!&quot;</span>,<a class="code" href="commands_8c.html#ad6bb81fae52e357701eadd493eca7902">command_file</a>);
<a name="l02830"></a>02830                 error_string[<span class="keyword">sizeof</span>(error_string)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l02831"></a>02831 
<a name="l02832"></a>02832                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(error_string,<span class="stringliteral">&quot;The external command file may be missing, Icinga may not be running, and/or Icinga may not be checking external commands.&quot;</span>,2);
<a name="l02833"></a>02833 
<a name="l02834"></a>02834                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02835"></a>02835         }
<a name="l02836"></a>02836 
<a name="l02837"></a>02837         <span class="comment">/* open the command for writing (since this is a pipe, it will really be appended) */</span>
<a name="l02838"></a>02838         fp=fopen(<a class="code" href="commands_8c.html#ad6bb81fae52e357701eadd493eca7902">command_file</a>,<span class="stringliteral">&quot;w&quot;</span>);
<a name="l02839"></a>02839         <span class="keywordflow">if</span>(fp==NULL){
<a name="l02840"></a>02840                 <a class="code" href="snprintf_8c.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(error_string,<span class="keyword">sizeof</span>(error_string),<span class="stringliteral">&quot;Error: Could not open command file &#39;%s&#39; for update!&quot;</span>,<a class="code" href="commands_8c.html#ad6bb81fae52e357701eadd493eca7902">command_file</a>);
<a name="l02841"></a>02841                 error_string[<span class="keyword">sizeof</span>(error_string)-1]=<span class="stringliteral">&#39;\x0&#39;</span>;
<a name="l02842"></a>02842 
<a name="l02843"></a>02843                 <a class="code" href="cgiutils_8c.html#a290f1bb1615d98dc22545c526512aab2">print_generic_error_message</a>(error_string,<span class="stringliteral">&quot;The permissions on the external command file and/or directory may be incorrect. Read the FAQs on how to setup proper permissions.&quot;</span>,2);
<a name="l02844"></a>02844 
<a name="l02845"></a>02845                 <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;
<a name="l02846"></a>02846         }
<a name="l02847"></a>02847 
<a name="l02848"></a>02848         <span class="comment">// get remote address</span>
<a name="l02849"></a>02849         sprintf(ip_address,<span class="stringliteral">&quot;%s&quot;</span>,getenv(<span class="stringliteral">&quot;REMOTE_ADDR&quot;</span>));
<a name="l02850"></a>02850 
<a name="l02851"></a>02851         <span class="comment">/* write command to cgi log */</span>
<a name="l02852"></a>02852         sprintf(buffer, <span class="stringliteral">&quot;EXTERNAL COMMAND: %s;%s;&quot;</span>, current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>,(ip_address!=NULL)?ip_address:<span class="stringliteral">&quot;unknown remote address&quot;</span>);
<a name="l02853"></a>02853         p = index(cmd, <span class="charliteral">&#39;]&#39;</span>);
<a name="l02854"></a>02854         <span class="keywordflow">if</span> (p!=NULL)
<a name="l02855"></a>02855                 p+=2;
<a name="l02856"></a>02856         <span class="keywordflow">else</span>
<a name="l02857"></a>02857                 p=&amp;cmd[0];
<a name="l02858"></a>02858         strncat(buffer, p, <span class="keyword">sizeof</span>(buffer)-strlen(buffer)-1);
<a name="l02859"></a>02859         <a class="code" href="cgiutils_8c.html#a19f3e1909cf6c3aa96b64c2567aceb1d">write_to_cgi_log</a>(buffer);
<a name="l02860"></a>02860 
<a name="l02861"></a>02861         <span class="comment">/* log comments if forced */</span>
<a name="l02862"></a>02862         <span class="keywordflow">if</span>(<a class="code" href="cgiutils_8c.html#aca94ac41a098489df6a09c35226e4737">enforce_comments_on_actions</a>==<a class="code" href="include_2common_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {
<a name="l02863"></a>02863                 sprintf(buffer, <span class="stringliteral">&quot;FORCED COMMENT: %s;%s;%s;%s&quot;</span>, current_authdata.<a class="code" href="structauthdata__struct.html#a4803021222dfcdc5a8bf40e7c0850fe7">username</a>,(ip_address!=NULL)?ip_address:<span class="stringliteral">&quot;unknown remote address&quot;</span>,<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>);
<a name="l02864"></a>02864                 <a class="code" href="cgiutils_8c.html#a19f3e1909cf6c3aa96b64c2567aceb1d">write_to_cgi_log</a>(buffer);
<a name="l02865"></a>02865         }
<a name="l02866"></a>02866 
<a name="l02867"></a>02867         <span class="comment">/* write the command to file */</span>
<a name="l02868"></a>02868         fprintf(fp, <span class="stringliteral">&quot;%s\n&quot;</span>, cmd);
<a name="l02869"></a>02869 
<a name="l02870"></a>02870         <span class="comment">/* flush buffer */</span>
<a name="l02871"></a>02871         fflush(fp);
<a name="l02872"></a>02872 
<a name="l02873"></a>02873         fclose(fp);
<a name="l02874"></a>02874 
<a name="l02875"></a>02875         <span class="keywordflow">return</span> <a class="code" href="include_2common_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;
<a name="l02876"></a>02876 }
<a name="l02877"></a>02877 
<a name="l02878"></a><a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b">02878</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a039c6c81c4df34a3c1fd010cd34a677b" title="strips out semicolons and newlines from comment data">clean_comment_data</a>(<span class="keywordtype">char</span> *buffer){
<a name="l02879"></a>02879         <span class="keywordtype">int</span> x;
<a name="l02880"></a>02880         <span class="keywordtype">int</span> y;
<a name="l02881"></a>02881 
<a name="l02882"></a>02882         y=(int)strlen(buffer);
<a name="l02883"></a>02883 
<a name="l02884"></a>02884         <span class="keywordflow">for</span>(x=0;x&lt;y;x++){
<a name="l02885"></a>02885                 <span class="keywordflow">if</span>(buffer[x]==<span class="charliteral">&#39;;&#39;</span> || buffer[x]==<span class="charliteral">&#39;\n&#39;</span> || buffer[x]==<span class="charliteral">&#39;\r&#39;</span> )
<a name="l02886"></a>02886                         buffer[x]=<span class="charliteral">&#39; &#39;</span>;
<a name="l02887"></a>02887         }
<a name="l02888"></a>02888 
<a name="l02889"></a>02889         <span class="keywordflow">return</span>;
<a name="l02890"></a>02890 }
<a name="l02891"></a>02891 
<a name="l02892"></a><a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b">02892</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#aac895bf83d10749b68af5ebb1ce00b9b" title="checks start and end time and if start_time is before end_time">check_comment_sanity</a>(<span class="keywordtype">int</span> *e){
<a name="l02893"></a>02893         <span class="keywordflow">if</span>(!strcmp(<a class="code" href="cmd_8c.html#a0477c66a0ad7740ddfaafdfca7b8656d">comment_author</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l02894"></a>02894                 error[(*e)++].message=strdup(<span class="stringliteral">&quot;Author name was not entered&quot;</span>);
<a name="l02895"></a>02895         <span class="keywordflow">if</span>(!strcmp(<a class="code" href="cmd_8c.html#a7fa8a08726d2ff86eea2cd94a5980c68">comment_data</a>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l02896"></a>02896                 error[(*e)++].message=strdup(<span class="stringliteral">&quot;Comment data was not entered&quot;</span>);
<a name="l02897"></a>02897 
<a name="l02898"></a>02898         <span class="keywordflow">return</span>;
<a name="l02899"></a>02899 }
<a name="l02900"></a>02900 
<a name="l02901"></a><a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d">02901</a> <span class="keywordtype">void</span> <a class="code" href="cmd_8c.html#a464a712d5e4cac8a065d2a794acad06d" title="checks if comment and author are not empty strings">check_time_sanity</a>(<span class="keywordtype">int</span> *e) {
<a name="l02902"></a>02902         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>==(time_t)0)
<a name="l02903"></a>02903                 error[(*e)++].message=strdup(<span class="stringliteral">&quot;Start time can&#39;t be zero or date format couldn&#39;t be recognized correctly&quot;</span>);
<a name="l02904"></a>02904         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>==(time_t)0)
<a name="l02905"></a>02905                 error[(*e)++].message=strdup(<span class="stringliteral">&quot;End time can&#39;t be zero or date format couldn&#39;t be recognized correctly&quot;</span>);
<a name="l02906"></a>02906         <span class="keywordflow">if</span> (<a class="code" href="cmd_8c.html#a1e324d62e65642694c00de363bf8a8ba">end_time</a>&lt;<a class="code" href="cmd_8c.html#ad20e89e0c86aa812dc3a8e2fb7b5777b">start_time</a>)
<a name="l02907"></a>02907                 error[(*e)++].message=strdup(<span class="stringliteral">&quot;End date before start date&quot;</span>);
<a name="l02908"></a>02908 
<a name="l02909"></a>02909         <span class="keywordflow">return</span>;
<a name="l02910"></a>02910 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="cmd_8c.html">cmd.c</a>      </li>
      <li class="footer">Generated on Tue May 3 2011 22:33:39 for Icinga-core by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
