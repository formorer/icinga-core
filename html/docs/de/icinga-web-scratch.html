<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Installation des Icinga-Web Frontend</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.75.1">
<meta name="keywords" content="Supervision, Icinga, Nagios, Linux">
<link rel="home" href="index.html" title="Icinga Version 1.4 Dokumentation">
<link rel="up" href="ch06.html" title="Kapitel 6. Die Benutzeroberflächen">
<link rel="prev" href="cgiparams.html" title="Informationen zu den CGI-Parametern">
<link rel="next" href="icinga-web-config.html" title="Konfigurationsübersicht Icinga-Web">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<CENTER><IMG src="../images/logofullsize.png" border="0" alt="Icinga" title="Icinga"></CENTER>
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Installation des Icinga-Web Frontend</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="cgiparams.html">Zurück</a> </td>
<th width="60%" align="center">Kapitel 6. Die Benutzeroberflächen</th>
<td width="20%" align="right"> <a accesskey="n" href="icinga-web-config.html">Weiter</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="section" title="Installation des Icinga-Web Frontend">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="icinga-web-scratch"></a>Installation des Icinga-Web Frontend</h2></div></div></div>
  

  <p><span class="bold"><strong>Einleitung</strong></span></p>

  <p>Das neue Icinga-Web wird aktuell sehr stark weiterentwickelt, sodass sich diese Dokumentation unter Umständen noch ändern kann/wird.
  Falls Sie eine detaillierte Installationsanleitung benötigen, konsultieren Sie bitte doc/INSTALL aus dem Source-Paket. Mehr Informationen
  über die gesamte Architektur können Sie auf unserer Webseite nachlesen: <a class="link" href="http://www.icinga.org/architecture/" target="_top">http://www.icinga.org/architecture/</a> Falls Sie mehr über das Icinga-Web-Development und die
  Modularchitektur wissen wollen, verfolgen Sie bitte stetig aktualisierte Einträge im Development-Wiki von Icinga-Web: <a class="link" href="https://dev.icinga.org/projects/icinga-development/wiki#24-Icinga-Web" target="_top">Icinga-Wiki</a></p>

  <p>Diese Installationsanleitung beschreibt die Installation von Icinga-Web mit MySQL als verwendeter Datenbank, weitere
  unterstütze Datenbanken sind Oracle und PostgreSQL..</p>

  <div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
      <p><span class="bold"><strong>Voraussetzungen</strong></span></p>

      <p>Die Pakete mysql und php5 sind installiert (mit PEAR und CLI), Icinga samt IDOUtils läuft, die Icinga-API ebenfalls, dann ab zu
      2., ansonsten bitte:</p>

      <p><span class="bold"><strong>Ubuntu / Debian</strong></span></p>

      <pre class="programlisting"> #&gt; apt-get install php5 php5-cli php-pear php5-xmlrpc php5-xsl php5-pdo php5-ldap php5-gd php5-mysql</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Für Ubuntu gibt es kein php5-pdo-Paket, die benötigten PDO-Extensions sind in den Paketen php5 und php5-mysql
        enthalten!</p>
      </td></tr>
</table></div>

      <p><span class="bold"><strong>Fedora / RHEL / CentOS</strong></span></p>

      <p>Stellen Sie sicher, dass Sie ein Repository bzw. Pakete für PHP 5.2.3 und PCRE 7.6 haben - RHEL/CentOS enthalten bisher
      lediglich PHP 5.1.6 und PCRE 6.6.</p>

      <pre class="programlisting"> #&gt; yum install php php-cli php-pear php-xmlrpc php-xsl php-pdo php-ldap php-gd php-mysql</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Aktuelle Pakete für PHP und PRCE finden Sie beispielsweise unter: <a class="link" href="http://blog.famillecollet.com/pages/Config-en" target="_top">Les RPM de Remi</a> oder <a class="link" href="http://www.jasonlitka.com/category/yum-repo-news" target="_top">http://www.jasonlitka.com/category/yum-repo-news/</a></p>
      </td></tr>
</table></div>

      <p><span class="bold"><strong>OpenSuSE</strong></span></p>

      <p>Benutzen Sie yast, um die Pakete "php5", "php5-pear", "php5-xmlrpc", "php5-xsl", "php5-&lt;rdbm&gt;", "php5-soap",
      "php5-gettext", "php5-pdo", "php5-ldap", "php5-gd" und "apache2-mod_php5" zu installieren. Die CLI ist im php5-Paket enthalten.</p>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Zumindest bei SLES10 SP2 fehlt die Funktion hash_hmac.</p>
      </td></tr>
</table></div>

      <p>Die Installation von Icinga mit den IDOUtils bzw. der Icinga-API ist in der <a class="link" href="quickstart-idoutils.html" title="Icinga-Schnellstart mit IDOUtils">Icinga-Schnellstartanleitung</a> und dem Abschnitt über die <a class="link" href="icinga-api.html" title="Installation und Benutzung der Icinga-API">Icinga-API</a> beschrieben.</p>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>Die Installation</strong></span></p>

      <p>Laden Sie das Archiv herunter von <a class="link" href="http://sourceforge.net/projects/icinga/files/" target="_top">http://sourceforge.net/projects/icinga/files/</a> oder klonen Sie von
      icinga-web.git, um mit der aktuellsten Version zu arbeiten:</p>

      <pre class="programlisting"> #&gt; git clone git://git.icinga.org/icinga-web.git</pre>

      <p>Extrahieren Sie das Archiv (tarball) wie folgt:</p>

      <pre class="programlisting"> #&gt; tar xzvf icinga-web-1.4.0.tar.gz</pre>

      <p>Wechseln Sie in das Verzeichnis:</p>

      <pre class="programlisting"> #&gt; cd icinga-web-1.4.0</pre>

      <p>Icinga-Web stellt verschiedene configure Optionen zur Verfügung z.B.</p>

      <pre class="programlisting"> #&gt; ./configure 
                        --prefix=/usr/local/icinga-web 
                        --with-web-user=www-data 
                        --with-web-group=www-data 
                        --with-web-path=/icinga-web 
                        --with-web-apache-path=/etc/apache2/conf.d 
                        --with-db-type=mysql 
                        --with-db-host=localhost 
                        --with-db-port=3306 
                        --with-db-name=icinga_web 
                        --with-db-user=icinga_web 
                        --with-db-pass=icinga_web 
                        --with-icinga-api=/usr/local/icinga/share/icinga-api
                        --with-api-type=APICON API type (default CONNECTION_IDO)
                        --with-api-subtype=TYPE DB driver or network connection
                        --with-api-host=HOST Host to connect (DB or other) (default localhost)
                        --with-api-port=PORT Port for connection (default 3306)
                        --with-api-socket=PATH Path to socket (default none)</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Bitte beachten Sie, dass Sie hier die Icinga-Web-Datenbank konfigurieren, und nicht die Icinga-IDOUtils-Datenbank! User- und
        Gruppenname des Web-Prozesses sind abhängig von der verwendeten Distribution.</p>
      </td></tr>
</table></div>

      <p>Alle Konfigurationsmöglichkeiten sehen Sie mit:</p>

      <pre class="programlisting"> #&gt; ./configure --help</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Falls Sie keine Optionen angeben, erwartet der Installer die Icinga-API in /usr/local/icinga/share/icinga-api.</p>
      </td></tr>
</table></div>

      <p>Ohne weitere Optionen wird das Icinga-Webinterface mit:</p>

      <pre class="programlisting"> #&gt; ./configure
 #&gt; make install</pre>

      <p>unter /usr/local/icinga-web installiert.</p>

      <p>Installation der neuen Apache Konfiguration</p>

      <pre class="programlisting">#&gt; make install-apache-config</pre>

      <p>Wenn Sie das nicht möchten, können Sie das bisherige Verfahren nutzen, durch die Eingabe von:</p>

      <pre class="programlisting">#&gt; make install-javascript</pre>

      <p>Dies installiert die bisherigen Symlinks.</p>

      <p>Erzeugen des Installationsberichtes:</p>

      <pre class="programlisting">#&gt; make install-done

Installation of icinga-web succeeded. 
Please check the new Apache2 configuration (etc/apache2/icinga-web.conf).</pre>

      <p>Passwort zurücksetzen:</p>

      <pre class="programlisting">#&gt; make icinga-reset-password</pre>

      <p>Setzt das Passwort für jeden Account auf icinga-web zurück.</p>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>PHP-Abhängigkeiten</strong></span></p>

      <p>Bitte prüfen Sie die PHP-Abhängigkeiten mit:</p>

      <pre class="programlisting"> #&gt; make testdeps</pre>

      <p>Alle "require"-Tests sollten erfolgreich sein. Eventuell müssen Sie die php.ini anpassen:</p>

      <p>Die "magic_quote_gpc" in der Apache- und der CLI-php.ini auf "Off" setzen! Evtl. müssen Sie auch "safe_mode" auf "off" setzen
      (php&lt; 5.3.0). Bitte beachten Sie, dass die Pfade von der Distribution abhängig sind.</p>

      <pre class="programlisting"> #&gt; vi /etc/php5/apache/php.ini
   magic_quotes_gpc = off
   safe_mode = off
 #&gt; vi /etc/php5/cli/php.ini
   magic_quotes_gpc = off</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Beide Dateien müssen vorhanden sein, sonst erhalten Sie eine Agavi-Meldung, weil der Default von magic_quotes_gpc "ON"
        ist.</p>
      </td></tr>
</table></div>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>Datenbank-Installation</strong></span></p>

      <p>Icinga-Web benötigt eine eigene Datenbank z.B. icinga_web. Sie können die Datenbank von IDOUtils mitverwenden, dies wird
      allerdings nicht empfohlen, um bei Upgrades keine Probleme zu haben.</p>

      <p><span class="bold"><strong>Anlegen des Datenbankbenutzers:</strong></span></p>

      <p>Der Benutzer muss mindestens diese Privilegien haben: SELECT, UPDATE, INSERT, DELETE.</p>

      <pre class="programlisting"> SQL&gt; GRANT USAGE ON *.* TO 'icinga_web'@'localhost' IDENTIFIED BY 'icinga_web';

 SQL&gt; GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, INDEX ON icinga_web.* TO 'icinga_web'@'localhost';</pre>

      <p><span class="bold"><strong>MySQL</strong></span></p>

      <pre class="programlisting"> #&gt; mysql -u root -p
  
 mysql&gt; GRANT USAGE ON icinga_web.* TO 'icinga_web'@'localhost' IDENTIFIED BY 'icinga_web' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0;
   
        GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, INDEX ON icinga_web.* TO 'icinga_web'@'localhost';

        quit</pre>

      <p><span class="bold"><strong>Anlegen der Datenbank</strong></span></p>

      <p>Icinga-Web bringt Doctrine mit, womit in Zukunft die Datenbank verwaltet wird. Mittels 'make' kann diese initialisiert oder
      gelöscht werden.</p>

      <pre class="programlisting"> #&gt; make db-initialize      - legt eine Icinga Web Datenbank an und füllt diese mit initialen Werten</pre>

      <pre class="programlisting"> #&gt; make db-drop            - löscht die komplette Datenbank, inklusive Securityabfrage um ungewolltes Löschen zu verhindern</pre>

      <pre class="programlisting"> #&gt; make db-doc2sql         - falls Sie SQL scripts beispielsweise für Packaging oder manuelles Setup benötigen, können Sie diese Option verwenden um die SQL scripts aus Doctrine zu extrahieren
</pre>

      <p>Um die Datenbankanlege-Befehle nutzen zu können, müssen Sie dem Benutzer der diese DB Befehle ausführen soll, auch die
      entsprechenden Privilegien zuordnen. Falls derjenige Benutzer, der für das Icinga Web in configure vorgesehen wurde, zu wenig
      Berechtigungen hat, gibt es in 'make' eine Abfrage, ob Sie einen anderen Benutzer mit mehr Privilegien verwenden wollen. Falls dies
      nicht funktioniert, sollten sie etc/build.properties editieren und einen root Benutzer einfuegen</p>

      <p>Das Installieren der Datenbank funktioniert mittels:</p>

      <pre class="programlisting"> #&gt; make db-initialize</pre>

      <p><span class="bold"><strong>Manuelles Anlegen der Datenbank</strong></span></p>

      <p>Sofern Sie die Datenbank manuell installieren wollen z.B. für Package building, können Sie mit diesem Befehl die SQL Scripts
      extrahieren</p>

      <pre class="programlisting"> #&gt; make db-doc2sql</pre>

      <p>und dann diese in die frisch angelegte Datenbank importieren.</p>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>Icinga-Web Konfiguration</strong></span></p>

      <p>Im Normalfall können Sie die Datenbankeinstellungen während configure vornehmen. Sollten Sie diese allerdings anpassen wollen
      oder nachsehen wollen im Fehlerfall, öffnen Sie folgende Datei mit einem Editor Ihrer Wahl.</p>

      <pre class="programlisting"> #&gt; vi app/config/databases.xml</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Optional: Ihre spezifischen Icinga Datenbankeinstellungen können Sie vornehmen in app / config /database.site.xml.
        Diese Informationen bleiben während eines Update-Prozesses erhalten.</p>
      </td></tr>
</table></div>

      <pre class="programlisting"> &lt;databases default="icinga_web"&gt;

                        &lt;database name="icinga_web" class="AgaviDoctrineDatabase"&gt;

                                &lt;!--

                                        Doctrine dsn strings:

                                        http://www.doctrine-project.org/documentation/manual/1_1/en/introduction-to-connections

                                --&gt;

                                &lt;ae:parameter name="dsn"&gt;mysql://icinga_web:icinga_web@127.0.0.1:3306/icinga_web&lt;/ae:parameter&gt;

                                &lt;!-- Generic credentials  --&gt;

                                &lt;!-- &lt;ae:parameter name="username"&gt;icinga_web&lt;/ae:parameter&gt; --&gt;

                                &lt;!-- &lt;ae:parameter name="password"&gt;icinga_web&lt;/ae:parameter&gt; --&gt;

                                &lt;!-- DB encoding type --&gt;

                                &lt;ae:parameter name="charset"&gt;utf8&lt;/ae:parameter&gt;

                                &lt;!--

                                        Doctrine_Manager configuration

                                --&gt;

                                &lt;ae:parameter name="manager_attributes"&gt;

                                        &lt;!-- This allows lazy loading of the models --&gt;

                                        &lt;ae:parameter name="Doctrine_Core::ATTR_MODEL_LOADING"&gt;CONSERVATIVE&lt;/ae:parameter&gt;

                                &lt;/ae:parameter&gt;

                                &lt;!-- The path to our models --&gt;

                                &lt;ae:parameter name="load_models"&gt;%core.module_dir%/AppKit/lib/database/models/generated&lt;/ae:parameter&gt;

                                &lt;ae:parameter name="models_directory"&gt;%core.module_dir%/AppKit/lib/database/models&lt;/ae:parameter&gt;

                        &lt;/database&gt;</pre>

      <p><span class="bold"><strong>Konfiguration von Icinga-API Parametern</strong></span></p>

      <p>Diese Einstellungen werden direkt in Icinga Web vorgenommen, das diese Informationen dann entsprechend aufbereitet an die Icinga
      API weitergibt. Öffnen Sie app/modules/Web/config/icinga-io.xml um die IcingaApi factories zu sehen: IcingaData und IcingaCommand.
      </p>
<pre class="programlisting"> #&gt; vi app/modules/Web/config/icinga-io.xml</pre>
<p> </p>
<div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
          <p>Optional: Ihre spezifischen Icinga Verbindungseinstellungen, wie die API-Anmeldeinformationen, können Sie vornehmen
          in app / modules / Web / config / icinga-io.site.xml. Diese Informationen bleiben während eines Update-Prozesses erhalten.</p>
        </td></tr>
</table></div>

      <p>In IcingaData werden die Parameter für die Icinga-API festgelegt, um beispielsweise die Icinga IDOUtils Datenbank
      als Datenquelle einzustellen. </p>
<div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
          <p>Bitte beachten Sie, dass Sie zuvor IDOUtils installieren müssen (so wie im Icinga IDOUtils Quickstart <a class="link" href="quickstart-idoutils.html" title="Icinga-Schnellstart mit IDOUtils">hier</a> beschrieben).</p>
        </td></tr>
</table></div>
<p> </p>
<pre class="programlisting">                                &lt;!--
                                        See doc/icinga-api-types.txt for options
                                --/&gt;
                                &lt;setting name="api.interfaces.data"/&gt;
                                        &lt;!-- IcingaApi connection interface --/&gt;
                                        &lt;ae:parameter name="api_type"/&gt;IcingaApi::CONNECTION_IDO&lt;/ae:parameter/&gt;

                                        &lt;!-- Suits for all interfaes --/&gt;
                                        &lt;ae:parameter name="config_type"/&gt;mysql&lt;/ae:parameter/&gt;
                                        &lt;ae:parameter name="config_host"/&gt;localhost&lt;/ae:parameter/&gt;
                                        &lt;ae:parameter name="config_port"/&gt;3306&lt;/ae:parameter/&gt;

                                        &lt;!-- ###BEGIN_CONNECTION_IDO### --/&gt;
                                        &lt;!-- Database specific (IcingaApi::CONNECTION_IDO) --/&gt;
                                        &lt;ae:parameter name="config_database"/&gt;icinga&lt;/ae:parameter/&gt;
                                        &lt;ae:parameter name="config_user"/&gt;icinga&lt;/ae:parameter/&gt;
                                        &lt;ae:parameter name="config_password"/&gt;icinga&lt;/ae:parameter/&gt;
                                        &lt;ae:parameter name="config_table_prefix"/&gt;icinga_&lt;/ae:parameter/&gt;
                                        &lt;!-- ###END_CONNECTION_IDO### --/&gt;

                                &lt;/setting/&gt;</pre>

      <p>In IcingaCommand können Sie einstellen, wie Befehle an die Icinga Core command pipe gesendet werden - lokal oder remote via SSH.
      Abhängig davon, ob die jeweilige Option 'enabled' ist, wird diese verwendet/nicht verwendet. Standardmäßig wird die lokale Pipe
      verwendet.</p>

      <pre class="programlisting">                                &lt;setting name="api.interfaces.command"&gt;
                                        &lt;ae:parameter name="pipe1"&gt;
                                                &lt;ae:parameter name="type"&gt;IcingaApi::COMMAND_PIPE&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="enabled"&gt;true&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="pipe"&gt;/usr/local/icinga/var/rw/icinga.cmd&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="instance"&gt;default&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="broadcast"&gt;false&lt;/ae:parameter&gt;
                                        &lt;/ae:parameter&gt;

                                        &lt;!--

                                                * This examples show how to send commands to specific instances
                                                * Use 'instance' to send commands to this instance only
                                                * Use 'brodcast' to send all commands to this instances!

                                        &lt;ae:parameter name="pipe1-instance-test"&gt;
                                                &lt;ae:parameter name="type"&gt;IcingaApi::COMMAND_PIPE&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="enabled"&gt;true&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="pipe"&gt;/usr/local/icinga/var/rw/icinga.cmd&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="instance"&gt;test&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="broadcast"&gt;false&lt;/ae:parameter&gt;
                                        &lt;/ae:parameter&gt;

                                        &lt;ae:parameter name="pipe1-broadcast"&gt;
                                                &lt;ae:parameter name="type"&gt;IcingaApi::COMMAND_PIPE&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="enabled"&gt;false&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="pipe"&gt;/usr/local/icinga/var/rw/icinga.cmd&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="instance"&gt;&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="broadcast"&gt;true&lt;/ae:parameter&gt;
                                        &lt;/ae:parameter&gt;

                                        --&gt;

                                        &lt;ae:parameter name="ssh1"&gt;
                                                &lt;ae:parameter name="type"&gt;IcingaApi::COMMAND_SSH&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="enabled"&gt;false&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="ssh_bin"&gt;/usr/bin/ssh&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="ssh_user"&gt;icinga&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="ssh_host"&gt;127.0.0.15&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="ssh_port"&gt;22&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="ssh_timeout"&gt;20&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="ssh_pipe"&gt;/usr/local/icinga/var/rw/icinga.cmd&lt;/ae:parameter&gt;

                                                &lt;ae:parameter name="instance"&gt;default&lt;/ae:parameter&gt;
                                                &lt;ae:parameter name="broadcast"&gt;false&lt;/ae:parameter&gt;
                                        &lt;/ae:parameter&gt;
                                &lt;/setting&gt; </pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Nachdem Sie Änderungen an diesen Konfigurationen vorgenommen haben, müssen Sie den Cache leeren!</p>
      </td></tr>
</table></div>

      <pre class="programlisting"> #&gt; rm -rf app/cache/config/*.php</pre>

      <p>oder /path/to/clearcache.sh</p>

      <pre class="programlisting"> #&gt; /usr/local/icinga-web/bin/clearcache.sh</pre>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>Apache-Konfiguration</strong></span></p>

      <p>Voraussetzungen:</p>

      <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
          <p>mod_rewrite, vielleicht müssen Sie einen Verweis erstellen:</p>
          <pre class="programlisting"> #&gt; ln -s /etc/apache2/mods-available/rewrite.load /etc/apache2/mods-enabled/rewrite.load</pre>

          <p>Bei OpenSuSE und SLES können Sie das Modul mit "a2enmod rewrite" aktivieren. Falls das nicht funktioniert, gibt es in der Datei
          /etc/sysconfig/apache2 die Zeile "APACHE_MODULES=...", der das Modul "rewrite" hinzugefügt werden muss.</p>

          <p>Bei Debian und Ubuntu können Sie das Modul ebenfalls mit "a2enmod rewrite" aktivieren.</p>

          <p>Bei RHEL/Fedora/CentOS ist die Unterstützung bereits im httpd enthalten.</p>

        </li>
<li class="listitem">
          <p>Über htaccess aktivierte Einstellungen</p>

          <p>Editieren Sie die .htaccess unter /usr/local/icinga-web/pub und ändern Sie die RewriteBase (ab Zeile 14): </p>
<pre class="programlisting"> DirectoryIndex index.php

 Options -MultiViews -Indexes +FollowSymLinks
 Order allow,deny
 Allow from all

 &lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On

    # This depends on your path
    # on independent hosts the base is '/'
    RewriteBase /icinga-web/

        # If the requested URL does not exist (it's likely an agavi route),
        # pass it as path info to index.php, the Agavi dispatch script.
        RewriteRule ^$ index.php?/ [QSA,L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule (.*) index.php?/$1 [QSA,L]
 &lt;/IfModule&gt;

 &lt;IfModule mod_deflate.c&gt;
        SetOutputFilter DEFLATE

        BrowserMatch ^Mozilla/4 gzip-only-text/html
        BrowserMatch ^Mozilla/4\.0[678] no-gzip

        BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
        BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html

        Header append Vary User-Agent env=!dont-vary
 &lt;/IfModule&gt;

 &lt;IfDefine APACHE2&gt;
        AcceptPathInf  On
 &lt;/IfDefine&gt;

 #&lt;IfModule mod_auth_basic.c&gt;
 #       AuthType Basic
 #       AuthName "My http basic auth realm"
 #       AuthUserFile /path/to/my/htusers
 #       require valid-user
 #&lt;/IfModule&gt;</pre>
        </li>
</ul></div> 

      <p>Bitte wechseln Sie in das Konfigurationsverzeichnis Ihres Webservers. Überprüfen Sie, ob die, mit <span class="bold"><strong>make
      install-apache-config</strong></span> erstellte Konfiguration Ihren Anforderungen entspricht, oder erstellen Sie noch einen neuen Alias im
      Konfigurationsverzeichnis des Webservers (hier in der icinga-web.conf):</p>

      <pre class="programlisting">#&gt; vi /etc/apache2/conf.d/icinga-web.conf
#&gt;
#&gt; icinga-web apache configuration
#&gt; - Enable all options .htaccess
#&gt; - Add extjs library to alias
#&gt;

Alias /icinga-web/js/ext3 /usr/local/icinga-web/lib/ext3
Alias /icinga-web /usr/local/icinga-web/pub
&lt;Directory /usr/local/icinga-web/lib/ext3&gt;
    Order allow,deny
    Allow from all
&lt;/Directory&gt;
   Alias /icinga-web /usr/local/icinga-web/pub
  &lt;Directory /usr/local/icinga-web/pub&gt;
        AllowOverride All
  &lt;/Directory&gt;</pre>

      <p>Leeren Sie den Cache:</p>

      <pre class="programlisting"> #&gt; rm /usr/local/icinga-web/app/cache/config/*.php</pre>

      <p>oder /path/to/clearcache.sh</p>

      <pre class="programlisting">#&gt; /usr/local/icinga-web/bin/clearcache.sh</pre>

      <p>und starten Sie den Webserver neu:</p>

      <pre class="programlisting"> #&gt; service apache2 restart</pre>

      <p>bzw.</p>

      <pre class="programlisting"> #&gt; /etc/init.d/apache2 restart</pre>

      <p>oder</p>

      <pre class="programlisting"> #&gt; /etc/init.d/httpd restart</pre>
    </li>
<li class="listitem">
      <p><span class="bold"><strong>Testen</strong></span></p>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Bitte achten Sie darauf, dass Ihre Datenbank, Apache, IDOUtils und Icinga gestartet sind!</p>
      </td></tr>
</table></div>

      <p>Öffnen Sie im Webbrowser http://localhost/icinga-web. Überprüfen Sie, ob das Webinterface ohne Fehler "exceptions" startet, und
      loggen Sie sich mit dem User 'root' und dem Passwort 'password' ein.</p>

      <p>Viel Spaß :-)</p>
    </li>
<li class="listitem">
      <p><a name="icinga-web-scratch-errors"></a> <span class="bold"><strong>Test &amp; Fehler?</strong></span></p>

      <p>Diese Sammlung beinhaltet einige nützliche Informationen, wie Sie Fehler finden und lösen können. Ebenso wird darauf
      hingewiesen, welche Informationen Sie im Fehlerfall angeben sollen, wenn Sie eine Frage auf den Mailinglisten oder auf <a class="link" href="http://www.icinga-portal.org" target="_top">http://www.icinga-portal.org</a> stellen.</p>

      <p>* Geben Sie immer die verwendete Version an - tar.gz oder GIT?</p>

      <p>* Browser, Version</p>

      <p>* Falls das Problem mit der Datenquelle besteht: Ausführliche Informationen zu API, IDOUtils, Core (Version, Debug Logs).</p>

      <p>Wo können Sie nachsehen?</p>

      <p>* Apache Error Logs, PHP Errors, PHP Dateien können nicht gefunden werden</p>

      <p>* /var/log/messages, /path/to/icinga/var/icinga.log</p>

      <p>Änderungen an der Icinga-Web-Konfiguration (z.B. API/IDOUtils-Einstellungen geändert) werden nicht aktualisiert?</p>

      <p>* Löschen Sie den Konfigurationscache in app/cache/config/*.php</p>

      <pre class="programlisting">/usr/local/icinga-web/bin/clearcache.sh</pre>

      <p>Icinga Web zeigt eine leere Seite?</p>

      <p>* Apache Errors Logs =&gt; mod_rewrite enabled, PHP-Abhängigkeiten ok? 'make testdeps'. Bei Debian gibt es u.a. die folgende
      Fehlermeldung: ".htaccess: Invalid command 'RewriteEngine', perhaps misspelled or defined by a module not included in the server
      configuration"</p>

      <p>Icinga Web - Login erfolgt- aber die Seite lädt und lädt...</p>

      <p>* Request failed, Ressource /icinga-web/appkit/ext/application State could not be loaded - is the url correct? =&gt; mod_rewrite
      enabled ?</p>

      <p>* .htaccess/VHost-Konfiguration =&gt; Pfade nicht korrekt? Icinga-Web zeigt keine Daten?</p>

      <p>* Sehen Sie in den Apache Error Logs nach, ob dort ein Fehler bezüglich fehlender IcingaApi.php auftritt =&gt; Überprüfen Sie
      anhand des Installationguides, ob Sie die Icinga-API korrekt installiert haben.</p>

      <p>* Datenbankzugriff verweigert =&gt; Überprüfen Sie, ob die Datenbankeinstellungen für Icinga-Web korrekt sind.</p>

      <p>IDOUtils Datenbank wird nicht gefüllt?</p>

      <p>* "Error writing to data sink" =&gt; Überprüfen Sie die IDOUtils (ido2db runs 2x - ok?), ido2db.cfg debug_level=-1,
      debug_verbosity=2, restarten Sie IDOUtils und suchen Sie Fehler in ido2db.debug</p>

      <p>* Keine Daten vorhanden =&gt; Überprüfen Sie icinga.log, ob IDOMOD zu Beginn geladen wird. Falls nicht, enablen Sie das Event
      Broker Modul in icinga.cfg so wie im Icinga Core im <a class="link" href="quickstart-idoutils.html" title="Icinga-Schnellstart mit IDOUtils">IDOUtils Quickstart Guide</a>
      beschrieben.</p>

      <p>* IDOUtils DB-Schema ist die aktuellste Version? =&gt; Falls nicht, überprüfen Sie mögliche Upgrades anhand der Docs
      dafür.</p>

      <p>* Sockets sind korrekt definiert? =&gt; Unix oder TCP Socket, TCP wahlweise mit oder ohne SSL</p>

      <p><span class="bold"><strong>Testing the Web: </strong></span></p>

      <pre class="programlisting"> $&gt; cd etc/tests/
 $&gt; php icingaWebTesting.php</pre>

      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Falls Sie Ihren root- Benutzer zum Testen benutzen, dann stellen Sie vorher sicher, dass für den angegebenen Web-Benutzer eine
        gültige Shell eingetragen ist. Anderenfalls werden verschiedene Tests fehlschlagen. Abhängig von der verwendeten Icinga-Web-Version
        kann es sein, dass die Berechtigungen für die Dateien in /usr/local/icinga-web/app/data/log falsch gesetzt sind, so dass Icinga-Web
        mit der Meldung "Loading" stehenbleibt.</p>
      </td></tr>
</table></div>
      <div class="note" title="Anmerkung" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="../images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
        <p>Nicht vergessen - Ändern von PHP-Einstellungen in der php.ini erfordert einen Apache reload/restart!</p>
      </td></tr>
</table></div>

      <p>* PHP Fatal error: Allowed memory size of ... bytes exhausted (tried to allocate ... bytes) =&gt; Überprüfen Sie Ihre php.ini
      (apache2 und cli) und setzen Sie den Wert memory_limit auf 128M oder höher.</p>

      <p>* PHP Fatal error: Uncaught exception 'AgaviCacheException' with message 'Failed to write cache file
      /usr/local/icinga-web/app/cache/config/config_handlers.xml_development__xxxx.php" generated from configuration file
      /usr/local/icinga-web/app/config/config_handlers.xml". Please make sure you have set correct write permissions for directory
      /usr/local/icinga-web/app/cache.... = &gt; Setzen von safe_mode = off in /etc/php5/apache/php.ini.</p>

      <p>* Keine Verbindung zur API. The API Connector returned the following message: getConnection failed: Database connection failed:
      SQLSTATE[28000] [1045] Access denied for user 'icinga'@'localhost' (using password: YES))</p>

      <p>=&gt; Überprüfen Sie Ihre IDOUtils DB-Referenzen in der ido2db.cfg und fügen Sie diese in Ihre Icinga-Web- Konfiguration als
      bevorzugte DB- Referenzen für Ihre IDO hinzu (siehe Konfiguration der Icinga-API). Ab Icinga-Web1.0.3 können die Werte direkt während
      des configure gesetzt werden.</p>

      <p>* touch: cannot touch `/usr/local/icinga-web/.../cache/testfile.txt': Permission denied</p>

      <p>=&gt; Die Konfiguration in den xml-Dateien wird vom Framework ge-'pre-cached'. Daher müssen spezielle Berechtigungen für die
      Caching-Verzeichnisse gesetzt werden. Durch die Ausführung von icingaWebTesting.php in etc/tests können die richtigen Berechtigungen
      automatisch gesetzt werden.</p>

      <p>* PHP Fatal error: Uncaught exception '...' with message 'Couldn't locate driver named mysql' =&gt; Stellen Sie sicher, dass php
      pdo installiert und geladen ist, auch wenn testdeps sagt, dass alles in Ordnung ist.</p>

      <p>* Das Login wird nicht angezeigt =&gt; Aktivieren Sie short_open_tag in Ihrer php.ini</p>

      <p>=&gt; Editieren Sie open_basedir in Ihrer php.ini und fügen Sie die Installationsverzeichnisse von Icinga-Web und von Icinga-API
      (z.B. /usr/local/icinga/share/) hinzu.</p>

      <p>* Leeres Icinga-Web? =&gt; Wenn mod_rewrite aktiviert ist und 'index.php' erscheint in der angefragten URL, dann funktioniert
      das Portal nicht. Entfernen Sie index.php aus Ihrer URL und alles sollte funktionieren</p>

      <p>* Die Ergebnisse in den Status Cronks passen nicht zu Ihrer Konfiguration? =&gt; Überprüfen Sie in Ihrem Backend, d.h. IDOUtils
      DB, welche Werte für die Status-Tabellen selektiert werden.</p>

      <p>* Keine Daten in den Cronks ? =&gt; Überprüfen Sie ob alle Berechtigungen korrekt gesetzt sind, insbesondere von log/</p>

      <p>Sofern Sie Fragen oder Updates haben, zögern Sie bitte nicht, uns diese mitzuteilen! :-)</p>
    </li>
</ol></div>

  <a class="indexterm" name="id2886962"></a>

  <a class="indexterm" name="id2886846"></a>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="cgiparams.html">Zurück</a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch06.html">Nach oben</a></td>
<td width="40%" align="right"> <a accesskey="n" href="icinga-web-config.html">Weiter</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Informationen zu den CGI-Parametern </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Zum Anfang</a></td>
<td width="40%" align="right" valign="top"> Konfigurationsübersicht Icinga-Web</td>
</tr>
</table>
</div>
<P class="copyright">© 2009-2011 Icinga Development Team, http://www.icinga.org</P>
</body>
</html>
